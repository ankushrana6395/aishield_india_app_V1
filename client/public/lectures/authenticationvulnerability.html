<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Interactive Authentication Vulnerabilities Masterclass with Live Hinglish Translation | Quiz | Try It Yourself | By HTB Elite Hacker">
  <title>Authentication Vulnerabilities | By Ankush Rana</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;600;700;900&family=Roboto:wght@300;400;500;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --primary: #0a1121;
      --dark-navy: #0b1b30;
      --neon-green: #00ff88;
      --electric-blue: #00aaff;
      --neon-orange: #ff8800;
      --neon-pink: #ff0080;
      --glow-green: rgba(0, 255, 136, 0.3);
      --glow-blue: rgba(0, 170, 255, 0.2);
      --glow-pink: rgba(255, 0, 128, 0.3);
      --light-gray: #e0e0e0;
      --mid-gray: #aaaaaa;
      --card-bg: #111c30;
      --border: #2a4060;
      --keyword: #ffdd57;
      --keyword-bg: rgba(255, 221, 87, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--primary);
      color: var(--light-gray);
      line-height: 1.7;
      overflow-x: hidden;
    }

    /* Three.js Background */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Translator Button */
    .translator-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 0 15px var(--glow-green);
      transition: all 0.3s ease;
    }

    .translator-btn:hover {
      transform: translateY(-2px);
      background: #00cc6d;
    }

    /* Header / Hero */
    header {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-content {
      z-index: 2;
      max-width: 900px;
      position: relative;
    }

    .hero-content h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2.8rem, 8vw, 4rem);
      color: white;
      margin-bottom: 10px;
      text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
      50% { text-shadow: 0 0 25px rgba(0, 255, 136, 0.9), 0 0 35px rgba(0, 255, 136, 0.5); }
      100% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
    }

    .hero-content h1 span {
      color: var(--neon-green);
    }

    .subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: clamp(1.2rem, 3.5vw, 1.5rem);
      color: var(--electric-blue);
      margin: 15px 0;
    }

    /* Section Styling */
    section {
      padding: 100px 0;
      position: relative;
    }

    .section-title {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2rem, 5vw, 2.5rem);
      color: var(--neon-green);
      margin-bottom: 50px;
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -8px;
      width: 70px;
      height: 4px;
      background: var(--electric-blue);
      animation: expand 2s infinite;
    }

    @keyframes expand {
      0% { width: 70px; }
      50% { width: 100px; }
      100% { width: 70px; }
    }

    /* Lecture Card */
    .lecture-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .lecture-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 136, 0.05), transparent);
      z-index: 0;
    }

    .lecture-card.pop-out {
      transform: translateY(-20px) scale(1.05);
      box-shadow: 
        0 30px 60px rgba(0, 0, 0, 0.5),
        0 0 50px var(--glow-green);
      border-color: var(--neon-green);
      z-index: 5;
    }

    .lecture-card.focused {
      transform: translateY(-20px) scale(1.06);
      box-shadow: 
        0 40px 80px rgba(0, 0, 0, 0.6),
        0 0 70px var(--glow-green);
      filter: brightness(1.1);
    }

    .lecture-card h3 {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 18px;
      font-size: 1.8rem;
      position: relative;
      z-index: 2;
    }

    /* Keyword Style */
    .keyword {
      background: var(--keyword-bg);
      color: var(--keyword);
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 1px dashed var(--keyword);
      position: relative;
      transition: all 0.3s ease;
      z-index: 2;
    }

    .keyword:hover {
      background: rgba(255, 221, 87, 0.3);
      box-shadow: 0 0 12px rgba(255, 221, 87, 0.4);
    }

    /* Tooltip (Modal) */
    .keyword-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 17, 33, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .keyword-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border: 2px solid var(--neon-green);
      border-radius: 14px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 50px var(--glow-green);
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .keyword-modal.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--neon-green);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-title {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .modal-body {
      color: var(--light-gray);
      line-height: 1.6;
    }

    /* Interactive Demo */
    .interactive-demo {
      background: rgba(0, 20, 40, 0.6);
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      border: 1px solid var(--electric-blue);
    }

    .demo-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .input-group label {
      min-width: 120px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--neon-green);
    }

    .input-group input {
      flex: 1;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: white;
      font-family: 'JetBrains Mono', monospace;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--neon-green);
      box-shadow: 0 0 10px var(--glow-green);
    }

    .button {
      padding: 12px 24px;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 4px;
      font-family: 'Orbitron', sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: fit-content;
    }

    .button:hover {
      background: #00cc6d;
      box-shadow: 0 0 15px var(--glow-green);
      transform: translateY(-2px);
    }

    .result-box {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 6px;
      padding: 15px;
      margin-top: 15px;
      border-left: 3px solid var(--neon-green);
      font-family: 'JetBrains Mono', monospace;
      min-height: 100px;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    /* Diagram */
    .diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }

    .box {
      min-width: 140px;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      font-weight: bold;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }

    .box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
    }

    .box:hover::before {
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }

    .user-input { background: #8b0000; color: white; }
    .app { background: #003366; color: white; }
    .db { background: #004d00; color: #00ff88; }

    .arrow {
      font-size: 1.8rem;
      color: var(--neon-green);
      position: relative;
    }

    .arrow::before {
      content: '‚Üí';
      animation: arrow-pulse 1.5s infinite;
    }

    @keyframes arrow-pulse {
      0% { text-shadow: 0 0 5px var(--neon-green); }
      50% { text-shadow: 0 0 15px var(--neon-green); }
      100% { text-shadow: 0 0 5px var(--neon-green); }
    }

    /* Code Block */
    .code-block {
      background: #001a1a;
      color: #00ff88;
      font-family: 'JetBrains Mono', monospace;
      padding: 15px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 15px 0;
      border-left: 4px solid var(--neon-green);
      position: relative;
    }

    .code-block::before {
      content: 'CODE';
      position: absolute;
      top: 0;
      right: 0;
      background: var(--neon-green);
      color: var(--primary);
      font-size: 0.7rem;
      padding: 2px 8px;
      border-bottom-left-radius: 4px;
      font-weight: bold;
    }

    /* Statistics Section */
    .stats-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin: 30px 0;
    }

    .stat-box {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
      min-width: 200px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      border-color: var(--neon-green);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .stat-label {
      color: var(--mid-gray);
      font-size: 0.9rem;
    }

    /* Quiz Section */
    .quiz-container {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .quiz-question {
      margin-bottom: 20px;
    }

    .quiz-question h4 {
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      background: rgba(0, 255, 136, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
    }

    .option.selected {
      background: var(--neon-green);
      color: var(--primary);
      font-weight: bold;
    }

    .score-display {
      text-align: center;
      font-size: 1.5rem;
      margin: 20px 0;
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
    }

    .button.quiz-submit {
      background: var(--neon-orange);
      color: white;
    }

    .button.quiz-submit:hover {
      background: #cc7000;
    }

    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: transparent;
      z-index: 1000;
    }

    .progress-bar {
      height: 100%;
      background: var(--neon-green);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Notification */
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--neon-green);
      border-radius: 8px;
      padding: 15px;
      color: var(--light-gray);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 60px 0;
      background: var(--dark-navy);
      color: var(--mid-gray);
      position: relative;
      overflow: hidden;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--neon-green), var(--electric-blue), var(--neon-pink));
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .social-link.github:hover { background: var(--neon-green); color: var(--primary); }
    .social-link.email:hover { background: var(--electric-blue); }
    .social-link.htb:hover { background: var(--neon-orange); }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-content h1 { font-size: 2.8rem; }
      .section-title { font-size: 1.8rem; }
      .diagram { flex-direction: column; }
      .arrow::before { content: '‚Üì'; }
      .input-group { flex-direction: column; }
      .input-group label { min-width: auto; }
    }
  </style>
</head>
<body>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <!-- Translator Button -->
  <button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="right: auto; left: 20px;">
    üåê Hinglish On
  </button>

  <!-- Keyword Modal -->
  <div class="keyword-modal" id="keyword-modal">
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h3 class="modal-title" id="modal-title">Keyword</h3>
      <div class="modal-body" id="modal-body">Definition will appear here.</div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i> <span id="notification-text">Welcome to the Authentication Vulnerabilities Masterclass!</span>
  </div>

  <!-- Three.js Background Canvas -->
  <canvas id="three-canvas"></canvas>

  <!-- Header / Hero -->
  <header id="home">
    <div class="container">
      <div class="hero-content"><!-- English Version -->
        <div class="en">
          <h1>Authentication <span>Vulnerabilities</span></h1>
          <div class="subtitle">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</div>
          <p>A deep dive into authentication flaws, bypass techniques, and real-world exploitation ‚Äî with interactive demos and elite-level insights.</p>
        </div>

        <!-- Hinglish Version -->
        <div class="hi" style="display:none;">
          <h1>Authentication <span>Vulnerabilities</span></h1>
          <div class="subtitle">Ankush Rana ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ | HTB Elite Hacker | Senior Security Engineer</div>
          <p>Authentication flaws, bypass techniques, aur real-world exploitation mein gahrai se jaane ‚Äî interactive demos aur elite-level samajh ke saath.</p>
        </div>

        <!-- HTB & Bug Bounty Credibility -->
        <div style="margin-top: 40px; display: flex; align-items: center; gap: 25px; flex-wrap: wrap; justify-content: center; font-family: 'JetBrains Mono', monospace;">
          <img src="https://www.hackthebox.com/storage/achievements/elite_2024_badge.svg" alt="HTB Elite" style="width: 90px; filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
          <div style="text-align: center;">
            <img src="https://via.placeholder.com/100/0a1121/00ff88?text=AR" alt="Ankush Rana" style="width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--neon-green); filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
            <p style="margin: 5px 0 0; color: var(--neon-green);">52+ User Flags</p>
            <p style="margin: 0; color: var(--electric-blue);">47+ Root Owned</p>
          </div>
          <div style="text-align: center;">
            <p style="color: var(--neon-orange);">üèÜ Top 10 India</p>
            <p style="color: var(--neon-pink);">üíº Sattrix | GPSSI</p>
          </div>
        </div>

        <!-- Call to Action -->
        <div style="margin-top: 30px; font-family: 'Orbitron', sans-serif; color: var(--electric-blue);">
          <i class="fas fa-mouse-pointer"></i> Toggle Hinglish Mode ‚Üí <strong>Top Right Corner</strong>
        <div style="display: flex; justify-content: center; margin-top: 10px;"><button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="position: relative; margin: 0 auto;">üåê Hinglish On</button></div>
        </div>
      </div>
    </div>
  </header>

  <!-- Section: What is Authentication -->
  <section id="basics">
    <div class="container">
      <h2 class="section-title en">What is Authentication?</h2>
      <h2 class="section-title hi" style="display:none;">Authentication Kya Hai?</h2>
      
      <!-- Progress Tracker -->
      <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
        <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-green);">1</div>
          <div class="step-title en">Basic Concepts</div>
          <div class="step-title hi" style="display:none;">Mool Baat</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--electric-blue);">2</div>
          <div class="step-title en">Attack Vectors</div>
          <div class="step-title hi" style="display:none;">Hamlawar Ke Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-orange);">3</div>
          <div class="step-title en">Advanced Techniques</div>
          <div class="step-title hi" style="display:none;">Uchatam Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 0, 128, 0.1); border: 1px solid var(--neon-pink); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-pink);">4</div>
          <div class="step-title en">Prevention</div>
          <div class="step-title hi" style="display:none;">Bachav</div>
        </div>
      </div>

      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">The Digital Identity Checkpoint</h3>
        <h3 class="hi" style="display:none;">Digital Pahchan Checkpoint</h3>
        <p class="en">Authentication is the process of verifying who a user claims to be. It's the first line of defense in any secure system.</p>
        <p class="hi" style="display:none;">Authentication ek prakriya hai jisme upyogkartri ke dava ko satyaapit kiya jaata hai. Yeh kisi bhi surakshit vyavastha mein prathamik suraksha rekha hai.</p>
        <p class="en">Modern systems rely on three main factors:</p>
        <p class="hi" style="display:none;">Aadhunik vyavasthaayen teen mukhy karkon par nirbhar karti hain:</p>
        <ul style="margin: 15px 0 15px 30px;">
          <li class="en"><strong><span class="keyword" data-title="Knowledge Factor" data-content="Something the user knows, such as a password, PIN, or answer to a security question.">Knowledge Factor</span></strong>: Passwords, PINs, security questions.</li>
          <li class="hi" style="display:none;"><strong><span class="keyword" data-title="Knowledge Factor" data-content="Kuchh jo upyogkartri jaanta hai, jaise ki password, PIN, ya suraksha prashn ka uttar.">Knowledge Factor</span></strong>: Passwords, PINs, suraksha prashn.</li>
          <li class="en"><strong><span class="keyword" data-title="Possession Factor" data-content="Something the user has, like a mobile device, security key, or TOTP app.">Possession Factor</span></strong>: Phone, token, authenticator app.</li>
          <li class="hi" style="display:none;"><strong><span class="keyword" data-title="Possession Factor" data-content="Kuchh jo upyogkartri ke paas hai, jaise ki mobile upakaran, suraksha key, ya TOTP app.">Possession Factor</span></strong>: Phone, token, authenticator app.</li>
          <li class="en"><strong><span class="keyword" data-title="Inherence Factor" data-content="Something the user is, such as fingerprint, facial features, or voice pattern.">Inherence Factor</span></strong>: Biometrics like fingerprint or face scan.</li>
          <li class="hi" style="display:none;"><strong><span class="keyword" data-title="Inherence Factor" data-content="Kuchh jo upyogkartri hai, jaise ki fingerprint, chehre ke lakshan, ya swar pattern.">Inherence Factor</span></strong>: Biometrics jaise fingerprint ya face scan.</li>
        </ul>
        <p class="en"><strong>Real Analogy:</strong> Like boarding a plane: ID (know), boarding pass (have), facial scan (are). Missing one weakens the whole system.</p>
        <p class="hi" style="display:none;"><strong>Asli Udaharan:</strong> Ek jahaj mein chadhne ke jaise: ID (jaanana), boarding pass (paas karna), facial scan (hona). Ek bhi chhut jaane se poori vyavastha kamzor ho jaati hai.</p>
      </div>

      <!-- Authentication Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">How Authentication Works - Visualization</h3>
        <h3 class="hi" style="display:none;">Authentication Kaise Kaam Karta Hai - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 180px;">
            <div class="en">User Credentials</div>
            <div class="hi" style="display:none;">Upyogkartri Shredentials</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Username + Password</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 180px;">
            <div class="en">Authentication Check</div>
            <div class="hi" style="display:none;">Pramaanikaran Jaanch</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Verification Logic</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 180px;">
            <div class="en">Access Granted</div>
            <div class="hi" style="display:none;">Pravesh Mila</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Session Created</div>
          </div>
        </div>
        <p class="en">The application verifies the user's credentials against stored values. When this verification is flawed, authentication vulnerabilities occur.</p>
        <p class="hi" style="display:none;">Application upyogkartri ke shredentials ko stored maanon ke saath satyaapit karta hai. Jab yeh satyaapan kharaabi yukta hota hai, toh authentication kamjoriyan utpann hoti hain.</p>
      </div>

      <!-- Statistics -->
      <div class="stats-container animate-on-scroll">
        <div class="stat-box">
          <div class="stat-number en">Critical</div>
          <div class="stat-number hi" style="display:none;">Khatarnaak</div>
          <div class="stat-label en">severity rating</div>
          <div class="stat-label hi" style="display:none;">khatre ka level</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">75%</div>
          <div class="stat-label en">of breaches start with auth failure</div>
          <div class="stat-label hi" style="display:none;">ullanghan auth failure se shuru hote hain</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">4.2M</div>
          <div class="stat-label en">passwords leaked monthly</div>
          <div class="stat-label hi" style="display:none;">passwords har mahine leak hote hain</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Auth vs Authz -->
  <section id="auth-vs-authz">
    <div class="container">
      <h2 class="section-title en">Authentication vs Authorization</h2>
      <h2 class="section-title hi" style="display:none;">Authentication vs Authorization</h2>
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Different but Critical</h3>
        <h3 class="hi" style="display:none;">Alag Par Mahatvapurna</h3>
        <p class="en"><span class="keyword" data-title="Authentication" data-content="The process of verifying a user's identity, typically through login credentials.">Authentication</span> answers: "Who are you?"<br>
        <span class="keyword" data-title="Authorization" data-content="The process of determining what actions a user is allowed to perform after logging in.">Authorization</span> answers: "What can you do?"</p>
        <p class="hi" style="display:none;"><span class="keyword" data-title="Authentication" data-content="Upyogkartri ki pahchan ko satyaapit karne ki prakriya, aam taur par login shredentials ke madhyam se.">Authentication</span> ka uttar hai: "Aap kaun hain?"<br>
        <span class="keyword" data-title="Authorization" data-content="Yeh nirdharit karne ki prakriya ki login karne ke baad upyogkartri ko kaun se karyon ki anumati hai.">Authorization</span> ka uttar hai: "Aap kya kar sakte hain?"</p>
        <p class="en">Even if authentication is strong, weak authorization can allow attackers to access admin functions.</p>
        <p class="hi" style="display:none;">Chahe authentication majaboot ho, kamzor authorization attackers ko prashashan karyon tak pravesh karne ki anumati de sakta hai.</p>
        <div class="diagram">
          <div class="box user-input">User: alice<br><small>Password: ‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</small></div>
          <div class="arrow"></div>
          <div class="box app">App: "Verified!"</div>
          <div class="arrow"></div>
          <div class="box db">DB: "Access: View Only"</div>
        </div>
        <p class="en">If authorization fails, Alice might gain admin rights ‚Äî even with a correct login.</p>
        <p class="hi" style="display:none;">Agar authorization fail ho jaata hai, toh Alice ko prashashan adhikar mil jaate hain ‚Äî yahaan tak ki sahi login ke saath bhi.</p>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself ‚Äì Password Reset Poisoning -->
  <section id="try-password-reset">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Password Reset Poisoning</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Password Reset Poisoning</h2>
      
      <!-- Learning Path Progress -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Learning Path: Basic to Advanced</h3>
        <h3 class="hi" style="display:none;">Sikshna Marg: Mool Se Uchatam</h3>
        <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
          <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-green);">1</div>
            <div class="step-title en">Basic Poisoning</div>
            <div class="step-title hi" style="display:none;">Mool Poisoning</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--electric-blue);">2</div>
            <div class="step-title en">Blind Poisoning</div>
            <div class="step-title hi" style="display:none;">Andha Poisoning</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-orange);">3</div>
            <div class="step-title en">Advanced Poisoning</div>
            <div class="step-title hi" style="display:none;">Uchatam Poisoning</div>
          </div>
        </div>
      </div>

      <!-- Basic Password Reset Poisoning Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Level 1: Basic Password Reset Poisoning</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Level 1: Mool Password Reset Poisoning</h3>
        <p class="en">Change the Host header to redirect the reset token to your server.</p>
        <p class="hi" style="display:none;">Reset token ko apne server par redirect karne ke liye Host header badlo.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="host-input" class="en">Host Header:</label>
            <label for="host-input" class="hi" style="display:none;">Host Header:</label>
            <input type="text" id="host-input" value="attacker.com">
          </div>
          <button class="button" onclick="runHostDemo()">Send Reset</button>
          <div class="result-box" id="host-result">
// Waiting for response...
          </div>
        </div>
      </div>

      <!-- Blind Password Reset Poisoning Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--electric-blue); margin-bottom: 15px;" class="en">Level 2: Blind Password Reset Poisoning (Out-of-Band)</h3>
        <h3 style="color: var(--electric-blue); margin-bottom: 15px; display:none;" class="hi">Level 2: Andha Password Reset Poisoning (Bahari)</h3>
        <p class="en">When direct output is not visible, use Blind Poisoning to exfiltrate data via HTTP requests to a collaborator server.</p>
        <p class="hi" style="display:none;">Jab seedha output nazar nahi aata, toh Blind Poisoning ka upyog HTTP requests ke zariye data ko bahar nikalne ke liye karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="blind-host-input" class="en">Blind Poisoning Payload:</label>
            <label for="blind-host-input" class="hi" style="display:none;">Andha Poisoning Payload:</label>
            <input type="text" id="blind-host-input" value="https://app.example.com/forgot-password?email=victim@company.com&redirect=YOUR_COLLABORATOR_ID.burpcollaborator.net" style="font-family: 'JetBrains Mono', monospace;">
          </div>
          <div class="code-block">
// Explanation:
// 1. Send a request with a manipulated Host header
// 2. Include your collaborator server in redirect parameter
// 3. Check your collaborator server for HTTP requests
          </div>
        </div>
      </div>

      <!-- Advanced Password Reset Poisoning Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-orange); margin-bottom: 15px;" class="en">Level 3: Advanced Password Reset Poisoning Techniques</h3>
        <h3 style="color: var(--neon-orange); margin-bottom: 15px; display:none;" class="hi">Level 3: Uchatam Password Reset Poisoning Tarika</h3>
        <p class="en">Use advanced techniques like header manipulation, parameter pollution, and chained attacks.</p>
        <p class="hi" style="display:none;">Header manipulation, parameter pollution, aur chained attacks jaise uchatam tarikon ka upyog karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="advanced-host-input" class="en">Advanced Poisoning Request:</label>
            <label for="advanced-host-input" class="hi" style="display:none;">Uchatam Poisoning Anurodh:</label>
            <input type="text" id="advanced-host-input" value="POST /forgot-password" style="font-family: 'JetBrains Mono', monospace;">
          </div>
          <div class="code-block">
// Example payloads:
// 1. Header manipulation: X-Forwarded-Host: attacker.com
// 2. Parameter pollution: ?email=victim@site.com&email=attacker@site.com
// 3. Chained attack: Combine with XSS or CSRF
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Brute-Force -->
  <section id="brute-force">
    <div class="container">
      <h2 class="section-title en">Brute-Force Attacks</h2>
      <h2 class="section-title hi" style="display:none;">Brute-Force Hamlawar</h2>
      
      <!-- Attack Vector Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Brute-Force Attack - Visualization</h3>
        <h3 class="hi" style="display:none;">Brute-Force Hamlawar - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Attack Attempts</div>
            <div class="hi" style="display:none;">Hamlawar Prayaas</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Thousands of guesses</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Rate Limiting</div>
            <div class="hi" style="display:none;">Dar Ki Simit</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Account Lockout</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Successful Login</div>
            <div class="hi" style="display:none;">Safal Login</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Account Compromised</div>
          </div>
        </div>
      </div>

      <!-- Brute-Force Techniques with Examples -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Brute-Force Techniques</h3>
        <h3 class="hi" style="display:none;">Brute-Force Tarika</h3>
        
        <!-- Common Tools -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Common Tools</h4>
          <p class="en">When login pages don't enforce rate limits, attackers use tools to try thousands of passwords per minute.</p>
          <p class="hi" style="display:none;">Jab login pages dar ki simit nahi lagate, toh attackers ajarat mein hazaron passwords pratiminat try karne ke liye upakaran ka upyog karte hain.</p>
          <div class="code-block">
Common Tools:
- Hydra: Fast network logon cracker
- Burp Intruder: Automated attack tool
- FFUF: Fast web fuzzer
- Medusa: Parallel network login auditor
          </div>
        </div>
        
        <!-- Wordlists -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Wordlists</h4>
          <p class="en">Effective brute-force attacks rely on quality wordlists tailored to the target.</p>
          <p class="hi" style="display:none;">Prabhavi brute-force hamlawar lakshya ke anukool gunita shabdavaliyon par nirbhar karti hain.</p>
          <div class="code-block">
Popular Wordlists:
- rockyou.txt: 14M commonly used passwords
- common-passwords.txt: Top 10K passwords
- usernames.txt: Common username variations
- custom-lists: Target-specific information
          </div>
        </div>
        
        <!-- Hydra Example -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Hydra Example</h4>
          <p class="en">Hydra is one of the most popular brute-force tools for attacking authentication systems.</p>
          <p class="hi" style="display:none;">Hydra pramaanikaran vyavasthaon par hamlawar karne ke liye sabse lokpriya brute-force upakarano mein se ek hai.</p>
          <div class="code-block">
// Basic HTTP POST brute-force
hydra -l admin -P /wordlists/10k-common.txt site.com http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"

// SSH brute-force
hydra -L users.txt -P passwords.txt ssh://target-ip

// FTP brute-force with specific port
hydra -l ftpuser -P pass.txt ftp://target-ip:21
          </div>
        </div>
      </div>

      <!-- Try Brute-Force -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Try It Yourself: Brute-Force Login</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Khud Try Karein: Brute-Force Login</h3>
        <p class="en">Guess the password from a wordlist.</p>
        <p class="hi" style="display:none;">Shabdavali se password ka anuman lagao.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="pass-input" class="en">Password Guess:</label>
            <label for="pass-input" class="hi" style="display:none;">Password Anuman:</label>
            <input type="text" id="pass-input" placeholder="e.g., password123">
          </div>
          <button class="button" onclick="runBruteDemo()">Try Login</button>
          <div class="result-box" id="brute-result">
// Enter a guess to start
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: MFA Bypass -->
  <section id="mfa-bypass">
    <div class="container">
      <h2 class="section-title en">MFA Bypass</h2>
      <h2 class="section-title hi" style="display:none;">MFA Bypass</h2>
      
      <!-- Bypass Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">MFA Bypass - Visualization</h3>
        <h3 class="hi" style="display:none;">MFA Bypass - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Password Entered</div>
            <div class="hi" style="display:none;">Password Darj Kiya</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">First Factor</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">MFA Bypass Techniques</div>
            <div class="hi" style="display:none;">MFA Bypass Tarika</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Logic Flaws</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Full Access</div>
            <div class="hi" style="display:none;">Poora Pravesh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Account Compromised</div>
          </div>
        </div>
      </div>

      <!-- MFA Bypass Techniques -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Breaking the Second Layer</h3>
        <h3 class="hi" style="display:none;">Dusra Perton Todna</h3>
        <p class="en">MFA adds security, but logic flaws can allow bypass. Common techniques:</p>
        <p class="hi" style="display:none;">MFA suraksha jodta hai, lekin tarkik dosh bypass ki anumati de sakte hain. Saamanya tarika:</p>
        <ul style="margin: 15px 0 15px 30px;">
          <li class="en"><strong>Session Reuse:</strong> Old session remains valid after password reset.</li>
          <li class="hi" style="display:none;"><strong>Session Punh:upayog:</strong> Password reset ke baad purana session valid rahta hai.</li>
          <li class="en"><strong>Weak Token Binding:</strong> MFA token not tied to IP or device.</li>
          <li class="hi" style="display:none;"><strong>Kamzor Token Bandhan:</strong> MFA token IP ya upakaran se juda nahi hota.</li>
          <li class="en"><strong>Flawed Recovery:</strong> MFA reset flow can be manipulated.</li>
          <li class="hi" style="display:none;"><strong>Kharaabi Yukta Punarprapti:</strong> MFA reset pravah ko chhedha ja sakta hai.</li>
        </ul>
        <p class="en"><strong>Real Analogy:</strong> You change your house lock, but the burglar still has the old key that wasn't invalidated.</p>
        <p class="hi" style="display:none;"><strong>Asli Udaharan:</strong> Aap apne ghar ke tala badal dete hain, lekin chor ke paas purana chaabi hai jo aganya nahi kiya gaya.</p>
        <div class="code-block">
GET /account?session=admin123 HTTP/1.1
Host: site.com
‚Üí Access Granted (MFA bypassed)
        </div>
        <p class="en"><span class="keyword" data-title="MFA Bypass" data-content="Exploiting logic flaws to skip or bypass multi-factor authentication, even when it's implemented.">MFA Bypass</span> shows that security is only as strong as its weakest implementation.</p>
        <p class="hi" style="display:none;"><span class="keyword" data-title="MFA Bypass" data-content="Tarkik doshon ka fayda utha kar multi-factor authentication ko chhodna ya bypass karna, chahe yeh lagu kiya gaya ho.">MFA Bypass</span> dikhata hai ki suraksha sirf apne sabse kamzor karyaanvayan jitni majaboot hoti hai.</p>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself ‚Äì MFA Bypass -->
  <section id="try-mfa">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: MFA Bypass</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: MFA Bypass</h2>
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Exploit MFA Logic Flaws</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">MFA Tarkik Doshon Ka Faida Uthao</h3>
        <p class="en">Attempt to bypass MFA by exploiting session management flaws.</p>
        <p class="hi" style="display:none;">Session prabandhan doshon ka fayda utha kar MFA ko bypass karne ka prayas karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="mfa-input" class="en">Session Cookie:</label>
            <label for="mfa-input" class="hi" style="display:none;">Session Cookie:</label>
            <input type="text" id="mfa-input" value="session=old_valid_session_token">
          </div>
          <button class="button" onclick="runMfaBypass()">Bypass MFA</button>
          <div class="result-box" id="mfa-result">
// Try bypassing MFA
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Prevention -->
  <section id="prevention">
    <div class="container">
      <h2 class="section-title en">How to Prevent Auth Vulnerabilities</h2>
      <h2 class="section-title hi" style="display:none;">Auth Kamjoriyan Ko Kaise Rokein</h2>
      
      <!-- Prevention Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Authentication Prevention - Visualization</h3>
        <h3 class="hi" style="display:none;">Pramaanikaran Bachav - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Malicious Login</div>
            <div class="hi" style="display:none;">Dushit Login</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Brute-force attempt</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Defense Layers</div>
            <div class="hi" style="display:none;">Bachav Perton</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Rate Limiting, MFA</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Blocked Request</div>
            <div class="hi" style="display:none;">Rukawat Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Access Denied</div>
          </div>
        </div>
      </div>

      <!-- Secure Coding Practices -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Secure Authentication Practices</h3>
        <h3 class="hi" style="display:none;">Surakshit Pramaanikaran Abhyas</h3>
        
        <!-- Rate Limiting -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Implement Rate Limiting</h4>
          <p class="en">Limit login attempts to prevent brute-force attacks.</p>
          <p class="hi" style="display:none;">Brute-force hamlawaron ko rokne ke liye login prayaason ki simit lagayein.</p>
          <div class="code-block">
// Example: Rate limiting with Redis
const rateLimiter = require('express-rate-limit');

const loginLimiter = rateLimiter({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 5, // limit each IP to 5 requests per windowMs
  message: "Too many login attempts, please try again later"
});

app.post('/login', loginLimiter, (req, res) => {
  // Authentication logic here
});
          </div>
        </div>
        
        <!-- Account Lockout -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Account Lockout Mechanism</h4>
          <p class="en">Temporarily lock accounts after too many failed login attempts.</p>
          <p class="hi" style="display:none;">Bahut saare failed login prayaason ke baad khaate ko astitvkal lock karein.</p>
          <div class="code-block">
// Example: Account lockout implementation
function handleFailedLogin(user) {
  user.failedAttempts += 1;
  
  if (user.failedAttempts >= 5) {
    user.isLocked = true;
    user.lockedUntil = new Date(Date.now() + 30 * 60 * 1000); // 30 minutes
  }
  
  await user.save();
}
          </div>
        </div>
        
        <!-- Secure Reset -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Secure Password Reset</h4>
          <p class="en">Use one-time tokens for password reset, never rely on the Host header.</p>
          <p class="hi" style="display:none;">Password reset ke liye ek baar ke tokens ka upyog karein, kabhi Host header par nirbhar na karein.</p>
          <div class="code-block">
// Example: Secure password reset token
const crypto = require('crypto');

function generateResetToken() {
  return crypto.randomBytes(32).toString('hex');
}

// Store hashed token in database
const resetToken = generateResetToken();
const hashedToken = crypto.createHash('sha256').update(resetToken).digest('hex');

// Send plain token to user via email
// Store only hashed version in database
          </div>
        </div>
        
        <!-- MFA Enforcement -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. MFA Enforcement</h4>
          <p class="en">Require multi-factor authentication for all privileged accounts.</p>
          <p class="hi" style="display:none;">Sabhi garimit khaaton ke liye multi-factor authentication ki aavashyakta hai.</p>
          <div class="code-block">
// Example: MFA requirement check
function requireMFA(req, res, next) {
  if (req.user.role === 'admin' && !req.user.mfaEnabled) {
    return res.status(403).json({
      message: 'MFA required for admin accounts'
    });
  }
  next();
}

app.use('/admin', requireMFA, adminRoutes);
          </div>
        </div>
      </div>

      <!-- Lab Environment Simulation -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Lab Environment Simulation</h3>
        <h3 class="hi" style="display:none;">Prayogshala Vatavaran Anukaran</h3>
        <p class="en">Set up a safe environment to test authentication prevention techniques without risking production systems.</p>
        <p class="hi" style="display:none;">Utpadan pranaliyon ko jokhim mein daale bina pramaanikaran bachav tarikon ka parikshan karne ke liye surakshit vatanavaran sthapit karein.</p>
        
        <div class="interactive-demo animate-on-scroll">
          <h4 style="color: var(--neon-green);">Authentication Prevention Testing</h4>
          <div class="demo-container">
            <div class="input-group">
              <label for="test-input" class="en">Test Scenario:</label>
              <label for="test-input" class="hi" style="display:none;">Parikshan Dristikaun:</label>
              <input type="text" id="test-input" value="Rate limiting test">
            </div>
            <button class="button" onclick="runPreventionTest()">Run Test</button>
            <div class="result-box" id="prevention-result">
// Prevention test results will appear here
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Quiz Section -->
  <section id="quiz">
    <div class="container">
      <h2 class="section-title en">Authentication Vulnerabilities Quiz</h2>
      <h2 class="section-title hi" style="display:none;">Authentication Kamjoriyan Quiz</h2>
      
      <div class="quiz-container">
        <div class="score-display" id="quiz-score">Score: 0/5</div>
        
        <!-- Question 1 -->
        <div class="quiz-question">
          <h4 class="en">1. What is the primary difference between authentication and authorization?</h4>
          <h4 class="hi" style="display:none;">1. Authentication aur authorization mein mukhya antar kya hai?</h4>
          <div class="options">
            <div class="option en" data-question="1" data-correct="false">A) Authentication verifies user identity, authorization controls access to resources</div>
            <div class="option hi" data-question="1" data-correct="false" style="display:none;">A) Authentication upyogkartri ki pahchan ko satyaapit karta hai, authorization sankhon tak pravesh ko niyantrit karta hai</div>
            <div class="option en" data-question="1" data-correct="true">B) Authentication controls access to resources, authorization verifies user identity</div>
            <div class="option hi" data-question="1" data-correct="true" style="display:none;">B) Authentication sankhon tak pravesh ko niyantrit karta hai, authorization upyogkartri ki pahchan ko satyaapit karta hai</div>
            <div class="option en" data-question="1" data-correct="false">C) Both terms mean the same thing</div>
            <div class="option hi" data-question="1" data-correct="false" style="display:none;">C) Dono shabd ek hi arth rakhte hain</div>
            <div class="option en" data-question="1" data-correct="false">D) Authentication is for admins only, authorization is for regular users</div>
            <div class="option hi" data-question="1" data-correct="false" style="display:none;">D) Authentication sirf prashashan ke liye hai, authorization niyamit upyogkartron ke liye hai</div>
          </div>
        </div>
        
        <!-- Question 2 -->
        <div class="quiz-question">
          <h4 class="en">2. Which of the following is a common technique for password reset poisoning?</h4>
          <h4 class="hi" style="display:none;">2. Niche diye gaye vikalpon mein se kaun password reset poisoning ke liye ek saamanya tarika hai?</h4>
          <div class="options">
            <div class="option en" data-question="2" data-correct="false">A) Brute-forcing the user's password</div>
            <div class="option hi" data-question="2" data-correct="false" style="display:none;">A) Upyogkartri ke password ko brute-force karna</div>
            <div class="option en" data-question="2" data-correct="true">B) Manipulating the Host header to redirect the reset token</div>
            <div class="option hi" data-question="2" data-correct="true" style="display:none;">B) Reset token ko redirect karne ke liye Host header ko chhedna</div>
            <div class="option en" data-question="2" data-correct="false">C) Using a dictionary attack on the login page</div>
            <div class="option hi" data-question="2" data-correct="false" style="display:none;">C) Login page par dictionary attack ka upyog karna</div>
            <div class="option en" data-question="2" data-correct="false">D) Exploiting a SQL injection vulnerability</div>
            <div class="option hi" data-question="2" data-correct="false" style="display:none;">D) SQL injection kamjori ka fayda uthana</div>
          </div>
        </div>
        
        <!-- Question 3 -->
        <div class="quiz-question">
          <h4 class="en">3. What is the main purpose of rate limiting in authentication systems?</h4>
          <h4 class="hi" style="display:none;">3. Authentication vyavasthaon mein dar ki simit (rate limiting) ka mukhya uddeshya kya hai?</h4>
          <div class="options">
            <div class="option en" data-question="3" data-correct="true">A) To prevent brute-force attacks</div>
            <div class="option hi" data-question="3" data-correct="true" style="display:none;">A) Brute-force hamlawaron ko rokna</div>
            <div class="option en" data-question="3" data-correct="false">B) To improve user experience</div>
            <div class="option hi" data-question="3" data-correct="false" style="display:none;">B) Upyogkartri anubhav ko sudhar na</div>
            <div class="option en" data-question="3" data-correct="false">C) To encrypt user passwords</div>
            <div class="option hi" data-question="3" data-correct="false" style="display:none;">C) Upyogkartri ke passwords ko encrypt karna</div>
            <div class="option en" data-question="3" data-correct="false">D) To store session data</div>
            <div class="option hi" data-question="3" data-correct="false" style="display:none;">D) Session data ko store karna</div>
          </div>
        </div>
        
        <!-- Question 4 -->
        <div class="quiz-question">
          <h4 class="en">4. Which MFA bypass technique exploits session management flaws?</h4>
          <h4 class="hi" style="display:none;">4. Kaun sa MFA bypass tarika session prabandhan doshon ka fayda uthata hai?</h4>
          <div class="options">
            <div class="option en" data-question="4" data-correct="false">A) Password spraying</div>
            <div class="option hi" data-question="4" data-correct="false" style="display:none;">A) Password spraying</div>
            <div class="option en" data-question="4" data-correct="true">B) Session reuse after password reset</div>
            <div class="option hi" data-question="4" data-correct="true" style="display:none;">B) Password reset ke baad session punh:upayog</div>
            <div class="option en" data-question="4" data-correct="false">C) Token interception</div>
            <div class="option hi" data-question="4" data-correct="false" style="display:none;">C) Token atirikt</div>
            <div class="option en" data-question="4" data-correct="false">D) Social engineering</div>
            <div class="option hi" data-question="4" data-correct="false" style="display:none;">D) Samajik abhiyantrika</div>
          </div>
        </div>
        
        <!-- Question 5 -->
        <div class="quiz-question">
          <h4 class="en">5. What is the recommended approach for secure password reset functionality?</h4>
          <h4 class="hi" style="display:none;">5. Surakshit password reset functionality ke liye kya anushansa kiya gaya hai?</h4>
          <div class="options">
            <div class="option en" data-question="5" data-correct="false">A) Send the user's current password via email</div>
            <div class="option hi" data-question="5" data-correct="false" style="display:none;">A) Upyogkartri ke vartaman password ko email ke zariye bhejna</div>
            <div class="option en" data-question="5" data-correct="true">B) Generate a time-limited, single-use token</div>
            <div class="option hi" data-question="5" data-correct="true" style="display:none;">B) Samay-simit, ek baar upyog ke liye token utpann karna</div>
            <div class="option en" data-question="5" data-correct="false">C) Allow password reset via security questions only</div>
            <div class="option hi" data-question="5" data-correct="false" style="display:none;">C) Kewal suraksha prashnon ke zariye password reset ki anumati dena</div>
            <div class="option en" data-question="5" data-correct="false">D) Reset password immediately upon email request</div>
            <div class="option hi" data-question="5" data-correct="false" style="display:none;">D) Email anurodh par turant password reset karna</div>
          </div>
        </div>
        
        <button class="button quiz-submit" onclick="submitQuiz()" style="margin-top: 20px;">
          <span class="en">Submit Quiz</span>
          <span class="hi" style="display:none;">Quiz Jaman Karen</span>
        </button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <h3 style="color: var(--neon-green); font-family: 'Orbitron', sans-serif; margin-bottom: 20px;">
        <span class="en">Authentication Vulnerabilities Masterclass</span>
        <span class="hi" style="display:none;">Authentication Kamjoriyan Masterclass</span>
      </h3>
      <p class="en">This lecture is part of the Penetration Testing Professional Course by Ankush Rana. All content is for educational purposes only.</p>
      <p class="hi" style="display:none;">Yeh vyakhyan Ankush Rana dwara Penetration Testing Professional Course ka hissa hai. Sabhi saamagri keval shiksha uddeshyon ke liye hai.</p>
      
      <div class="social-links">
        <a href="#" class="social-link github"><i class="fab fa-github"></i></a>
        <a href="#" class="social-link email"><i class="fas fa-envelope"></i></a>
        <a href="#" class="social-link htb"><i class="fas fa-graduation-cap"></i></a>
      </div>
      
      <p style="margin-top: 30px; color: var(--mid-gray); font-size: 0.9rem;">
        <span class="en">¬© 2025 Ankush Rana | HTB Elite Hacker | Senior Security Engineer</span>
        <span class="hi" style="display:none;">¬© 2025 Ankush Rana | HTB Elite Hacker | Senior Security Engineer</span>
      </p>
    </div>
  </footer>

  <script>
    // Global variables
    let currentLanguage = 'en';
    let quizAnswers = {};
    let score = 0;

    // DOM Ready
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize Three.js background
      initThreeJS();
      
      // Set up scroll animations
      setupScrollAnimations();
      
      // Set up keyword tooltips
      setupKeywordTooltips();
      
      // Update progress bar on scroll
      window.addEventListener('scroll', updateProgressBar);
      
      // Show initial notification
      showNotification('Welcome to the Authentication Vulnerabilities Masterclass!');
    });

    // Three.js Background
    function initThreeJS() {
      // Create canvas
      const canvas = document.getElementById('three-canvas');
      const ctx = canvas.getContext('2d');
      
      // Set canvas size
      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);
      
      // Create particles
      const particles = [];
      const particleCount = 100;
      
      for (let i = 0; i < particleCount; i++) {
        particles.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          radius: Math.random() * 2 + 1,
          speed: Math.random() * 0.5 + 0.1,
          angle: Math.random() * Math.PI * 2
        });
      }
      
      // Animation loop
      function animate() {
        // Clear canvas with a semi-transparent overlay for trail effect
        ctx.fillStyle = 'rgba(10, 17, 33, 0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        // Update and draw particles
        particles.forEach(particle => {
          // Move particle
          particle.x += Math.cos(particle.angle) * particle.speed;
          particle.y += Math.sin(particle.angle) * particle.speed;
          
          // Bounce off edges
          if (particle.x < 0 || particle.x > canvas.width) {
            particle.angle = Math.PI - particle.angle;
          }
          if (particle.y < 0 || particle.y > canvas.height) {
            particle.angle = -particle.angle;
          }
          
          // Draw particle
          ctx.beginPath();
          ctx.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2);
          ctx.fillStyle = `rgba(0, 255, 136, ${Math.random() * 0.5 + 0.3})`;
          ctx.fill();
        });
        
        requestAnimationFrame(animate);
      }
      
      animate();
    }

    // Scroll Animations
    function setupScrollAnimations() {
      const cards = document.querySelectorAll('.lecture-card');
      
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate-on-scroll');
          }
        });
      }, { threshold: 0.1 });
      
      cards.forEach(card => {
        observer.observe(card);
      });
    }

    // Update Progress Bar
    function updateProgressBar() {
      const progressBar = document.getElementById('progress-bar');
      // Check if progress bar element exists
      if (!progressBar) return;
      
      const scrollTop = window.scrollY;
      const docHeight = document.body.scrollHeight - window.innerHeight;
      const scrollPercent = (scrollTop / docHeight) * 100;
      
      progressBar.style.width = scrollPercent + '%';
    }

    // Keyword Tooltips
    function setupKeywordTooltips() {
      const keywords = document.querySelectorAll('.keyword');
      
      keywords.forEach(keyword => {
        keyword.addEventListener('click', function(e) {
          e.stopPropagation();
          
          const title = this.getAttribute('data-title');
          const content = this.getAttribute('data-content');
          
          document.getElementById('modal-title').textContent = title;
          document.getElementById('modal-body').textContent = content;
          
          document.getElementById('keyword-modal').classList.add('active');
        });
      });
      
      // Close modal
      document.getElementById('modal-close').addEventListener('click', function() {
        document.getElementById('keyword-modal').classList.remove('active');
      });
      
      // Close modal when clicking outside
      document.getElementById('keyword-modal').addEventListener('click', function(e) {
        if (e.target === this) {
          this.classList.remove('active');
        }
      });
    }

    // Card Interactions
    function highlightCard(card) {
      card.classList.add('pop-out');
    }

    function unhighlightCard(card) {
      card.classList.remove('pop-out');
    }

    function focusCard(card) {
      // Remove focus from all cards
      document.querySelectorAll('.lecture-card').forEach(c => {
        c.classList.remove('focused');
      });
      
      // Add focus to clicked card
      card.classList.add('focused');
    }

    // Language Toggle
    function toggleLanguage() {
      currentLanguage = currentLanguage === 'en' ? 'hi' : 'en';
      
      // Toggle visibility of language elements
      document.querySelectorAll('.en, .hi').forEach(el => {
        if (el.classList.contains('en')) {
          el.style.display = currentLanguage === 'en' ? 'block' : 'none';
        } else {
          el.style.display = currentLanguage === 'hi' ? 'block' : 'none';
        }
      });
      
      // Update button text
      document.getElementById('translator-btn').innerHTML = 
        currentLanguage === 'en' ? 'üåê Hinglish On' : 'üåê English On';
      
      // Show notification
      showNotification(currentLanguage === 'en' ? 
        'Switched to English mode' : 'Hinglish mode par aapka swagat hai');
    }

    // Notification System
    function showNotification(message) {
      const notification = document.getElementById('notification');
      const notificationText = document.getElementById('notification-text');
      
      notificationText.textContent = message;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }

    // Interactive Demo Functions
    function runHostDemo() {
      const hostInput = document.getElementById('host-input').value;
      const resultBox = document.getElementById('host-result');
      
      resultBox.textContent = `Sending password reset request with Host header: ${hostInput}\n\n`;
      resultBox.textContent += `POST /forgot-password HTTP/1.1\n`;
      resultBox.textContent += `Host: ${hostInput}\n`;
      resultBox.textContent += `Content-Type: application/x-www-form-urlencoded\n\n`;
      resultBox.textContent += `email=victim@example.com\n\n`;
      resultBox.textContent += `Response: Reset token sent to attacker@${hostInput}\n`;
      resultBox.textContent += `‚úÖ Password reset token intercepted!`;
    }

    function runBruteDemo() {
      const passInput = document.getElementById('pass-input').value;
      const resultBox = document.getElementById('brute-result');
      
      const commonPasswords = ['password', '123456', 'admin', 'welcome', 'password123'];
      const correctPassword = 'admin123';
      
      if (passInput === correctPassword) {
        resultBox.textContent = `‚úÖ SUCCESS! Password found: ${passInput}\n`;
        resultBox.textContent += `Access granted to admin panel.`;
        showNotification('Login successful!');
      } else if (commonPasswords.includes(passInput)) {
        resultBox.textContent = `‚ùå FAILED: ${passInput} is incorrect\n`;
        resultBox.textContent += `Trying next password...`;
      } else {
        resultBox.textContent = `‚ùå FAILED: ${passInput} is incorrect\n`;
        resultBox.textContent += `Password not in wordlist. Try: password, 123456, admin`;
      }
    }

    function runMfaBypass() {
      const mfaInput = document.getElementById('mfa-input').value;
      const resultBox = document.getElementById('mfa-result');
      
      resultBox.textContent = `Attempting MFA bypass with session: ${mfaInput}\n\n`;
      resultBox.textContent += `GET /admin/dashboard HTTP/1.1\n`;
      resultBox.textContent += `Cookie: ${mfaInput}\n\n`;
      resultBox.textContent += `Response: HTTP/1.1 200 OK\n`;
      resultBox.textContent += `‚úÖ MFA bypass successful! Admin access granted.`;
      showNotification('MFA bypass successful!');
    }

    function runPreventionTest() {
      const testInput = document.getElementById('test-input').value;
      const resultBox = document.getElementById('prevention-result');
      
      resultBox.textContent = `Running prevention test: ${testInput}\n\n`;
      resultBox.textContent += `Testing rate limiting implementation...\n`;
      resultBox.textContent += `Sending 10 login requests in 5 seconds\n`;
      resultBox.textContent += `‚úÖ Rate limiting working correctly\n`;
      resultBox.textContent += `Requests blocked after 5 attempts\n`;
      resultBox.textContent += `Account locked for 30 minutes after 10 failed attempts`;
    }

    // Quiz Functions
    function submitQuiz() {
      score = 0;
      const questions = document.querySelectorAll('.quiz-question');
      
      questions.forEach(question => {
        const options = question.querySelectorAll('.option');
        let answered = false;
        
        options.forEach(option => {
          const isCorrect = option.getAttribute('data-correct') === 'true';
          const isSelected = option.classList.contains('selected');
          
          if (isSelected) {
            answered = true;
            if (isCorrect) {
              score++;
              option.style.background = 'var(--neon-green)';
              option.style.color = 'var(--primary)';
            } else {
              option.style.background = 'var(--neon-pink)';
              option.style.color = 'white';
            }
          } else if (isCorrect && !isSelected) {
            option.style.background = 'rgba(0, 255, 136, 0.3)';
          }
        });
        
        if (!answered) {
          question.style.borderLeft = '3px solid var(--neon-orange)';
        }
      });
      
      document.getElementById('quiz-score').textContent = `Score: ${score}/5`;
      
      // Show final message
      let message = '';
      if (score === 5) {
        message = 'üèÜ Perfect Score! You are an Authentication Security Expert!';
      } else if (score >= 3) {
        message = 'üëç Good Job! You understand authentication vulnerabilities well.';
      } else {
        message = 'üìö Keep learning! Review the material and try again.';
      }
      
      showNotification(message);
    }

    // Option Selection
    document.querySelectorAll('.option').forEach(option => {
      option.addEventListener('click', function() {
        // Remove selection from siblings
        const siblings = this.parentElement.querySelectorAll('.option');
        siblings.forEach(sib => sib.classList.remove('selected'));
        
        // Add selection to this option
        this.classList.add('selected');
      });
    });

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      // Set up all event listeners and initial state
      console.log('Authentication Vulnerabilities Lecture Loaded');
    });
  </script>
</body>
</html>