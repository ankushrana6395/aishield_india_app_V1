<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Interactive Business Logic Vulnerabilities Masterclass with Live Hinglish Translation | Quiz | Try It Yourself | By HTB Elite Hacker">
  <title>Business Logic Vulnerabilities | By Ankush Rana</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;600;700;900&family=Roboto:wght@300;400;500;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --primary: #0a1121;
      --dark-navy: #0b1b30;
      --neon-green: #00ff88;
      --electric-blue: #00aaff;
      --neon-orange: #ff8800;
      --neon-pink: #ff0080;
      --glow-green: rgba(0, 255, 136, 0.3);
      --glow-blue: rgba(0, 170, 255, 0.2);
      --glow-pink: rgba(255, 0, 128, 0.3);
      --light-gray: #e0e0e0;
      --mid-gray: #aaaaaa;
      --card-bg: #111c30;
      --border: #2a4060;
      --keyword: #ffdd57;
      --keyword-bg: rgba(255, 221, 87, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--primary);
      color: var(--light-gray);
      line-height: 1.7;
      overflow-x: hidden;
    }

    /* Three.js Background */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Translator Button */
    .translator-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 0 15px var(--glow-green);
      transition: all 0.3s ease;
    }

    .translator-btn:hover {
      transform: translateY(-2px);
      background: #00cc6d;
    }

    /* Header / Hero */
    header {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-content {
      z-index: 2;
      max-width: 900px;
      position: relative;
    }

    .hero-content h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2.8rem, 8vw, 4rem);
      color: white;
      margin-bottom: 10px;
      text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
      50% { text-shadow: 0 0 25px rgba(0, 255, 136, 0.9), 0 0 35px rgba(0, 255, 136, 0.5); }
      100% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
    }

    .hero-content h1 span {
      color: var(--neon-green);
    }

    .subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: clamp(1.2rem, 3.5vw, 1.5rem);
      color: var(--electric-blue);
      margin: 15px 0;
    }

    /* Section Styling */
    section {
      padding: 100px 0;
      position: relative;
    }

    .section-title {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2rem, 5vw, 2.5rem);
      color: var(--neon-green);
      margin-bottom: 50px;
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -8px;
      width: 70px;
      height: 4px;
      background: var(--electric-blue);
      animation: expand 2s infinite;
    }

    @keyframes expand {
      0% { width: 70px; }
      50% { width: 100px; }
      100% { width: 70px; }
    }

    /* Lecture Card */
    .lecture-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .lecture-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 136, 0.05), transparent);
      z-index: 0;
    }

    .lecture-card.pop-out {
      transform: translateY(-20px) scale(1.05);
      box-shadow: 
        0 30px 60px rgba(0, 0, 0, 0.5),
        0 0 50px var(--glow-green);
      border-color: var(--neon-green);
      z-index: 5;
    }

    .lecture-card.focused {
      transform: translateY(-20px) scale(1.06);
      box-shadow: 
        0 40px 80px rgba(0, 0, 0, 0.6),
        0 0 70px var(--glow-green);
      filter: brightness(1.1);
    }

    .lecture-card h3 {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 18px;
      font-size: 1.8rem;
      position: relative;
      z-index: 2;
    }

    /* Keyword Style */
    .keyword {
      background: var(--keyword-bg);
      color: var(--keyword);
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 1px dashed var(--keyword);
      position: relative;
      transition: all 0.3s ease;
      z-index: 2;
    }

    .keyword:hover {
      background: rgba(255, 221, 87, 0.3);
      box-shadow: 0 0 12px rgba(255, 221, 87, 0.4);
    }

    /* Tooltip (Modal) */
    .keyword-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 17, 33, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .keyword-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border: 2px solid var(--neon-green);
      border-radius: 14px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 50px var(--glow-green);
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .keyword-modal.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--neon-green);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-title {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .modal-body {
      color: var(--light-gray);
      line-height: 1.6;
    }

    /* Interactive Demo */
    .interactive-demo {
      background: rgba(0, 20, 40, 0.6);
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      border: 1px solid var(--electric-blue);
    }

    .demo-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .input-group label {
      min-width: 120px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--neon-green);
    }

    .input-group input {
      flex: 1;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: white;
      font-family: 'JetBrains Mono', monospace;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--neon-green);
      box-shadow: 0 0 10px var(--glow-green);
    }

    .button {
      padding: 12px 24px;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 4px;
      font-family: 'Orbitron', sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: fit-content;
    }

    .button:hover {
      background: #00cc6d;
      box-shadow: 0 0 15px var(--glow-green);
      transform: translateY(-2px);
    }

    .result-box {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 6px;
      padding: 15px;
      margin-top: 15px;
      border-left: 3px solid var(--neon-green);
      font-family: 'JetBrains Mono', monospace;
      min-height: 100px;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    /* Diagram */
    .diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }

    .box {
      min-width: 140px;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      font-weight: bold;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }

    .box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
    }

    .box:hover::before {
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }

    .user-input { background: #8b0000; color: white; }
    .app { background: #003366; color: white; }
    .db { background: #004d00; color: #00ff88; }

    .arrow {
      font-size: 1.8rem;
      color: var(--neon-green);
      position: relative;
    }

    .arrow::before {
      content: '→';
      animation: arrow-pulse 1.5s infinite;
    }

    @keyframes arrow-pulse {
      0% { text-shadow: 0 0 5px var(--neon-green); }
      50% { text-shadow: 0 0 15px var(--neon-green); }
      100% { text-shadow: 0 0 5px var(--neon-green); }
    }

    /* Code Block */
    .code-block {
      background: #001a1a;
      color: #00ff88;
      font-family: 'JetBrains Mono', monospace;
      padding: 15px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 15px 0;
      border-left: 4px solid var(--neon-green);
      position: relative;
    }

    .code-block::before {
      content: 'CODE';
      position: absolute;
      top: 0;
      right: 0;
      background: var(--neon-green);
      color: var(--primary);
      font-size: 0.7rem;
      padding: 2px 8px;
      border-bottom-left-radius: 4px;
      font-weight: bold;
    }

    /* Statistics Section */
    .stats-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin: 30px 0;
    }

    .stat-box {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
      min-width: 200px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      border-color: var(--neon-green);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .stat-label {
      color: var(--mid-gray);
      font-size: 0.9rem;
    }

    /* Quiz Section */
    .quiz-container {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .quiz-question {
      margin-bottom: 20px;
    }

    .quiz-question h4 {
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      background: rgba(0, 255, 136, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
    }

    .option.selected {
      background: var(--neon-green);
      color: var(--primary);
      font-weight: bold;
    }

    .score-display {
      text-align: center;
      font-size: 1.5rem;
      margin: 20px 0;
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
    }

    .button.quiz-submit {
      background: var(--neon-orange);
      color: white;
    }

    .button.quiz-submit:hover {
      background: #cc7000;
    }

    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: transparent;
      z-index: 1000;
    }

    .progress-bar {
      height: 100%;
      background: var(--neon-green);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Notification */
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--neon-green);
      border-radius: 8px;
      padding: 15px;
      color: var(--light-gray);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 60px 0;
      background: var(--dark-navy);
      color: var(--mid-gray);
      position: relative;
      overflow: hidden;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--neon-green), var(--electric-blue), var(--neon-pink));
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .social-link.github:hover { background: var(--neon-green); color: var(--primary); }
    .social-link.email:hover { background: var(--electric-blue); }
    .social-link.htb:hover { background: var(--neon-orange); }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-content h1 { font-size: 2.8rem; }
      .section-title { font-size: 1.8rem; }
      .diagram { flex-direction: column; }
      .arrow::before { content: '↓'; }
      .input-group { flex-direction: column; }
      .input-group label { min-width: auto; }
    }
  </style>
</head>
<body>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <!-- Translator Button -->
  <button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="right: auto; left: 20px;">
    🌐 Hinglish On
  </button>

  <!-- Keyword Modal -->
  <div class="keyword-modal" id="keyword-modal">
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h3 class="modal-title" id="modal-title">Keyword</h3>
      <div class="modal-body" id="modal-body">Definition will appear here.</div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i> <span id="notification-text">Welcome to the Business Logic Vulnerabilities Masterclass!</span>
  </div>

  <!-- Three.js Background Canvas -->
  <canvas id="three-canvas"></canvas>

  <!-- Header / Hero -->
  <header id="home">
    <div class="container">
      <div class="hero-content"><!-- English Version -->
        <div class="en">
          <h1>Business Logic <span>Vulnerabilities</span></h1>
          <div class="subtitle">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</div>
          <p>A deep dive into flawed assumptions, unintended behavior, and real-world exploitation — with interactive demos and elite-level insights.</p>
        </div>

        <!-- Hinglish Version -->
        <div class="hi" style="display:none;">
          <h1>Business Logic <span>Vulnerabilities</span></h1>
          <div class="subtitle">Ankush Rana द्वारा | HTB Elite Hacker | Senior Security Engineer</div>
          <p>Flawed assumptions, unintended behavior, aur real-world exploitation mein gahrai se jaane — interactive demos aur elite-level insights ke saath.</p>
        </div>

        <!-- HTB & Bug Bounty Credibility -->
        <div style="margin-top: 40px; display: flex; align-items: center; gap: 25px; flex-wrap: wrap; justify-content: center; font-family: 'JetBrains Mono', monospace;">
          <img src="https://www.hackthebox.com/storage/achievements/elite_2024_badge.svg" alt="HTB Elite" style="width: 90px; filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
          <div style="text-align: center;">
            <img src="https://via.placeholder.com/100/0a1121/00ff88?text=AR" alt="Ankush Rana" style="width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--neon-green); filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
            <p style="margin: 5px 0 0; color: var(--neon-green);">52+ User Flags</p>
            <p style="margin: 0; color: var(--electric-blue);">15K+ Bug Bounty</p>
          </div>
          <div style="text-align: center;">
            <p style="color: var(--neon-orange);">🏆 Top 10 India</p>
            <p style="color: var(--neon-pink);">💼 Sattrix | GPSSI</p>
          </div>
        </div>

        <!-- Call to Action -->
        <div style="margin-top: 30px; font-family: 'Orbitron', sans-serif; color: var(--electric-blue);">
          <i class="fas fa-mouse-pointer"></i> Toggle Hinglish Mode → <strong>Top Right Corner</strong>
        <div style="display: flex; justify-content: center; margin-top: 10px;"><button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="position: relative; margin: 0 auto;">🌐 Hinglish On</button></div>
        </div>
      </div>
    </div>
  </header>

  <!-- Section: What is Business Logic? -->
  <section id="basics">
    <div class="container">
      <h2 class="section-title en">What is Business Logic?</h2>
      <h2 class="section-title hi" style="display:none;">Business Logic Kya Hai?</h2>
      
      <!-- Progress Tracker -->
      <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
        <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-green);">1</div>
          <div class="step-title en">Basic Concepts</div>
          <div class="step-title hi" style="display:none;">Mool Baat</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--electric-blue);">2</div>
          <div class="step-title en">Attack Vectors</div>
          <div class="step-title hi" style="display:none;">Hamlawar Ke Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-orange);">3</div>
          <div class="step-title en">Advanced Techniques</div>
          <div class="step-title hi" style="display:none;">Uchatam Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 0, 128, 0.1); border: 1px solid var(--neon-pink); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-pink);">4</div>
          <div class="step-title en">Prevention</div>
          <div class="step-title hi" style="display:none;">Bachav</div>
        </div>
      </div>

      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Understanding Business Logic</h3>
        <h3 class="hi" style="display:none;">Business Logic Ki Samajh</h3>
        <p class="en">Business logic is the set of rules that define how an application should behave. It's the "rulebook" that governs actions like purchases, logins, and data access.</p>
        <p class="hi" style="display:none;">Business logic niyamon ka set hai jo yeh nirdharit karta hai ki ek application ko kaise vyavhar karna chahiye. Yeh "niyam pustika" hai jo kharidari, logins aur data pravesh jaise karyon ko nirdharit karti hai.</p>
        <p class="en"><strong>Real Analogy:</strong> Like a vending machine: insert money → select item → get product. But if you manipulate the sequence — like inserting fake coins or pressing buttons in reverse — you might get free snacks.</p>
        <p class="hi" style="display:none;"><strong>Asli Udaharan:</strong> Ek vending machine ke jaise: paisa daalein → vastu chunen → utpad prapt karein. Lekin agar aap anukram ko chheddein — jaise nakli sikke daalna ya buttton ulte dabaana — toh aapko mufat snacks mil sakte hain.</p>
        <p class="en"><span class="keyword" data-title="Business Logic" data-content="The rules and workflows that define how an application should behave under normal conditions. When these are flawed, attackers can manipulate them.">Business Logic</span> is not just for businesses — it applies to any application with rules.</p>
        <p class="hi" style="display:none;"><span class="keyword" data-title="Business Logic" data-content="Niyamon aur karyapravahiyon ka set jo yeh nirdharit karta hai ki ek application ko saamaany avastha mein kaise vyavhar karna chahiye. Jab yeh kharaabi yukta hote hain, toh hamalavaron ke dwara unka faida uthaya ja sakta hai.">Business Logic</span> keval vyavasayon ke liye nahi hai — yeh kisi bhi application par lagu hota hai jo niyamon ke saath kaam karta hai.</p>
      </div>

      <!-- Business Logic Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">How Business Logic Works - Visualization</h3>
        <h3 class="hi" style="display:none;">Business Logic Kaise Kaam Karta Hai - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 180px;">
            <div class="en">User Request</div>
            <div class="hi" style="display:none;">Upyogkartri Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">POST /checkout</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 180px;">
            <div class="en">Business Logic Check</div>
            <div class="hi" style="display:none;">Vyavasayik Tark Jaanch</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Validation & Rules</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 180px;">
            <div class="en">Resource Access</div>
            <div class="hi" style="display:none;">Srotak Pravesh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Process Order</div>
          </div>
        </div>
        <p class="en">The application checks business rules before processing transactions. When these checks are missing or flawed, business logic vulnerabilities occur.</p>
        <p class="hi" style="display:none;">Application len-den ka prakriya karne se pahle vyavasayik niyamon ki jaanch karta hai. Jab yeh jaanchen gair-mojood ya kharaabi yukta hoti hain, toh vyavasayik tark kamjoriyan utpann hoti hain.</p>
      </div>

      <!-- Types of Business Logic Vulnerabilities -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Types of Business Logic Vulnerabilities</h3>
        <h3 class="hi" style="display:none;">Vyavasayik Tark Kamjoriyan Ke Prakar</h3>
        <ul style="margin: 15px 0 15px 30px;">
          <li class="en"><span class="keyword" data-title="Workflow Manipulation" data-content="Exploiting weaknesses in business processes to bypass steps or gain unauthorized access.">Workflow Manipulation</span>: Exploiting weaknesses in business processes</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Workflow Manipulation" data-content="Vyavasayik prakriyao mein kamzoriyon ka faida uthaakar charanon ko chhodna ya anadhikrit pravesh prapt karna.">Workflow Manipulation</span>: Vyavasayik prakriyao mein kamzoriyon ka faida uthaana</li>
          <li class="en"><span class="keyword" data-title="Data Validation Flaws" data-content="Failing to properly validate user input, leading to unexpected application behavior.">Data Validation Flaws</span>: Failing to properly validate user input</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Data Validation Flaws" data-content="Upyogkartri input ki proper roop se jaanch na kar paana, jisse anapekshit application vyavhar utpann hota hai.">Data Validation Flaws</span>: Upyogkartri input ki proper roop se jaanch na kar paana</li>
          <li class="en"><span class="keyword" data-title="Rate Limiting Bypass" data-content="Exploiting applications that don't properly limit repeated actions.">Rate Limiting Bypass</span>: Exploiting applications without proper rate limits</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Rate Limiting Bypass" data-content="Aise applications ka faida uthaana jo bar-bar karyon ko proper roop se seemit nahi karte.">Rate Limiting Bypass</span>: Aise applications ka faida uthaana jo bar-bar karyon ko proper roop se seemit nahi karte</li>
        </ul>
      </div>

      <!-- Statistics -->
      <div class="stats-container animate-on-scroll">
        <div class="stat-box">
          <div class="stat-number">80%</div>
          <div class="stat-label en">of logic flaws missed by scanners</div>
          <div class="stat-label hi" style="display:none;">scanner dwara chhute hue tark kharaabiyan</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">52+</div>
          <div class="stat-label en">User Flags on HackTheBox</div>
          <div class="stat-label hi" style="display:none;">HackTheBox par User Flags</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">$15K+</div>
          <div class="stat-label en">in bug bounty rewards</div>
          <div class="stat-label hi" style="display:none;">bug bounty mein inaam</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Price Manipulation -->
  <section id="try-price">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Price Manipulation</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Moolya Chhed</h2>
      
      <!-- Learning Path Progress -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Learning Path: Basic to Advanced</h3>
        <h3 class="hi" style="display:none;">Sikshna Marg: Mool Se Uchatam</h3>
        <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
          <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-green);">1</div>
            <div class="step-title en">Basic Price Manipulation</div>
            <div class="step-title hi" style="display:none;">Mool Moolya Chhed</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--electric-blue);">2</div>
            <div class="step-title en">Advanced Price Manipulation</div>
            <div class="step-title hi" style="display:none;">Uchatam Moolya Chhed</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-orange);">3</div>
            <div class="step-title en">Prevention Techniques</div>
            <div class="step-title hi" style="display:none;">Bachav Ke Tarika</div>
          </div>
        </div>
      </div>

      <!-- Basic Price Manipulation Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Level 1: Basic Price Manipulation</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Level 1: Mool Moolya Chhed</h3>
        <p class="en">Change the price parameter to buy an expensive item for a lower price.</p>
        <p class="hi" style="display:none;">Ek mehengi vastu ko kami moolya mein kharidne ke liye moolya parameter badlo.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="price-input" class="en">Item Price:</label>
            <label for="price-input" class="hi" style="display:none;">Vastu Moolya:</label>
            <input type="text" id="price-input" value="https://app.example.com/checkout?item=laptop&price=1200">
          </div>
          <button class="button" onclick="runPriceManipulation()">Manipulate Price</button>
          <div class="result-box" id="price-result">
// Try changing the price parameter to a lower value
          </div>
        </div>
      </div>

      <!-- Advanced Price Manipulation Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--electric-blue); margin-bottom: 15px;" class="en">Level 2: Advanced Price Manipulation</h3>
        <h3 style="color: var(--electric-blue); margin-bottom: 15px; display:none;" class="hi">Level 2: Uchatam Moolya Chhed</h3>
        <p class="en">Use advanced techniques like negative pricing, decimal manipulation, or currency switching.</p>
        <p class="hi" style="display:none;">Negative moolya, dashamlav chhed, ya mudra parivartan jaise uchatam tarikon ka upyog karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="advanced-price-input" class="en">Advanced Price Exploit:</label>
            <label for="advanced-price-input" class="hi" style="display:none;">Uchatam Moolya Doharpan:</label>
            <input type="text" id="advanced-price-input" value="POST /api/cart/add" style="font-family: 'JetBrains Mono', monospace;">
          </div>
          <div class="code-block">
// Example payloads:
// 1. Negative pricing: {"item": "laptop", "price": -100}
// 2. Decimal manipulation: {"item": "laptop", "price": 0.999999}
// 3. Currency switching: {"item": "laptop", "price_usd": 1200, "price_inr": 1}
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Workflow Bypass -->
  <section id="try-workflow">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Workflow Bypass</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Karyapravahi Chhed</h2>
      
      <!-- Workflow Bypass Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Workflow Bypass - Visualization</h3>
        <h3 class="hi" style="display:none;">Karyapravahi Chhed - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Normal Workflow</div>
            <div class="hi" style="display:none;">Saamaany Karyapravahi</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Cart → Payment → Order</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Bypass Techniques</div>
            <div class="hi" style="display:none;">Chhed Ke Tarika</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Skip Steps</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Unauthorized Access</div>
            <div class="hi" style="display:none;">Anadhikrit Pravesh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Free Products</div>
          </div>
        </div>
      </div>

      <!-- Workflow Bypass Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-orange); margin-bottom: 15px;" class="en">Exploit Workflow Vulnerabilities</h3>
        <h3 style="color: var(--neon-orange); margin-bottom: 15px; display:none;" class="hi">Karyapravahi Kamjoriyan Ka Faida Uthao</h3>
        <p class="en">Attempt to skip steps in a checkout process or manipulate state transitions.</p>
        <p class="hi" style="display:none;">Checkout prakriya mein charanon ko chhodne ya avastha parivartan ko chhedne ka prayas karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="workflow-input" class="en">Workflow URL:</label>
            <label for="workflow-input" class="hi" style="display:none;">Karyapravahi URL:</label>
            <input type="text" id="workflow-input" value="https://app.example.com/checkout/step2">
          </div>
          <button class="button" onclick="runWorkflowBypass()">Bypass Workflow</button>
          <div class="result-box" id="workflow-result">
// Try accessing step 3 without completing step 2
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Real-World Examples -->
  <section id="examples">
    <div class="container">
      <h2 class="section-title en">Real-World Logic Flaws</h2>
      <h2 class="section-title hi" style="display:none;">Vastavik Duniya Ke Udaharan</h2>
      
      <!-- Case Studies -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Case Study 1: E-Commerce Platform</h3>
        <h3 class="hi" style="display:none;">Prasthan Patra 1: E-Commerce Platform</h3>
        
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--neon-green);">Scenario:</h4>
          <p class="en">An e-commerce site allowed users to modify the quantity of items in their cart, including setting negative values.</p>
          <p class="hi" style="display:none;">Ek e-commerce site upyogkartiyon ko unke trolley mein vastuon ki matra badalne ki anumati de raha tha, jisme negative matra bhi shamil thi.</p>
          
          <h4 style="color: var(--electric-blue); margin-top: 15px;">Exploitation:</h4>
          <p class="en">By setting a negative quantity for one item and a positive quantity for another, users could effectively "sell" items to the store and receive refunds for items they never purchased.</p>
          <p class="hi" style="display:none;">Ek vastu ke liye negative matra aur doosri vastu ke liye positive matra set karke, upyogkartri dukaan ko vastu "bech" sakte the aur un vastuon ke liye refund prapt kar sakte the jo kabhi kharidi nahi thi.</p>
          
          <h4 style="color: var(--neon-orange); margin-top: 15px;">Impact:</h4>
          <p class="en">Financial loss for the company and potential account suspension for malicious users.</p>
          <p class="hi" style="display:none;">Kampani ke liye arthik hani aur dustopayogi upyogkartiyon ke liye khaate ka nirodh.</p>
        </div>
      </div>
      
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Case Study 2: Subscription Service</h3>
        <h3 class="hi" style="display:none;">Prasthan Patra 2: Subscription Seva</h3>
        
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--neon-green);">Scenario:</h4>
          <p class="en">A subscription service allowed users to downgrade their plan but failed to properly validate the downgrade request.</p>
          <p class="hi" style="display:none;">Ek subscription seva upyogkartiyon ko unke yojana ko kum karne ki anumati de rahi thi lekin kum karne ke anurodh ki proper roop se jaanch nahi kar rahi thi.</p>
          
          <h4 style="color: var(--electric-blue); margin-top: 15px;">Exploitation:</h4>
          <p class="en">Users could manipulate the downgrade request to switch to a cheaper plan while retaining features of their premium plan.</p>
          <p class="hi" style="display:none;">Upyogkartri apne anurodh ko chhedkar sasta yojana mein badal sakte the jabki unke premium yojana ke gunon ko banaaye rakhte.</p>
          
          <h4 style="color: var(--neon-orange); margin-top: 15px;">Impact:</h4>
          <p class="en">Revenue loss for the company and unfair advantage for malicious users.</p>
          <p class="hi" style="display:none;">Kampani ke liye aay ki hani aur dustopayogi upyogkartiyon ke liye anuchit labh.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Prevention -->
  <section id="prevention">
    <div class="container">
      <h2 class="section-title en">How to Prevent Logic Flaws</h2>
      <h2 class="section-title hi" style="display:none;">Tark Kharaabiyan Ko Kaise Rokein</h2>
      
      <!-- Prevention Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Logic Flaw Prevention - Visualization</h3>
        <h3 class="hi" style="display:none;">Tark Kharaabiyan Ka Bachav - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Malicious Request</div>
            <div class="hi" style="display:none;">Dushit Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Invalid Data</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Defense Layers</div>
            <div class="hi" style="display:none;">Bachav Perton</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Validation & Rules</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Blocked Request</div>
            <div class="hi" style="display:none;">Rukawat Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Access Denied</div>
          </div>
        </div>
      </div>

      <!-- Secure Coding Practices -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Secure Coding Practices</h3>
        <h3 class="hi" style="display:none;">Surakshit Coding Abhyas</h3>
        
        <!-- Proper Validation -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Implement Proper Validation</h4>
          <p class="en">Always validate user inputs on both client and server side, especially for critical operations.</p>
          <p class="hi" style="display:none;">Hamesha upyogkartri inputs ki jaanch karein dono client aur server side par, vishesh roop se mahatvapurna karyon ke liye.</p>
          <div class="code-block">
// Example: Validate price values
function validatePrice(price) {
  if (price < 0) {
    throw new Error("Price cannot be negative");
  }
  if (price > MAX_PRICE) {
    throw new Error("Price exceeds maximum allowed value");
  }
  return true;
}
          </div>
        </div>
        
        <!-- State Management -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Maintain Proper State Management</h4>
          <p class="en">Track user progress through workflows and enforce correct sequence of steps.</p>
          <p class="hi" style="display:none;">Upyogkartri ke karyapravahi ke maadhyam se pragati ko track karein aur charanon ke sahi anukram ko lagu karein.</p>
          <div class="code-block">
// Example: Check workflow state before proceeding
function canProceedToStep(currentStep, requestedStep) {
  const validTransitions = {
    'cart': ['payment'],
    'payment': ['confirmation'],
    'confirmation': ['completed']
  };
  
  return validTransitions[currentStep] && 
         validTransitions[currentStep].includes(requestedStep);
}
          </div>
        </div>
        
        <!-- Rate Limiting -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Implement Rate Limiting</h4>
          <p class="en">Prevent abuse by limiting the frequency of critical operations.</p>
          <p class="hi" style="display:none;">Mahatvapurna karyon ke aavriti ko seemit karke dustopayog ko rokein.</p>
          <div class="code-block">
// Example: Rate limiting implementation
const rateLimiter = {
  userRequests: new Map(),
  
  isAllowed(userId, maxRequests = 10, windowMs = 60000) {
    const now = Date.now();
    const userRequests = this.userRequests.get(userId) || [];
    
    // Remove old requests outside the window
    const recentRequests = userRequests.filter(time => now - time < windowMs);
    
    if (recentRequests.length >= maxRequests) {
      return false; // Rate limit exceeded
    }
    
    recentRequests.push(now);
    this.userRequests.set(userId, recentRequests);
    return true;
  }
};
          </div>
        </div>
      </div>

      <!-- Lab Environment Simulation -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Lab Environment Simulation</h3>
        <h3 class="hi" style="display:none;">Prayogshala Vatavaran Anukaran</h3>
        <p class="en">Set up a safe environment to test business logic prevention techniques without risking production systems.</p>
        <p class="hi" style="display:none;">Utpadan pranaliyon ko jokhim mein daale bina vyavasayik tark bachav tarikon ka parikshan karne ke liye surakshit vatanavaran sthapit karein.</p>
        
        <div class="interactive-demo animate-on-scroll">
          <h4 style="color: var(--neon-green);">Business Logic Prevention Testing</h4>
          <div class="demo-container">
            <div class="input-group">
              <label for="test-url" class="en">Test URL:</label>
              <label for="test-url" class="hi" style="display:none;">Parikshan URL:</label>
              <input type="text" id="test-url" value="https://app.example.com/checkout" placeholder="Enter URL to test">
            </div>
            <button class="button" onclick="testBusinessLogicProtection()" style="position: relative; z-index: 10;">Test Protection</button>
            <div class="result-box" id="protection-result">
// Results will appear here
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Quiz -->
  <section id="quiz">
    <div class="container">
      <h2 class="section-title en">Knowledge Check</h2>
      <h2 class="section-title hi" style="display:none;">Jaankari Check Karein</h2>
      <div class="quiz-container animate-on-scroll">
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px;" class="en">Test Your Understanding</h3>
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px; display:none;" class="hi">Apni Samajh Ko Test Karein</h3>
        <div id="quiz-questions">
          <!-- Questions will be injected here -->
        </div>
        <div class="score-display" id="score-display">Score: 0 / 10</div>
        <button class="button quiz-submit" onclick="submitQuiz()">Submit Quiz</button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <h3 class="en">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</h3>
      <h3 class="hi" style="display:none;">Ankush Rana Dwara | HTB Elite Hacker | Senior Security Engineer</h3>
      <p class="en">Breaking Systems. Building Defenses.</p>
      <p class="hi" style="display:none;">Systems todte hain. Defenses banate hain.</p>
      
      <div class="social-links">
        <a href="https://github.com/ankushrana6395" target="_blank" class="social-link github">
          <i class="fab fa-github"></i>
        </a>
        <a href="mailto:ankushrana6395@gmail.com" class="social-link email">
          <i class="fas fa-envelope"></i>
        </a>
        <a href="https://app.hackthebox.com/profile/117501" target="_blank" class="social-link htb">
          <i class="fas fa-cube"></i>
        </a>
      </div>
      
      <p style="margin-top: 30px;" class="en">&copy; 2025 Ankush Rana. All Rights Reserved.</p>
      <p style="margin-top: 30px; display:none;" class="hi">&copy; 2025 Ankush Rana. Sabhi Adhikar Sanchit Hai.</p>
    </div>
  </footer>

  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>
    let isHinglish = false;

    // Safe DOM access utility
    function getElement(id) {
      const element = document.getElementById(id);
      if (!element) {
        console.warn(`Element with ID '${id}' not found`);
      }
      return element;
    }

    function getElements(selector) {
      const elements = document.querySelectorAll(selector);
      if (!elements || elements.length === 0) {
        console.warn(`No elements found for selector '${selector}'`);
      }
      return elements;
    }

    // Card Interaction Functions (defined first to ensure they're available)
    function highlightCard(card) {
      card.classList.add('pop-out');
      const h3 = card.querySelector('h3');
      if (h3) {
        showNotification('Hovering: ' + h3.textContent);
      }
    }
    function unhighlightCard(card) {
      if (!card.classList.contains('focused')) {
        card.classList.remove('pop-out');
      }
    }
    function focusCard(card) {
      getElements('.lecture-card').forEach(c => {
        c.classList.remove('focused');
        c.classList.remove('pop-out');
      });
      card.classList.add('focused');
      card.classList.add('pop-out');
      const h3 = card.querySelector('h3');
      if (h3) {
        showNotification('Focused on: ' + h3.textContent);
      }
    }

    // Initialize Three.js - wrapped in a function to defer execution
    function initThreeJS() {
      const canvas = document.getElementById('three-canvas');
      if (!canvas) {
        console.warn('Three.js canvas not found, retrying...');
        setTimeout(initThreeJS, 100);
        return;
      }
      
      try {
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        // Grid
        const gridHelper = new THREE.GridHelper(100, 100, 0x00ff88, 0x003322);
        gridHelper.position.z = -20;
        scene.add(gridHelper);

        // Floating Points
        const geometry = new THREE.BufferGeometry();
        const count = 500;
        const positions = new Float32Array(count * 3);
        for (let i = 0; i < count * 3; i++) {
          positions[i] = (Math.random() - 0.5) * 100;
        }
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        const material = new THREE.PointsMaterial({ color: 0x00ff88, size: 0.5, transparent: true, opacity: 0.8 });
        const points = new THREE.Points(geometry, material);
        scene.add(points);

        // Add floating cubes
        const cubeGeometry = new THREE.BoxGeometry(2, 2, 2);
        const cubeMaterial = new THREE.MeshBasicMaterial({ 
          color: 0x00aaff, 
          wireframe: true,
          transparent: true,
          opacity: 0.5
        });
        const cubes = [];
        for (let i = 0; i < 10; i++) {
          const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
          cube.position.x = (Math.random() - 0.5) * 50;
          cube.position.y = (Math.random() - 0.5) * 50;
          cube.position.z = (Math.random() - 0.5) * 50;
          cube.rotation.x = Math.random() * Math.PI;
          cube.rotation.y = Math.random() * Math.PI;
          cubes.push({ mesh: cube, speed: Math.random() * 0.02 });
          scene.add(cube);
        }

        camera.position.z = 30;

        // Animation
        function animate() {
          requestAnimationFrame(animate);
          gridHelper.rotation.y += 0.005;
          points.rotation.y += 0.003;
          cubes.forEach(cube => {
            cube.mesh.rotation.x += cube.speed;
            cube.mesh.rotation.y += cube.speed;
          });
          renderer.render(scene, camera);
        }
        animate();

        // Store cleanup function for LectureViewer component
        window.cleanupThreeJS = function() {
          try {
            renderer.dispose();
            if (scene) {
              scene.children.forEach(child => {
                if (child.geometry) child.geometry.dispose();
                if (child.material) child.material.dispose();
              });
            }
          } catch (error) {
            console.warn('Error cleaning up Three.js:', error);
          }
        };
      } catch (error) {
        console.error('Error initializing Three.js:', error);
      }
    }

    // Start Three.js initialization with a small delay
    setTimeout(initThreeJS, 300);

    // Resize handler will be set up inside initThreeJS

    // Keyword Modal - Safe initialization
    const keywordModal = getElement('keyword-modal');
    const modalTitle = getElement('modal-title');
    const modalBody = getElement('modal-body');
    const modalClose = getElement('modal-close');
    
    if (keywordModal && modalTitle && modalBody && modalClose) {
      getElements('.keyword').forEach(keyword => {
        keyword.addEventListener('click', function(e) {
          e.stopPropagation();
          if (modalTitle) modalTitle.textContent = this.getAttribute('data-title');
          if (modalBody) modalBody.textContent = this.getAttribute('data-content');
          keywordModal.classList.add('active');
        });
      });
      
      modalClose.addEventListener('click', () => {
        keywordModal.classList.remove('active');
      });
      
      keywordModal.addEventListener('click', (e) => {
        if (e.target === keywordModal) {
          keywordModal.classList.remove('active');
        }
      });
    }

    // Language Toggle
    const translatorBtn = getElement('translator-btn');
    function toggleLanguage() {
      isHinglish = !isHinglish;
      const enElements = getElements('.en');
      const hiElements = getElements('.hi');
      enElements.forEach(el => el.style.display = isHinglish ? 'none' : 'block');
      hiElements.forEach(el => el.style.display = isHinglish ? 'block' : 'none');
      if (translatorBtn) {
        translatorBtn.textContent = isHinglish ? '🌐 English On' : '🌐 Hinglish On';
      }
      showNotification(isHinglish ? 'Hinglish mode activated!' : 'English mode activated!');
    }

    // Demo Functions - Safe DOM access
    function runPriceManipulation() {
      const inputElement = getElement('price-input');
      const resultElement = getElement('price-result');
      if (!inputElement || !resultElement) return;
      
      const input = inputElement.value;
      try {
        if (input.includes('price=1200')) {
          resultElement.innerHTML = isHinglish 
            ? `<span style="color: #00ff88">✅ Price Manipulation Successful!</span>
Modified URL: https://app.example.com/checkout?item=laptop&price=1
Savings: $1199
🛒 Item added to cart at discounted price!` 
            : `<span style="color: #00ff88">✅ Price Manipulation Successful!</span>
Modified URL: https://app.example.com/checkout?item=laptop&price=1
Savings: $1199
🛒 Item added to cart at discounted price!`;
          showNotification(isHinglish ? 'Moolya chhed pura!' : 'Price manipulation successful!');
        } else if (input.includes('price=1')) {
          resultElement.innerHTML = isHinglish 
            ? `<span style="color: #00ff88">✅ Exploitation Confirmed!</span>
You've successfully manipulated the price.
⚠️ This is a vulnerability that should be fixed.` 
            : `<span style="color: #00ff88">✅ Exploitation Confirmed!</span>
You've successfully manipulated the price.
⚠️ This is a vulnerability that should be fixed.`;
          showNotification(isHinglish ? 'Chhed pura!' : 'Exploitation confirmed!');
        } else {
          resultElement.innerHTML = isHinglish 
            ? `<span style="color: #ff8800">⚠️ Try modifying the price parameter</span>
Example: Change price=1200 to price=1` 
            : `<span style="color: #ff8800">⚠️ Try modifying the price parameter</span>
Example: Change price=1200 to price=1`;
        }
      } catch (e) {
        resultElement.innerHTML = isHinglish 
          ? `<span style="color: #ff8800">❌ Invalid input.</span>` 
          : `<span style="color: #ff8800">❌ Invalid input.</span>`;
      }
    }

    function runWorkflowBypass() {
      const inputElement = getElement('workflow-input');
      const resultElement = getElement('workflow-result');
      if (!inputElement || !resultElement) return;
      
      const input = inputElement.value;
      try {
        if (input.includes('step2')) {
          resultElement.innerHTML = isHinglish 
            ? `<span style="color: #00ff88">✅ Workflow Bypass Successful!</span>
Accessed: https://app.example.com/checkout/step3
Bypassed: Required step (step2 verification)
🔓 Unauthorized access to checkout process!` 
            : `<span style="color: #00ff88">✅ Workflow Bypass Successful!</span>
Accessed: https://app.example.com/checkout/step3
Bypassed: Required step (step2 verification)
🔓 Unauthorized access to checkout process!`;
          showNotification(isHinglish ? 'Karyapravahi chhed pura!' : 'Workflow bypass successful!');
        } else {
          resultElement.innerHTML = isHinglish 
            ? `<span style="color: #00ff88">✅ Access Granted!</span>
You've successfully bypassed the workflow.
⚠️ This is a vulnerability that should be fixed.` 
            : `<span style="color: #00ff88">✅ Access Granted!</span>
You've successfully bypassed the workflow.
⚠️ This is a vulnerability that should be fixed.`;
          showNotification(isHinglish ? 'Chhed pura!' : 'Bypass successful!');
        }
      } catch (e) {
        resultElement.innerHTML = isHinglish 
          ? `<span style="color: #ff8800">❌ Invalid input.</span>` 
          : `<span style="color: #ff8800">❌ Invalid input.</span>`;
      }
    }

    function testBusinessLogicProtection() {
      const inputElement = getElement('test-url');
      const resultElement = getElement('protection-result');
      if (!inputElement || !resultElement) return;
      
      const input = inputElement.value;
      try {
        resultElement.innerHTML = isHinglish 
          ? `<span style="color: #00ff88">✅ Protection Test Complete</span>
Tested URL: ${input}
Result: Proper validation and state management detected
🛡️ Business logic protection is properly implemented` 
          : `<span style="color: #00ff88">✅ Protection Test Complete</span>
Tested URL: ${input}
Result: Proper validation and state management detected
🛡️ Business logic protection is properly implemented`;
        showNotification(isHinglish ? 'Bachav parikshan pura!' : 'Protection test complete!');
      } catch (e) {
        resultElement.innerHTML = isHinglish 
          ? `<span style="color: #ff8800">❌ Test failed.</span>` 
          : `<span style="color: #ff8800">❌ Test failed.</span>`;
      }
    }

    // Quiz Questions (10 Questions)
    const quizQuestions = [
      {
        question: {
          en: "What is business logic in an application?",
          hi: "Ek application mein business logic kya hota hai?"
        },
        options: {
          en: [
            "The visual design of the application",
            "The rules that define how the application should behave",
            "The database structure",
            "The network configuration"
          ],
          hi: [
            "Application ka drishtikona abhikalpan",
            "Niyamon ka set jo yeh nirdharit karta hai ki application ko kaise vyavhar karna chahiye",
            "Database ka dhoorcha",
            "Network ka vinyas"
          ]
        },
        correct: 1,
        explanation: {
          en: "Business logic consists of the rules and workflows that define how an application should behave under normal conditions.",
          hi: "Business logic niyamon aur karyapravahiyon ka set hai jo yeh nirdharit karta hai ki ek application ko saamaany avastha mein kaise vyavhar karna chahiye."
        }
      },
      {
        question: {
          en: "Which of the following is a common business logic vulnerability?",
          hi: "Nimn mein se kaun ek aam business logic kamjori hai?"
        },
        options: {
          en: [
            "Cross-site scripting",
            "SQL injection",
            "Workflow manipulation",
            "Buffer overflow"
          ],
          hi: [
            "Cross-site scripting",
            "SQL injection",
            "Karyapravahi chhed",
            "Buffer overflow"
          ]
        },
        correct: 2,
        explanation: {
          en: "Workflow manipulation is a business logic vulnerability where attackers exploit weaknesses in business processes.",
          hi: "Karyapravahi chhed ek business logic kamjori hai jahan hamalavaron upyogkartiyon vyavasayik prakriyao mein kamzoriyon ka faida uthate hain."
        }
      },
      {
        question: {
          en: "What is the main cause of business logic vulnerabilities?",
          hi: "Business logic kamjoriyon ka mukhya karan kya hai?"
        },
        options: {
          en: [
            "Poor network security",
            "Flawed assumptions in application design",
            "Weak encryption algorithms",
            "Outdated software"
          ],
          hi: [
            "Kamzor network suraksha",
            "Application abhikalpan mein kharaabi yukta anum assumptions",
            "Kamzor encryption algorithms",
            "Purana software"
          ]
        },
        correct: 1,
        explanation: {
          en: "Business logic vulnerabilities primarily arise from flawed assumptions and improper validation in application design.",
          hi: "Business logic kamjoriyan mukhya roop se kharaabi yukta anum assumptions aur application abhikalpan mein apucchi jaanch se utpann hoti hain."
        }
      },
      {
        question: {
          en: "How can price manipulation occur in e-commerce applications?",
          hi: "E-commerce applications mein moolya chhed kaise ho sakta hai?"
        },
        options: {
          en: [
            "By changing the font size",
            "By modifying price parameters in requests",
            "By changing the website color scheme",
            "By updating the Terms of Service"
          ],
          hi: [
            "Font aakar badalke",
            "Anurodhon mein moolya parameters ko chhedke",
            "Website ka rang yojana badalke",
            "Seva ki Sharten apadet karke"
          ]
        },
        correct: 1,
        explanation: {
          en: "Price manipulation occurs when attackers modify price parameters in requests to purchase items at unauthorized prices.",
          hi: "Moolya chhed tab hota hai jab hamalavaron anurodhon mein moolya parameters ko chhedte hain taaki vastuon ko anadhikrit moolyon par kharidein."
        }
      },
      {
        question: {
          en: "What is a key prevention technique for business logic vulnerabilities?",
          hi: "Business logic kamjoriyon ke liye ek pramukh bachav tarika kya hai?"
        },
        options: {
          en: [
            "Using more colors in the UI",
            "Implementing proper input validation",
            "Increasing server bandwidth",
            "Adding more images to the site"
          ],
          hi: [
            "UI mein adhik rangon ka upyog",
            "Uchit input jaanch ka karyanvayan",
            "Server bandwidth badhana",
            "Site mein adhik chhaviyan jodna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Proper input validation is a key technique to prevent business logic vulnerabilities by ensuring that user inputs conform to expected formats and values.",
          hi: "Uchit input jaanch vyavasayik tark kamjoriyon ko rokne ka ek pramukh tarika hai jo yeh samanvayit karta hai ki upyogkartri inputs apekshit praroopon aur moolyon ke anuroop hai."
        }
      },
      {
        question: {
          en: "What is workflow manipulation in business logic attacks?",
          hi: "Vyavasayik tark hamalon mein karyapravahi chhed kya hota hai?"
        },
        options: {
          en: [
            "Changing the color scheme of the application",
            "Exploiting weaknesses in business processes to bypass steps",
            "Improving the user interface design",
            "Adding new features to the application"
          ],
          hi: [
            "Application ka rang yojana badalna",
            "Karyapravahiyon mein kamzoriyon ka faida uthaakar charanon ko chhodna",
            "Upyogkartri antarafal abhikalpan sudharana",
            "Application mein nayi suvidhaen jodna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Workflow manipulation involves exploiting weaknesses in business processes to bypass required steps or gain unauthorized access to functionality.",
          hi: "Karyapravahi chhed mein vyavasayik prakriyao mein kamzoriyon ka faida uthaakar aavashyak charanon ko chhodna ya karyakshamataon tak anadhikrit pravesh prapt karna shaamil hai."
        }
      },
      {
        question: {
          en: "Which of the following is an example of business logic attack?",
          hi: "Nimn mein se kaun vyavasayik tark hamala ka ek udaharan hai?"
        },
        options: {
          en: [
            "Sending too many requests to a server",
            "Changing the price of an item in a shopping cart to $0",
            "Using a strong password",
            "Updating software regularly"
          ],
          hi: [
            "Server ko atyadhik anurodh bhejna",
            "Khareedari trolley mein vastu ka moolya $0 kar dena",
            "Ek majaboot kootankh upyog karna",
            "Software ko niyamit roop se apadet karna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Changing the price of an item to $0 is a business logic attack because it exploits flawed assumptions in how the application processes pricing information.",
          hi: "Vastu ka moolya $0 kar dena ek vyavasayik tark hamala hai kyunki yeh application dwara moolya jaankari sansadhit karne ke tareeke mein kharaabi yukta anum assumptions ka faida uthata hai."
        }
      },
      {
        question: {
          en: "What is the purpose of rate limiting in preventing business logic attacks?",
          hi: "Vyavasayik tark hamalon ko rokne mein dar ki seemit karne ka uddeshya kya hai?"
        },
        options: {
          en: [
            "To improve the visual appearance of the application",
            "To prevent abuse by limiting the frequency of critical operations",
            "To increase the speed of the application",
            "To reduce the size of the application"
          ],
          hi: [
            "Application ka drishtikona abhikalpan sudharane ke liye",
            "Mahatvapurna karyon ke aavriti ko seemit karke dustopayog ko rokne ke liye",
            "Application ki gati badhane ke liye",
            "Application ka aakar kam karne ke liye"
          ]
        },
        correct: 1,
        explanation: {
          en: "Rate limiting prevents abuse by restricting how often users can perform critical operations, helping to protect against business logic attacks.",
          hi: "Dar ki seemit karke upyogkartiyon dwara mahatvapurna karyon ko kitni baar nirvahit kiya ja sakta hai, is par pratibandan lagakar vyavasayik tark hamalon ke khilaf suraksha pradan karne mein madad milati hai."
        }
      },
      {
        question: {
          en: "Why are business logic vulnerabilities difficult to detect with automated scanners?",
          hi: "Svachalit scanneron ke saath vyavasayik tark kamjoriyan kyon pata lagana mushkil hai?"
        },
        options: {
          en: [
            "They are always hidden in images",
            "They involve complex business rules that require human understanding",
            "They only occur on weekends",
            "They are too small to be detected"
          ],
          hi: [
            "Ve hamesha chhaviyon mein chhipe rahate hain",
            "Ve jatil vyavasayik niyamon ko shaamil karte hain jo manav samajh ki aavashyakta hai",
            "Ve kewal sakartavar ko hoti hain",
            "Ve pata karne ke liye bahut chhote hote hain"
          ]
        },
        correct: 1,
        explanation: {
          en: "Business logic vulnerabilities are difficult for automated scanners to detect because they involve complex business rules and workflows that require human understanding and context.",
          hi: "Vyavasayik tark kamjoriyan svachalit scanneron ke liye pata karna mushkil hai kyunki ve jatil vyavasayik niyamon aur karyapravahiyon ko shaamil karte hain jo manav samajh aur sandarbh ki aavashyakta hai."
        }
      }
    ];

    // Render Quiz - Safe DOM access
    function renderQuiz() {
      const quizContainer = getElement('quiz-questions');
      if (!quizContainer) return;
      
      quizContainer.innerHTML = '';
      quizQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'quiz-question';
        const qText = isHinglish ? q.question.hi : q.question.en;
        const opts = isHinglish ? q.options.hi : q.options.en;
        questionDiv.innerHTML = `
          <h4>Q${index + 1}: ${qText}</h4>
          <div class="options" id="options-${index}">
            ${opts.map((opt, i) => `
              <div class="option" onclick="selectOption(${index}, ${i})">${opt}</div>
            `).join('')}
          </div>
        `;
        quizContainer.appendChild(questionDiv);
      });
    }

    // Track selected answers
    const selectedAnswers = new Array(quizQuestions.length).fill(-1);

    // Select Option
    window.selectOption = function(questionIndex, optionIndex) {
      const options = getElements(`#options-${questionIndex} .option`);
      if (!options || options.length === 0) return;
      
      options.forEach(opt => {
        opt.classList.remove('selected');
      });
      options[optionIndex].classList.add('selected');
      selectedAnswers[questionIndex] = optionIndex;
    };

    // Submit Quiz
    window.submitQuiz = function() {
      let score = 0;
      const feedback = getElement('feedback');
      if (!feedback) return;
      
      feedback.innerHTML = '';
      feedback.style.display = 'block';

      quizQuestions.forEach((q, index) => {
        const options = getElements(`#options-${index} .option`);
        const explanation = isHinglish ? q.explanation.hi : q.explanation.en;

        if (selectedAnswers[index] === q.correct) {
          score++;
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1) options[selectedAnswers[index]].classList.add('correct');
        } else {
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1 && selectedAnswers[index] !== q.correct) {
            options[selectedAnswers[index]].classList.add('incorrect');
          }
        }

        feedback.innerHTML += `<strong>Q${index + 1}:</strong> ${explanation}<br><br>`;
      });

      const scoreDisplay = getElement('score-display');
      if (scoreDisplay) {
        scoreDisplay.textContent = `Score: ${score} / ${quizQuestions.length}`;
      }
      showNotification(isHinglish ? `Quiz pura! Score: ${score}/${quizQuestions.length}` : `Quiz complete! You scored ${score}/${quizQuestions.length}`);
    };

    // Notification - Safe DOM access
    function showNotification(message) {
      const notification = getElement('notification');
      const notificationText = getElement('notification-text');
      if (!notification || !notificationText) return;
      
      notificationText.textContent = message;
      notification.classList.add('show');
      setTimeout(() => notification.classList.remove('show'), 3000);
    }

    // Scroll Progress Bar - Safe DOM access
    window.addEventListener('scroll', () => {
      const progressBar = getElement('progress-bar');
      if (!progressBar) return;
      
      const winHeight = window.innerHeight;
      const docHeight = document.documentElement.scrollHeight;
      const scrollTop = window.pageYOffset;
      const trackLength = docHeight - winHeight;
      const progress = scrollTop / trackLength * 100;
      progressBar.style.width = progress + '%';
    });

    // Animation on Scroll - Safe DOM access
    document.addEventListener('DOMContentLoaded', () => {
      const animateElements = getElements('.animate-on-scroll');
      if (animateElements.length > 0) {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) entry.target.classList.add('visible');
          });
        }, { threshold: 0.1 });
        animateElements.forEach(el => observer.observe(el));
      }
      
      renderQuiz();
    });
  </script>
</body>
</html>
