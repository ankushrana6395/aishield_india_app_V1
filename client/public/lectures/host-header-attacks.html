<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Interactive Host Header Attacks Masterclass with Live Hinglish Translation | Quiz | Try It Yourself | By HTB Elite Hacker">
  <title>Host Header Attacks | By Ankush Rana</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;600;700;900&family=Roboto:wght@300;400;500;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --primary: #0a1121;
      --dark-navy: #0b1b30;
      --neon-green: #00ff88;
      --electric-blue: #00aaff;
      --neon-orange: #ff8800;
      --neon-pink: #ff0080;
      --glow-green: rgba(0, 255, 136, 0.3);
      --glow-blue: rgba(0, 170, 255, 0.2);
      --glow-pink: rgba(255, 0, 128, 0.3);
      --light-gray: #e0e0e0;
      --mid-gray: #aaaaaa;
      --card-bg: #111c30;
      --border: #2a4060;
      --keyword: #ffdd57;
      --keyword-bg: rgba(255, 221, 87, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--primary);
      color: var(--light-gray);
      line-height: 1.7;
      overflow-x: hidden;
    }

    /* Three.js Background */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Translator Button */
    .translator-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 0 15px var(--glow-green);
      transition: all 0.3s ease;
    }

    .translator-btn:hover {
      transform: translateY(-2px);
      background: #00cc6d;
    }

    /* Header / Hero */
    header {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-content {
      z-index: 2;
      max-width: 900px;
      position: relative;
    }

    .hero-content h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2.8rem, 8vw, 4rem);
      color: white;
      margin-bottom: 10px;
      text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
      50% { text-shadow: 0 0 25px rgba(0, 255, 136, 0.9), 0 0 35px rgba(0, 255, 136, 0.5); }
      100% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
    }

    .hero-content h1 span {
      color: var(--neon-green);
    }

    .subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: clamp(1.2rem, 3.5vw, 1.5rem);
      color: var(--electric-blue);
      margin: 15px 0;
    }

    /* Section Styling */
    section {
      padding: 100px 0;
      position: relative;
    }

    .section-title {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2rem, 5vw, 2.5rem);
      color: var(--neon-green);
      margin-bottom: 50px;
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -8px;
      width: 70px;
      height: 4px;
      background: var(--electric-blue);
      animation: expand 2s infinite;
    }

    @keyframes expand {
      0% { width: 70px; }
      50% { width: 100px; }
      100% { width: 70px; }
    }

    /* Lecture Card */
    .lecture-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .lecture-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 136, 0.05), transparent);
      z-index: 0;
    }

    .lecture-card.pop-out {
      transform: translateY(-20px) scale(1.05);
      box-shadow: 
        0 30px 60px rgba(0, 0, 0, 0.5),
        0 0 50px var(--glow-green);
      border-color: var(--neon-green);
      z-index: 5;
    }

    .lecture-card.focused {
      transform: translateY(-20px) scale(1.06);
      box-shadow: 
        0 40px 80px rgba(0, 0, 0, 0.6),
        0 0 70px var(--glow-green);
      filter: brightness(1.1);
    }

    .lecture-card h3 {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 18px;
      font-size: 1.8rem;
      position: relative;
      z-index: 2;
    }

    /* Keyword Style */
    .keyword {
      background: var(--keyword-bg);
      color: var(--keyword);
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 1px dashed var(--keyword);
      position: relative;
      transition: all 0.3s ease;
      z-index: 2;
    }

    .keyword:hover {
      background: rgba(255, 221, 87, 0.3);
      box-shadow: 0 0 12px rgba(255, 221, 87, 0.4);
    }

    /* Tooltip (Modal) */
    .keyword-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 17, 33, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .keyword-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border: 2px solid var(--neon-green);
      border-radius: 14px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 50px var(--glow-green);
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .keyword-modal.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--neon-green);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-title {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .modal-body {
      color: var(--light-gray);
      line-height: 1.6;
    }

    /* Interactive Demo */
    .interactive-demo {
      background: rgba(0, 20, 40, 0.6);
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      border: 1px solid var(--electric-blue);
    }

    .demo-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .input-group label {
      min-width: 120px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--neon-green);
    }

    .input-group input {
      flex: 1;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: white;
      font-family: 'JetBrains Mono', monospace;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--neon-green);
      box-shadow: 0 0 10px var(--glow-green);
    }

    .button {
      padding: 12px 24px;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 4px;
      font-family: 'Orbitron', sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: fit-content;
    }

    .button:hover {
      background: #00cc6d;
      box-shadow: 0 0 15px var(--glow-green);
      transform: translateY(-2px);
    }

    .result-box {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 6px;
      padding: 15px;
      margin-top: 15px;
      border-left: 3px solid var(--neon-green);
      font-family: 'JetBrains Mono', monospace;
      min-height: 100px;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    /* Diagram */
    .diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }

    .box {
      min-width: 140px;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      font-weight: bold;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }

    .box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
    }

    .box:hover::before {
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }

    .user-input { background: #8b0000; color: white; }
    .app { background: #003366; color: white; }
    .db { background: #004d00; color: #00ff88; }

    .arrow {
      font-size: 1.8rem;
      color: var(--neon-green);
      position: relative;
    }

    .arrow::before {
      content: '→';
      animation: arrow-pulse 1.5s infinite;
    }

    @keyframes arrow-pulse {
      0% { text-shadow: 0 0 5px var(--neon-green); }
      50% { text-shadow: 0 0 15px var(--neon-green); }
      100% { text-shadow: 0 0 5px var(--neon-green); }
    }

    /* Code Block */
    .code-block {
      background: #001a1a;
      color: #00ff88;
      font-family: 'JetBrains Mono', monospace;
      padding: 15px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 15px 0;
      border-left: 4px solid var(--neon-green);
      position: relative;
    }

    .code-block::before {
      content: 'CODE';
      position: absolute;
      top: 0;
      right: 0;
      background: var(--neon-green);
      color: var(--primary);
      font-size: 0.7rem;
      padding: 2px 8px;
      border-bottom-left-radius: 4px;
      font-weight: bold;
    }

    /* Statistics Section */
    .stats-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin: 30px 0;
    }

    .stat-box {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
      min-width: 200px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      border-color: var(--neon-green);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .stat-label {
      color: var(--mid-gray);
      font-size: 0.9rem;
    }

    /* Quiz Section */
    .quiz-container {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .quiz-question {
      margin-bottom: 20px;
    }

    .quiz-question h4 {
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      background: rgba(0, 255, 136, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
    }

    .option.selected {
      background: var(--neon-green);
      color: var(--primary);
      font-weight: bold;
    }

    .score-display {
      text-align: center;
      font-size: 1.5rem;
      margin: 20px 0;
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
    }

    .button.quiz-submit {
      background: var(--neon-orange);
      color: white;
    }

    .button.quiz-submit:hover {
      background: #cc7000;
    }

    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: transparent;
      z-index: 1000;
    }

    .progress-bar {
      height: 100%;
      background: var(--neon-green);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Notification */
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--neon-green);
      border-radius: 8px;
      padding: 15px;
      color: var(--light-gray);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 60px 0;
      background: var(--dark-navy);
      color: var(--mid-gray);
      position: relative;
      overflow: hidden;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--neon-green), var(--electric-blue), var(--neon-pink));
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .social-link.github:hover { background: var(--neon-green); color: var(--primary); }
    .social-link.email:hover { background: var(--electric-blue); }
    .social-link.htb:hover { background: var(--neon-orange); }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-content h1 { font-size: 2.8rem; }
      .section-title { font-size: 1.8rem; }
      .diagram { flex-direction: column; }
      .arrow::before { content: '↓'; }
      .input-group { flex-direction: column; }
      .input-group label { min-width: auto; }
    }
  </style>
</head>
<body>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <!-- Translator Button -->
  <button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="right: auto; left: 20px;">
    🌐 Hinglish On
  </button>

  <!-- Keyword Modal -->
  <div class="keyword-modal" id="keyword-modal">
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h3 class="modal-title" id="modal-title">Keyword</h3>
      <div class="modal-body" id="modal-body">Definition will appear here.</div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i> <span id="notification-text">Welcome to the Host Header Attacks Masterclass!</span>
  </div>

  <!-- Three.js Background Canvas -->
  <canvas id="three-canvas"></canvas>

  <!-- Header / Hero -->
  <header id="home">
    <div class="container">
      <div class="hero-content"><!-- English Version -->
        <div class="en">
          <h1>Host Header <span>Attacks</span></h1>
          <div class="subtitle">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</div>
          <p>A deep dive into web cache poisoning, password reset poisoning, and real-world exploitation — with interactive demos and elite-level insights.</p>
        </div>

        <!-- Hinglish Version -->
        <div class="hi" style="display:none;">
          <h1>Host Header <span>Attacks</span></h1>
          <div class="subtitle">Ankush Rana द्वारा | HTB Elite Hacker | Senior Security Engineer</div>
          <p>Web cache poisoning, password reset poisoning, aur real-world exploitation mein gahrai se jaane — interactive demos aur elite-level samajh ke saath.</p>
        </div>

        <!-- HTB & Bug Bounty Credibility -->
        <div style="margin-top: 40px; display: flex; align-items: center; gap: 25px; flex-wrap: wrap; justify-content: center; font-family: 'JetBrains Mono', monospace;">
          <img src="https://www.hackthebox.com/storage/achievements/elite_2024_badge.svg" alt="HTB Elite" style="width: 90px; filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
          <div style="text-align: center;">
            <img src="https://via.placeholder.com/100/0a1121/00ff88?text=AR" alt="Ankush Rana" style="width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--neon-green); filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
            <p style="margin: 5px 0 0; color: var(--neon-green);">52+ User Flags</p>
            <p style="margin: 0; color: var(--electric-blue);">47+ Root Owned</p>
          </div>
          <div style="text-align: center;">
            <p style="color: var(--neon-orange);">🏆 Top 10 India</p>
            <p style="color: var(--neon-pink);">💼 Sattrix | GPSSI</p>
          </div>
        </div>

        <!-- Call to Action -->
        <div style="margin-top: 30px; font-family: 'Orbitron', sans-serif; color: var(--electric-blue);">
          <i class="fas fa-mouse-pointer"></i> Toggle Hinglish Mode → <strong>Top Right Corner</strong>
        <div style="display: flex; justify-content: center; margin-top: 10px;"><button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="position: relative; margin: 0 auto;">🌐 Hinglish On</button></div>
        </div>
      </div>
    </div>
  </header>

  <!-- Section: What is Host Header Attack? -->
  <section id="basics">
    <div class="container">
      <h2 class="section-title en">What is Host Header Attack?</h2>
      <h2 class="section-title hi" style="display:none;">Host Header Attack Kya Hai?</h2>
      
      <!-- Progress Tracker -->
      <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
        <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-green);">1</div>
          <div class="step-title en">Basic Concepts</div>
          <div class="step-title hi" style="display:none;">Mool Baat</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--electric-blue);">2</div>
          <div class="step-title en">Attack Vectors</div>
          <div class="step-title hi" style="display:none;">Hamlawar Ke Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-orange);">3</div>
          <div class="step-title en">Advanced Techniques</div>
          <div class="step-title hi" style="display:none;">Uchatam Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 0, 128, 0.1); border: 1px solid var(--neon-pink); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-pink);">4</div>
          <div class="step-title en">Prevention</div>
          <div class="step-title hi" style="display:none;">Bachav</div>
        </div>
      </div>

      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Understanding Host Header</h3>
        <h3 class="hi" style="display:none;">Host Header Ki Samajh</h3>
        <p class="en">Host Header Attacks occur when an attacker manipulates the Host header in an HTTP request to trick the server into behaving unexpectedly. This can lead to web cache poisoning, password reset poisoning, and other serious vulnerabilities.</p>
        <p class="hi" style="display:none;">Host Header Attacks tab hota hai jab hamlawar HTTP anurodh mein Host header ko chhedchhad kar server ko anpratyashit roop se vyavahar karne ke liye majboor karta hai. Isse web cache poisoning, password reset poisoning aur anye gambhir kamjoriyan ho sakti hain.</p>
        <p class="en"><strong>Real Analogy:</strong> Like sending a letter to the wrong address but still getting it delivered because the postal system trusts the address on the envelope.</p>
        <p class="hi" style="display:none;"><strong>Asli Example:</strong> Galat pata pe patra bhejna lekin phir bhi use pauna kyunki dak pranali envelope par pata par vishwas karti hai.</p>
        <p class="en">If exploited, Host Header Attacks can lead to cache poisoning, session hijacking, and bypassing security controls.</p>
        <p class="hi" style="display:none;">Agar exploit kiya jaye, toh Host Header Attacks cache poisoning, session hijacking aur suraksha niyantran ko bypass karne ke liye upyog kiya ja sakta hai.</p>
        <p class="en"><span class="keyword" data-title="Host Header" data-content="An HTTP header that specifies the host (domain name or IP address) of the server being requested.">Host Header</span> is critical because it determines how the server processes the request.</p>
        <p class="hi" style="display:none;"><span class="keyword" data-title="Host Header" data-content="Ek HTTP header jo anurodh kiye ja rahe server ka host (domain naam ya IP pata) nirdharit karta hai.">Host Header</span> mahatvapurn hai kyunki yeh server dwara anurodh ko sansadhit karne ka tareeka nirdharit karta hai.</p>
      </div>

      <!-- Host Header Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">How Host Header Works - Visualization</h3>
        <h3 class="hi" style="display:none;">Host Header Kaise Kaam Karta Hai - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 180px;">
            <div class="en">Attacker Input</div>
            <div class="hi" style="display:none;">Hamlawar Input</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Host: evil.com</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 180px;">
            <div class="en">Vulnerable App</div>
            <div class="hi" style="display:none;">Kamzor App</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Trusts Host Header</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 180px;">
            <div class="en">Internal Services</div>
            <div class="hi" style="display:none;">Aantarik Sevaon</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Cache/Email Systems</div>
          </div>
        </div>
        <p class="en">The vulnerable application trusts the Host header and uses it to generate URLs for redirects, password reset emails, or cache keys.</p>
        <p class="hi" style="display:none;">Kamzor application Host header par vishwas karta hai aur ise redirect, password reset emails ya cache keys ke liye URLs utpann karne ke liye upyog karta hai.</p>
      </div>

      <!-- Host Header Structure Explanation -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Host Header Structure</h3>
        <h3 class="hi" style="display:none;">Host Header Ki Rachna</h3>
        <div class="code-block">
GET / HTTP/1.1
Host: <span style="color: #00aaff;">target.com</span>:<span style="color: #ff0080;">80</span>
User-Agent: Mozilla/5.0
Accept: */*
        </div>
        <ul style="margin: 15px 0 15px 30px;">
          <li class="en"><span class="keyword" data-title="Host" data-content="The domain name or IP address of the server.">Host</span>: The target server's domain name or IP address</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Host" data-content="Server ka domain naam ya IP pata.">Host</span>: Lakshya server ka domain naam ya IP pata</li>
          <li class="en"><span class="keyword" data-title="Port" data-content="Optional port number (default is 80 for HTTP, 443 for HTTPS).">Port</span>: Optional port number (default is 80 for HTTP, 443 for HTTPS)</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Port" data-content="Vikalpik port sankhya (HTTP ke liye 80, HTTPS ke liye 443).">Port</span>: Vikalpik port sankhya (HTTP ke liye 80, HTTPS ke liye 443)</li>
        </ul>
      </div>

      <!-- Statistics -->
      <div class="stats-container animate-on-scroll">
        <div class="stat-box">
          <div class="stat-number en">High</div>
          <div class="stat-number hi" style="display:none;">Uchch</div>
          <div class="stat-label en">severity rating</div>
          <div class="stat-label hi" style="display:none;">khatre ka level</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">35+</div>
          <div class="stat-label en">User Flags on HackTheBox</div>
          <div class="stat-label hi" style="display:none;">HackTheBox par User Flags</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">$15K+</div>
          <div class="stat-label en">in bug bounty rewards</div>
          <div class="stat-label hi" style="display:none;">bug bounty mein kamai</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Password Reset Poisoning -->
  <section id="try-password">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Password Reset Poisoning</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Password Reset Poisoning</h2>
      
      <!-- Learning Path Progress -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Learning Path: Basic to Advanced</h3>
        <h3 class="hi" style="display:none;">Sikshna Marg: Mool Se Uchatam</h3>
        <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
          <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-green);">1</div>
            <div class="step-title en">Basic Password Reset</div>
            <div class="step-title hi" style="display:none;">Mool Password Reset</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--electric-blue);">2</div>
            <div class="step-title en">Poisoning Attack</div>
            <div class="step-title hi" style="display:none;">Poisoning Hamlawar</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-orange);">3</div>
            <div class="step-title en">Advanced Exploitation</div>
            <div class="step-title hi" style="display:none;">Uchatam Doharpan</div>
          </div>
        </div>
      </div>

      <!-- Basic Password Reset Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Level 1: Basic Password Reset</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Level 1: Mool Password Reset</h3>
        <p class="en">Observe how a normal password reset request works.</p>
        <p class="hi" style="display:none;">Dekhein ki ek sadharan password reset anurodh kaise kaam karta hai.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="email-input" class="en">Email:</label>
            <label for="email-input" class="hi" style="display:none;">Email:</label>
            <input type="text" id="email-input" value="user@example.com">
          </div>
          <button class="button" onclick="requestPasswordReset()">Request Reset</button>
          <div class="result-box" id="password-reset-result">
// Normal password reset request
          </div>
        </div>
      </div>

      <!-- Password Reset Poisoning Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--electric-blue); margin-bottom: 15px;" class="en">Level 2: Password Reset Poisoning</h3>
        <h3 style="color: var(--electric-blue); margin-bottom: 15px; display:none;" class="hi">Level 2: Password Reset Poisoning</h3>
        <p class="en">Manipulate the Host header to redirect the password reset link to your server.</p>
        <p class="hi" style="display:none;">Password reset link ko apne server pe redirect karne ke liye Host header ko chhedchhad karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="poison-host" class="en">Host Header:</label>
            <label for="poison-host" class="hi" style="display:none;">Host Header:</label>
            <input type="text" id="poison-host" value="evil.com" style="font-family: 'JetBrains Mono', monospace;">
          </div>
          <div class="input-group">
            <label for="victim-email" class="en">Victim Email:</label>
            <label for="victim-email" class="hi" style="display:none;">Shikar Email:</label>
            <input type="text" id="victim-email" value="victim@example.com">
          </div>
          <button class="button" onclick="poisonPasswordReset()">Poison Request</button>
          <div class="result-box" id="poison-reset-result">
// Poisoned password reset request
          </div>
        </div>
      </div>

      <!-- Advanced Exploitation Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-orange); margin-bottom: 15px;" class="en">Level 3: Advanced Exploitation</h3>
        <h3 style="color: var(--neon-orange); margin-bottom: 15px; display:none;" class="hi">Level 3: Uchatam Doharpan</h3>
        <p class="en">Use password reset poisoning to capture session tokens or perform account takeover.</p>
        <p class="hi" style="display:none;">Session tokens capture karne ya account takeover karne ke liye password reset poisoning ka upyog karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="advanced-host" class="en">Host Header:</label>
            <label for="advanced-host" class="hi" style="display:none;">Host Header:</label>
            <input type="text" id="advanced-host" value="attacker-server.com" style="font-family: 'JetBrains Mono', monospace;">
          </div>
          <div class="code-block">
// Advanced exploitation techniques:
// 1. Capture reset tokens
// 2. Perform account takeover
// 3. Access sensitive user data
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Bypass Techniques -->
  <section id="bypass">
    <div class="container">
      <h2 class="section-title en">Bypassing Host Header Defenses</h2>
      <h2 class="section-title hi" style="display:none;">Host Header Defenses Ko Kaise Bypass Karein</h2>
      
      <!-- Attack Vector Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Host Header Attack Vectors - Visualization</h3>
        <h3 class="hi" style="display:none;">Host Header Hamlawar Ke Tarika - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Blocked Hosts</div>
            <div class="hi" style="display:none;">Rukawat Hosts</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">target.com, localhost</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Defense Mechanism</div>
            <div class="hi" style="display:none;">Bachav Yantra</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Filter/Block</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Bypass Techniques</div>
            <div class="hi" style="display:none;">Bypass Tarika</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">X-Forwarded-Host, Duplicate Headers</div>
          </div>
        </div>
      </div>

      <!-- Bypass Techniques with Examples -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Advanced Bypass Techniques</h3>
        <h3 class="hi" style="display:none;">Uchatam Bypass Tarika</h3>
        
        <!-- X-Forwarded-Host Technique -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. X-Forwarded-Host Bypass</h4>
          <p class="en">When direct Host header manipulation is blocked, use X-Forwarded-Host header instead.</p>
          <p class="hi" style="display:none;">Jab seedha Host header chhedchhad rukawat ho jata hai, toh X-Forwarded-Host header ka upyog karein.</p>
          <div class="code-block">
Example Request:
GET /reset-password HTTP/1.1
Host: target.com
X-Forwarded-Host: evil.com
          </div>
        </div>
        
        <!-- Duplicate Headers Technique -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Duplicate Headers Bypass</h4>
          <p class="en">Send multiple Host headers to confuse the server's parsing logic.</p>
          <p class="hi" style="display:none;">Server ki parsing logic ko bhramit karne ke liye ekadhik Host headers bhejein.</p>
          <div class="code-block">
Example Request:
GET /reset-password HTTP/1.1
Host: target.com
Host: evil.com
          </div>
        </div>
        
        <!-- Absolute URL Technique -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Absolute URL Bypass</h4>
          <p class="en">Use absolute URLs in the request line to override the Host header.</p>
          <p class="hi" style="display:none;">Host header ko override karne ke liye anurodh pankti mein poorna URLs ka upyog karein.</p>
          <div class="code-block">
Example Request:
GET http://evil.com/reset-password HTTP/1.1
Host: target.com
          </div>
        </div>
        
        <!-- Port Manipulation Technique -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. Port Manipulation Bypass</h4>
          <p class="en">Add port numbers to the Host header to bypass validation checks.</p>
          <p class="hi" style="display:none;">Manyaatam jaanch ko bypass karne ke liye Host header mein port sankhya jodein.</p>
          <div class="code-block">
Example Request:
GET /reset-password HTTP/1.1
Host: target.com:80@evil.com
          </div>
        </div>
      </div>

      <!-- Real-World Case Studies -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Real-World Case Studies</h3>
        <h3 class="hi" style="display:none;">Vastavik Duniya Ke Udaharan</h3>
        
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--neon-green);">Case Study 1: E-commerce Platform Vulnerability</h4>
          <p class="en"><strong>Scenario:</strong> An e-commerce platform used the Host header to generate password reset links.</p>
          <p class="hi" style="display:none;"><strong>Paristhiti:</strong> Ek e-commerce platform password reset links utpann karne ke liye Host header ka upyog karta tha.</p>
          <p class="en"><strong>Exploitation:</strong> Used X-Forwarded-Host header to redirect reset links to attacker's server.</p>
          <p class="hi" style="display:none;"><strong>Doharpan:</strong> Reset links ko hamlawar ke server pe redirect karne ke liye X-Forwarded-Host header ka upyog kiya gaya.</p>
          <p class="en"><strong>Impact:</strong> Account takeover of multiple users leading to financial loss.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Ekadhik upyogkartaon ka account takeover jo arthik hani ka karan bana.</p>
        </div>
        
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--electric-blue);">Case Study 2: Social Media Platform</h4>
          <p class="en"><strong>Scenario:</strong> A social media platform used Host header for generating shareable links.</p>
          <p class="hi" style="display:none;"><strong>Paristhiti:</strong> Ek social media platform shareable links utpann karne ke liye Host header ka upyog karta tha.</p>
          <p class="en"><strong>Exploitation:</strong> Used duplicate Host headers to poison the web cache with malicious links.</p>
          <p class="hi" style="display:none;"><strong>Doharpan:</strong> Dushit links ke saath web cache ko poison karne ke liye duplicate Host headers ka upyog kiya gaya.</p>
          <p class="en"><strong>Impact:</strong> Widespread distribution of malicious links to unsuspecting users.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Ashankit upyogkartaon ke beech dushit links ka vyapak vitaran.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Web Cache Poisoning -->
  <section id="try-cache">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Web Cache Poisoning</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Web Cache Poisoning</h2>
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Exploit Cache Poisoning</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Cache Poisoning Ka Faida Uthao</h3>
        <p class="en">Manipulate the Host header to poison the web cache with malicious content.</p>
        <p class="hi" style="display:none;">Dushit samagri ke saath web cache ko poison karne ke liye Host header ko chhedchhad karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="cache-host" class="en">Host Header:</label>
            <label for="cache-host" class="hi" style="display:none;">Host Header:</label>
            <input type="text" id="cache-host" value="evil.com">
          </div>
          <button class="button" onclick="poisonWebCache()">Poison Cache</button>
          <div class="result-box" id="cache-poison-result">
// Cache poisoning attempt
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Prevention -->
  <section id="prevention">
    <div class="container">
      <h2 class="section-title en">How to Prevent Host Header Attacks</h2>
      <h2 class="section-title hi" style="display:none;">Host Header Attacks Ko Kaise Rokein</h2>
      
      <!-- Prevention Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Host Header Prevention - Visualization</h3>
        <h3 class="hi" style="display:none;">Host Header Bachav - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Malicious Host</div>
            <div class="hi" style="display:none;">Dushit Host</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">evil.com</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Defense Layers</div>
            <div class="hi" style="display:none;">Bachav Perton</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Validation, Whitelisting</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Blocked Request</div>
            <div class="hi" style="display:none;">Rukawat Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Access Denied</div>
          </div>
        </div>
      </div>

      <!-- Secure Coding Practices -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Secure Coding Practices</h3>
        <h3 class="hi" style="display:none;">Surakshit Coding Abhyas</h3>
        
        <!-- Input Validation -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Host Header Validation</h4>
          <p class="en">Implement strict validation of the Host header against a whitelist of known domains.</p>
          <p class="hi" style="display:none;">Jnata domain ki whitelist ke viruddh Host header ki kathor manyaata lagayen.</p>
          <div class="code-block">
// Example: Validate Host header
const allowedHosts = [
  'example.com',
  'www.example.com'
];

function isValidHost(host) {
  return allowedHosts.includes(host);
}
          </div>
        </div>
        
        <!-- Avoid Trusting Headers -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Don't Trust HTTP Headers</h4>
          <p class="en">Avoid using Host header or other user-controllable headers for security-sensitive operations.</p>
          <p class="hi" style="display:none;">Suraksha-sanshilit sancharanon ke liye Host header ya anye upyogkarta-niyantit headers ka upyog nahi karein.</p>
          <div class="code-block">
// Example: Use server configuration instead of Host header
const baseUrl = 'https://example.com'; // Fixed base URL
function generateResetLink(token) {
  return `${baseUrl}/reset-password?token=${token}`;
}
          </div>
        </div>
        
        <!-- Web Server Configuration -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Web Server Configuration</h4>
          <p class="en">Configure your web server to reject requests with unexpected Host header values.</p>
          <p class="hi" style="display:none;">Apratyashit Host header maanon ke saath anurodhon ko asvarikaran karne ke liye apne web server ko koonfigar karein.</p>
          <div class="code-block">
# Apache configuration
ServerName example.com
ServerAlias www.example.com
# Reject requests with other Host headers

# Nginx configuration
server {
  server_name example.com www.example.com;
  # Handle requests with other Host headers appropriately
}
          </div>
        </div>
        
        <!-- Cache Key Management -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. Proper Cache Key Management</h4>
          <p class="en">Ensure cache keys don't include user-controllable input like the Host header.</p>
          <p class="hi" style="display:none;">Yeh sunishchit karein ki cache keys mein Host header jaise upyogkarta-niyantit input shamil na ho.</p>
          <div class="code-block">
// Example: Cache key without Host header
const cacheKey = `page-content-${pageId}`; // Not including Host header
// Instead of: `page-content-${host}-${pageId}`
          </div>
        </div>
      </div>

      <!-- Lab Environment Simulation -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Lab Environment Simulation</h3>
        <h3 class="hi" style="display:none;">Prayogshala Vatavaran Anukaran</h3>
        <p class="en">Set up a safe environment to test Host Header attack prevention techniques without risking production systems.</p>
        <p class="hi" style="display:none;">Utpadan pranaliyon ko jokhim mein daale bina Host Header hamlawar bachav tarikon ka parikshan karne ke liye surakshit vatanavaran sthapit karein.</p>
        
        <div class="interactive-demo animate-on-scroll">
          <h4 style="color: var(--neon-green);">Host Header Prevention Testing</h4>
          <div class="demo-container">
            <div class="input-group">
              <label for="test-host" class="en">Host Header:</label>
              <label for="test-host" class="hi" style="display:none;">Host Header:</label>
              <input type="text" id="test-host" value="evil.com" placeholder="Enter Host header to test">
            </div>
            <button class="button" onclick="testHostHeaderProtection()" style="position: relative; z-index: 10;">Test Protection</button>
            <div class="result-box" id="host-protection-result">
// Results will appear here
            </div>
          </div>
        </div>
        
        <!-- Interactive Lab Exercise -->
        <div class="interactive-demo animate-on-scroll">
          <h4 style="color: var(--electric-blue);">Interactive Lab Exercise</h4>
          <p class="en">Try different Host headers to see how protection mechanisms work:</p>
          <p class="hi" style="display:none;">Alag-alag Host headers ka prayog karein taaki bachav yantra kaise kaam karte hain yeh dekh sakein:</p>
          
          <div class="demo-container">
            <div class="input-group">
              <label for="lab-host" class="en">Host Header:</label>
              <label for="lab-host" class="hi" style="display:none;">Host Header:</label>
              <input type="text" id="lab-host" placeholder="Enter any Host header to test">
            </div>
            <div style="display: flex; gap: 10px;">
              <button class="button" onclick="testLabHost()" style="position: relative; z-index: 10;">Test Host</button>
              <button class="button" style="background: var(--neon-orange); position: relative; z-index: 10;" onclick="clearLabHostResults()">Clear</button>
            </div>
            <div class="result-box" id="lab-host-result">
// Lab results will appear here
            </div>
            
            <!-- Predefined Test Cases -->
            <div style="margin-top: 20px;">
              <h5 class="en" style="color: var(--neon-green);">Quick Test Cases:</h5>
              <h5 class="hi" style="color: var(--neon-green); display:none;">Tvarit Parikshan Ke Antar:</h5>
              <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                <button class="button" style="background: var(--electric-blue); padding: 8px 12px; font-size: 0.9rem; position: relative; z-index: 10;" onclick="setTestHost('evil.com')">Malicious Host</button>
                <button class="button" style="background: var(--electric-blue); padding: 8px 12px; font-size: 0.9rem; position: relative; z-index: 10;" onclick="setTestHost('localhost')">Localhost</button>
                <button class="button" style="background: var(--electric-blue); padding: 8px 12px; font-size: 0.9rem; position: relative; z-index: 10;" onclick="setTestHost('example.com')">Valid Host</button>
                <button class="button" style="background: var(--electric-blue); padding: 8px 12px; font-size: 0.9rem; position: relative; z-index: 10;" onclick="setTestHost('target.com.evil.com')">Subdomain Attack</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Quiz -->
  <section id="quiz">
    <div class="container">
      <h2 class="section-title en">Knowledge Check</h2>
      <h2 class="section-title hi" style="display:none;">Jaankari Check Karein</h2>
      <div class="quiz-container animate-on-scroll">
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px;" class="en">Test Your Understanding</h3>
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px; display:none;" class="hi">Apni Samajh Ko Test Karein</h3>
        <div id="quiz-questions">
          <!-- Questions will be injected here -->
        </div>
        <div class="score-display" id="score-display">Score: 0 / 10</div>
        <button class="button quiz-submit" onclick="submitQuiz()">Submit Quiz</button>
        <div id="feedback" style="margin-top: 20px; display: none;"></div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <h3 class="en">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</h3>
      <h3 class="hi" style="display:none;">Ankush Rana Dwara | HTB Elite Hacker | Senior Security Engineer</h3>
      <p class="en">Breaking Systems. Building Defenses.</p>
      <p class="hi" style="display:none;">Systems todte hain. Defenses banate hain.</p>
      
      <div class="social-links">
        <a href="https://github.com/ankushrana6395" target="_blank" class="social-link github">
          <i class="fab fa-github"></i>
        </a>
        <a href="mailto:ankushrana6395@gmail.com" class="social-link email">
          <i class="fas fa-envelope"></i>
        </a>
        <a href="https://app.hackthebox.com/profile/117501" target="_blank" class="social-link htb">
          <i class="fas fa-cube"></i>
        </a>
      </div>
      
      <p style="margin-top: 30px;" class="en">&copy; 2025 Ankush Rana. All Rights Reserved.</p>
      <p style="margin-top: 30px; display:none;" class="hi">&copy; 2025 Ankush Rana. Sabhi Adhikar Sanchit Hai.</p>
    </div>
  </footer>

  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>    let isHinglish = false;
    
    
    
    
    
    
    
    
    
    
    
    

    // Card Interaction Functions (defined first to ensure they're available)
    function highlightCard(card) {
      card.classList.add('pop-out');
      showNotification('Hovering: ' + card.querySelector('h3').textContent);
    }
    function unhighlightCard(card) {
      if (!card.classList.contains('focused')) {
        card.classList.remove('pop-out');
      }
    }
    function focusCard(card) {
      document.querySelectorAll('.lecture-card').forEach(c => {
        c.classList.remove('focused');
        c.classList.remove('pop-out');
      });
      card.classList.add('focused');
      card.classList.add('pop-out');
      showNotification('Focused on: ' + card.querySelector('h3').textContent);
    }

    // Initialize Three.js
    const canvas = document.getElementById('three-canvas');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

    // Grid
    const gridHelper = new THREE.GridHelper(100, 100, 0x00ff88, 0x003322);
    gridHelper.position.z = -20;
    scene.add(gridHelper);

    // Floating Points
    const geometry = new THREE.BufferGeometry();
    const count = 500;
    const positions = new Float32Array(count * 3);
    for (let i = 0; i < count * 3; i++) {
      positions[i] = (Math.random() - 0.5) * 100;
    }
    geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
    const material = new THREE.PointsMaterial({ color: 0x00ff88, size: 0.5, transparent: true, opacity: 0.8 });
    const points = new THREE.Points(geometry, material);
    scene.add(points);

    // Add floating cubes
    const cubeGeometry = new THREE.BoxGeometry(2, 2, 2);
    const cubeMaterial = new THREE.MeshBasicMaterial({ 
      color: 0x00aaff, 
      wireframe: true,
      transparent: true,
      opacity: 0.5
    });
    const cubes = [];
    for (let i = 0; i < 10; i++) {
      const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
      cube.position.x = (Math.random() - 0.5) * 50;
      cube.position.y = (Math.random() - 0.5) * 50;
      cube.position.z = (Math.random() - 0.5) * 50;
      cube.rotation.x = Math.random() * Math.PI;
      cube.rotation.y = Math.random() * Math.PI;
      cubes.push({ mesh: cube, speed: Math.random() * 0.02 });
      scene.add(cube);
    }

    camera.position.z = 30;

    // Animation
    function animate() {
      requestAnimationFrame(animate);
      gridHelper.rotation.y += 0.005;
      points.rotation.y += 0.003;
      cubes.forEach(cube => {
        cube.mesh.rotation.x += cube.speed;
        cube.mesh.rotation.y += cube.speed;
      });
      renderer.render(scene, camera);
    }
    animate();

    // Resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });


    // Keyword Modal
    const keywordModal = document.getElementById('keyword-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    const modalClose = document.getElementById('modal-close');
    document.querySelectorAll('.keyword').forEach(keyword => {
      keyword.addEventListener('click', function(e) {
        e.stopPropagation();
        modalTitle.textContent = this.getAttribute('data-title');
        modalBody.textContent = this.getAttribute('data-content');
        keywordModal.classList.add('active');
      });
    });
    modalClose.addEventListener('click', () => {
      keywordModal.classList.remove('active');
    });
    keywordModal.addEventListener('click', (e) => {
      if (e.target === keywordModal) {
        keywordModal.classList.remove('active');
      }
    });

    // Language Toggle with null checks
    function toggleLanguage() {
      isHinglish = !isHinglish;
      const enElements = document.querySelectorAll('.en');
      const hiElements = document.querySelectorAll('.hi');
      const translatorBtn = document.getElementById('translator-btn');
      enElements.forEach(el => {
        if (el) el.style.display = isHinglish ? 'none' : 'block';
      });
      hiElements.forEach(el => {
        if (el) el.style.display = isHinglish ? 'block' : 'none';
      });
      if (translatorBtn) {
        translatorBtn.textContent = isHinglish ? '🌐 English On' : '🌐 Hinglish On';
      }
      showNotification(isHinglish ? 'Hinglish mode activated!' : 'English mode activated!');
    }

    // Mass Assignment Demo
    function runMassAssignment() {
      const payload = document.getElementById('api-input').value;
      const result = document.getElementById('mass-result');
      try {
        const json = JSON.parse(payload);
        if (json.isAdmin === true || json.role === "admin") {
          result.innerHTML = isHinglish 
            ? `<span style="color: #00ff88">✅ Admin Privileges Gained!</span>
Welcome Admin!
Access: [User Management] [Logs] [Settings]
🔐 Full Control Activated` 
            : `<span style="color: #00ff88">✅ Admin Privileges Gained!</span>
Welcome Admin!
Access: [User Management] [Logs] [Settings]
🔐 Full Control Activated`;
          showNotification(isHinglish ? 'API: Mass assignment successful!' : 'API: Mass assignment successful!');
        } else {
          result.innerHTML = isHinglish 
            ? `<span style="color: #ff8800">❌ Request processed normally.</span>` 
            : `<span style="color: #ff8800">❌ Request processed normally.</span>`;
        }
      } catch (e) {
        result.innerHTML = isHinglish 
          ? `<span style="color: #ff8800">❌ Invalid JSON.</span>` 
          : `<span style="color: #ff8800">❌ Invalid JSON.</span>`;
      }
    }

    // Demo Functions with null checks
    function requestPasswordReset() {
      const emailInput = document.getElementById('email-input');
      const result = document.getElementById('password-reset-result');
      if (!emailInput || !result) return;
      const email = emailInput.value;
      result.innerHTML = `✅ Request sent from: ${email}\\n🔗 Reset link: http://example.com/reset?token=normal\\n\\n📧 Email sent to: ${email} with link to example.com`;
    }

    function poisonPasswordReset() {
      const hostInput = document.getElementById('poison-host');
      const emailInput = document.getElementById('victim-email');
      const result = document.getElementById('poison-reset-result');
      if (!hostInput || !emailInput || !result) return;
      const host = hostInput.value;
      const email = emailInput.value;
      result.innerHTML = `🚨 Host Header Poisoned!\\n💀 Host: ${host}\\n📧 Email: ${email}\\n\\n🔗 Poisoned Reset Link: http://${host}/reset?token=poisoned\\n\\n⚠️ Victim redirected to evil server!`;
    }

    function poisonWebCache() {
      const hostInput = document.getElementById('cache-host');
      const result = document.getElementById('cache-poison-result');
      if (!hostInput || !result) return;
      const host = hostInput.value;
      result.innerHTML = `🕷️ Cache Poisoning Attempt!\\n💀 Host: ${host}\\n\\n📦 Cache Key Generated: cache-${host}\\n\\n⚠️ All visitors will get redirected to: ${host}`;
    }

    function testHostHeaderProtection() {
      const hostInput = document.getElementById('test-host');
      const result = document.getElementById('host-protection-result');
      if (!hostInput || !result) return;
      const host = hostInput.value;
      const allowedHosts = ['example.com', 'www.example.com'];
      if (allowedHosts.includes(host)) {
        result.innerHTML = `✅ Valid Host: ${host}\\n🔒 Access Granted\\n\\n🛡️ Protection Working Correctly`;
      } else {
        result.innerHTML = `❌ Invalid Host: ${host}\\n🚫 Access Denied\\n\\n⚠️ Potential Attack Detected!`;
      }
    }

    function testLabHost() {
      const hostInput = document.getElementById('lab-host');
      const result = document.getElementById('lab-host-result');
      if (!hostInput || !result) return;
      const host = hostInput.value;
      if (!host) {
        result.innerHTML = `⚠️ Please enter a Host header to test!`;
        return;
      }
      const allowedHosts = ['example.com', 'www.example.com'];
      if (allowedHosts.includes(host)) {
        result.innerHTML = `✅ ${host}\\n🔒 Whitelisted\\n\\n🚀 Request Processed`;
      } else {
        result.innerHTML = `❌ ${host}\\n🚫 Blocked\\n\\n⚠️ Malicious Host Detected`;
      }
    }

    function clearLabHostResults() {
      const result = document.getElementById('lab-host-result');
      const input = document.getElementById('lab-host');
      if (result) result.innerHTML = '';
      if (input) input.value = '';
    }

    function setTestHost(value) {
      const input = document.getElementById('lab-host');
      if (!input) return;
      input.value = value;
    }

    // Quiz Questions (10 Questions about Host Header Attacks)
    const quizQuestions = [
      {
        question: {
          en: "What is a Host Header Attack?",
          hi: "Host Header Attack kya hota hai?"
        },
        options: {
          en: [
            "Attack on database",
            "Manipulating Host header to trick server",
            "Network sniffing",
            "Password cracking"
          ],
          hi: [
            "Database par hamlawar",
            "Host header ko manipulat kar ke server ko chhodna",
            "Network sniffing",
            "Password cracking"
          ]
        },
        correct: 1,
        explanation: {
          en: "Host Header Attacks manipulate HTTP Host headers to exploit server logic.",
          hi: "Host Header Attacks HTTP Host headers ko manipulat kar ke server logic ko exploit karte hain।"
        }
      },
      {
        question: {
          en: "What is Password Reset Poisoning?",
          hi: "Password Reset Poisoning kya hota hai?"
        },
        options: {
          en: [
            "Changing someone else's password",
            "Using Host header to redirect reset emails",
            "Guessing reset tokens",
            "Brute forcing passwords"
          ],
          hi: [
            "Kisi aur ka password badalna",
            "Reset emails ko redirect karne ke liye Host header ka upyog",
            "Reset tokens ko guess karna",
            "Passwords brute force karna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Password Reset Poisoning redirects reset emails to attacker-controlled servers.",
          hi: "Password Reset Poisoning reset emails ko attacker-control servers pe redirect karta hai।"
        }
      },
      {
        question: {
          en: "What is Web Cache Poisoning?",
          hi: "Web Cache Poisoning kya hota hai?"
        },
        options: {
          en: [
            "Corrupting database cache",
            "Poisoning web cache with malicious content",
            "Clearing browser cache",
            "Attacking client-side cache"
          ],
          hi: [
            "Database cache kharab karna",
            "Web cache ko malicious content se poison karna",
            "Browser cache clear karna",
            "Client-side cache par hamlawar"
          ]
        },
        correct: 1,
        explanation: {
          en: "Web Cache Poisoning injects malicious content into cached responses.",
          hi: "Web Cache Poisoning cached responses mein malicious content inject karta hai।"
        }
      },
      {
        question: {
          en: "How can you bypass Host header validations?",
          hi: "Host header validations ko kaise bypass kar sakte hain?"
        },
        options: {
          en: [
            "Use X-Forwarded-Host header",
            "Change User-Agent",
            "Use POST instead of GET",
            "Add extra cookies"
          ],
          hi: [
            "X-Forwarded-Host header ka upyog karein",
            "User-Agent change karein",
            "GET ki jagah POST istemal karein",
            "Extra cookies jodein"
          ]
        },
        correct: 0,
        explanation: {
          en: "X-Forwarded-Host and other headers can bypass standard Host validations.",
          hi: "X-Forwarded-Host aur anye headers standard Host validations ko bypass kar sakte hain।"
        }
      },
      {
        question: {
          en: "What is the impact of Host Header Attacks?",
          hi: "Host Header Attacks ka impact kya hota hai?"
        },
        options: {
          en: [
            "Website down time",
            "Account takeover, cache poisoning, data leaks",
            "System crashes",
            "Only minor issues"
          ],
          hi: [
            "Website down time",
            "Account takeover, cache poisoning, data leaks",
            "System crashes",
            "Sirf chhote issues"
          ]
        },
        correct: 1,
        explanation: {
          en: "Host Header Attacks can lead to serious security issues like account takeover.",
          hi: "Host Header Attacks account takeover jaise serious security issues ka karan bana sakte hain।"
        }
      },
      {
        question: {
          en: "Which header can override Host behavior?",
          hi: "Kaunsa header Host behavior ko override kar sakta hai?"
        },
        options: {
          en: [
            "User-Agent",
            "X-Forwarded-Host",
            "Accept-Language",
            "Authorization"
          ],
          hi: [
            "User-Agent",
            "X-Forwarded-Host",
            "Accept-Language",
            "Authorization"
          ]
        },
        correct: 1,
        explanation: {
          en: "X-Forwarded-Host can override the standard Host header.",
          hi: "X-Forwarded-Host standard Host header ko override kar sakta hai।"
        }
      },
      {
        question: {
          en: "What should be done to prevent Host Header Attacks?",
          hi: "Host Header Attacks ko prevent karne ke liye kya karna chahiye?"
        },
        options: {
          en: [
            "Use HTTPS always",
            "Validate and whitelist Host headers",
            "Add firewall rules",
            "Change domain name"
          ],
          hi: [
            "Hamesha HTTPS istemal karein",
            "Host headers validate aur whitelist karein",
            "Firewall rules jodein",
            "Domain naam change karein"
          ]
        },
        correct: 1,
        explanation: {
          en: "Server should validate Host header against allowed values.",
          hi: "Server ko Host header ko allowed values ke against validate karna chahiye।"
        }
      },
      {
        question: {
          en: "Which technique uses duplicate headers?",
          hi: "Kaunsi technique duplicate headers ka upyog karti hai?"
        },
        options: {
          en: [
            "X-Forwarded-Host bypass",
            "Duplicate Host headers",
            "Absolute URL",
            "All of them"
          ],
          hi: [
            "X-Forwarded-Host bypass",
            "Duplicate Host headers",
            "Absolute URL",
            "Sabhi"
          ]
        },
        correct: 1,
        explanation: {
          en: "Sending multiple Host headers can confuse server parsing.",
          hi: "Multiple Host headers bhejne se server parsing confuse ho sakti hai।"
        }
      },
      {
        question: {
          en: "What is cache key in web caching?",
          hi: "Web caching mein cache key kya hota hai?"
        },
        options: {
          en: [
            "Server password",
            "Key for cache identification",
            "Browser cookie",
            "Database key"
          ],
          hi: [
            "Server password",
            "Cache identification ke liye key",
            "Browser cookie",
            "Database key"
          ]
        },
        correct: 1,
        explanation: {
          en: "Cache key determines which cached response to return.",
          hi: "Cache key nirdharit karta hai ki kaunsi cached response return kari jayegi।"
        }
      },
      {
        question: {
          en: "Which attack persists across users?",
          hi: "Kaunsi hamlawar users ke beech persists rahati hai?"
        },
        options: {
          en: [
            "Password Reset Poisoning",
            "Web Cache Poisoning",
            "Session Hijacking",
            "SQL Injection"
          ],
          hi: [
            "Password Reset Poisoning",
            "Web Cache Poisoning",
            "Session Hijacking",
            "SQL Injection"
          ]
        },
        correct: 1,
        explanation: {
          en: "Web Cache Poisoning affects all users until cache expires.",
          hi: "Web Cache Poisoning sabhi users ko affect karta hai jab tak cache expire nahi hota।"
        }
      }
    ];

    // Render Quiz
    function renderQuiz() {
      const quizContainer = document.getElementById('quiz-questions');
      quizContainer.innerHTML = '';
      quizQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'quiz-question';
        const qText = isHinglish ? q.question.hi : q.question.en;
        const opts = isHinglish ? q.options.hi : q.options.en;
        questionDiv.innerHTML = `
          <h4>Q${index + 1}: ${qText}</h4>
          <div class="options" id="options-${index}">
            ${opts.map((opt, i) => `
              <div class="option" onclick="selectOption(${index}, ${i})">${opt}</div>
            `).join('')}
          </div>
        `;
        quizContainer.appendChild(questionDiv);
      });
    }

    // Track selected answers
    const selectedAnswers = new Array(quizQuestions.length).fill(-1);

    // Select Option
    window.selectOption = function(questionIndex, optionIndex) {
      document.querySelectorAll(`#options-${questionIndex} .option`).forEach(opt => {
        opt.classList.remove('selected');
      });
      document.querySelectorAll(`#options-${questionIndex} .option`)[optionIndex].classList.add('selected');
      selectedAnswers[questionIndex] = optionIndex;
    };



    // Submit Quiz
    window.submitQuiz = function() {
      let score = 0;
      const feedback = document.getElementById('feedback');
      if (!feedback) return;
      feedback.innerHTML = '';
      feedback.style.display = 'block';

      const scoreDisplay = document.getElementById('score-display');
      if (!scoreDisplay) return;

      quizQuestions.forEach((q, index) => {
        const options = document.querySelectorAll(`#options-${index} .option`);
        const explanation = isHinglish ? q.explanation.hi : q.explanation.en;

        if (selectedAnswers[index] === q.correct) {
          score++;
          if (options[q.correct]) {
            options[q.correct].classList.add('correct');
          }
          if (selectedAnswers[index] !== -1 && options[selectedAnswers[index]]) {
            options[selectedAnswers[index]].classList.add('correct');
          }
        } else {
          if (options[q.correct]) {
            options[q.correct].classList.add('correct');
          }
          if (selectedAnswers[index] !== -1 && selectedAnswers[index] !== q.correct && options[selectedAnswers[index]]) {
            options[selectedAnswers[index]].classList.add('incorrect');
          }
        }

        feedback.innerHTML += `<strong>Q${index + 1}:</strong> ${explanation}<br><br>`;
      });

      scoreDisplay.textContent = `Score: ${score} / ${quizQuestions.length}`;
      showNotification(isHinglish ? `Quiz pura! Score: ${score}/${quizQuestions.length}` : `Quiz complete! You scored ${score}/${quizQuestions.length}`);
    };

    // Notification
    function showNotification(message) {
      const notification = document.getElementById('notification');
      const notificationText = document.getElementById('notification-text');
      if (!notification || !notificationText) return;
      notificationText.textContent = message;
      notification.classList.add('show');
      setTimeout(() => notification.classList.remove('show'), 3000);
    }

    // Scroll Progress Bar
    window.addEventListener('scroll', () => {
      const progressBar = document.getElementById('progress-bar');
      if (!progressBar) return;
      const winHeight = window.innerHeight;
      const docHeight = document.documentElement.scrollHeight;
      const scrollTop = window.pageYOffset;
      const trackLength = docHeight - winHeight;
      if (trackLength <= 0) return;
      const progress = Math.min((scrollTop / trackLength) * 100, 100);
      progressBar.style.width = progress + '%';
    });

    // Animation on Scroll
    document.addEventListener('DOMContentLoaded', () => {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) entry.target.classList.add('visible');
        });
      }, { threshold: 0.1 });
      document.querySelectorAll('.animate-on-scroll').forEach(el => {
        if (el) observer.observe(el);
      });
      renderQuiz();
    });
  </script>
</body>
</html>
