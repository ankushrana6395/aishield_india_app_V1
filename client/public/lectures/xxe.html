<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Interactive XXE Masterclass | Click Keywords | Pop-Out Cards | By HTB Elite Hacker">
  <title>XXE Vulnerability Masterclass | By Ankush Rana</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;600;700;900&family=Roboto:wght@300;400;500;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --primary: #0a1121;
      --dark-navy: #0b1b30;
      --neon-green: #00ff88;
      --electric-blue: #00aaff;
      --neon-orange: #ff8800;
      --neon-pink: #ff0080;
      --glow-green: rgba(0, 255, 136, 0.3);
      --glow-blue: rgba(0, 170, 255, 0.2);
      --glow-pink: rgba(255, 0, 128, 0.3);
      --light-gray: #e0e0e0;
      --mid-gray: #aaaaaa;
      --card-bg: #111c30;
      --border: #2a4060;
      --keyword: #ffdd57;
      --keyword-bg: rgba(255, 221, 87, 0.15);
    }

    /* Translator Button */
    .translator-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 0 15px var(--glow-green);
      transition: all 0.3s ease;
    }

    .translator-btn:hover {
      transform: translateY(-2px);
      background: #00cc6d;
    }

    /* Quiz Section */
    .quiz-container {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .quiz-question {
      margin-bottom: 20px;
    }

    .quiz-question h4 {
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      background: rgba(0, 255, 136, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
    }

    .option.selected {
      background: var(--neon-green);
      color: var(--primary);
      font-weight: bold;
    }

    .option.correct {
      background: #00ff88;
      color: var(--primary);
      font-weight: bold;
    }

    .option.incorrect {
      background: #ff8800;
      color: var(--primary);
      font-weight: bold;
    }

    .score-display {
      text-align: center;
      font-size: 1.5rem;
      margin: 20px 0;
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
    }

    .button.quiz-submit {
      background: var(--neon-orange);
      color: white;
    }

    .button.quiz-submit:hover {
      background: #cc7000;
    }

    /* Feedback Section */
    .feedback {
      margin-top: 20px;
      padding: 15px;
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid var(--neon-green);
      border-radius: 8px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.95rem;
      display: none;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--primary);
      color: var(--light-gray);
      line-height: 1.7;
      overflow-x: hidden;
    }

    /* Three.js Background */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header / Hero */
    header {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-content {
      z-index: 2;
      max-width: 900px;
      position: relative;
    }

    .hero-content h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2.8rem, 8vw, 4rem);
      color: white;
      margin-bottom: 10px;
      text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
      50% { text-shadow: 0 0 25px rgba(0, 255, 136, 0.9), 0 0 35px rgba(0, 255, 136, 0.5); }
      100% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
    }

    .hero-content h1 span {
      color: var(--neon-green);
    }

    .subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: clamp(1.2rem, 3.5vw, 1.5rem);
      color: var(--electric-blue);
      margin: 15px 0;
    }

    /* Section Styling */
    section {
      padding: 100px 0;
      position: relative;
    }

    .section-title {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2rem, 5vw, 2.5rem);
      color: var(--neon-green);
      margin-bottom: 50px;
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -8px;
      width: 70px;
      height: 4px;
      background: var(--electric-blue);
      animation: expand 2s infinite;
    }

    @keyframes expand {
      0% { width: 70px; }
      50% { width: 100px; }
      100% { width: 70px; }
    }

    /* Lecture Card */
    .lecture-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .lecture-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 136, 0.05), transparent);
      z-index: 0;
    }

    .lecture-card.pop-out {
      transform: translateY(-20px) scale(1.05);
      box-shadow:
        0 30px 60px rgba(0, 0, 0, 0.5),
        0 0 50px var(--glow-green);
      border-color: var(--neon-green);
      z-index: 5;
    }

    .lecture-card.focused {
      transform: translateY(-20px) scale(1.06);
      box-shadow:
        0 40px 80px rgba(0, 0, 0, 0.6),
        0 0 70px var(--glow-green);
      filter: brightness(1.1);
    }

    .lecture-card h3 {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 18px;
      font-size: 1.8rem;
      position: relative;
      z-index: 2;
    }

    /* Keyword Style */
    .keyword {
      background: var(--keyword-bg);
      color: var(--keyword);
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 1px dashed var(--keyword);
      position: relative;
      transition: all 0.3s ease;
      z-index: 2;
    }

    .keyword:hover {
      background: rgba(255, 221, 87, 0.3);
      box-shadow: 0 0 12px rgba(255, 221, 87, 0.4);
    }

    /* Tooltip (Modal) */
    .keyword-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 17, 33, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .keyword-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border: 2px solid var(--neon-green);
      border-radius: 14px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 50px var(--glow-green);
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .keyword-modal.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--neon-green);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-title {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .modal-body {
      color: var(--light-gray);
      line-height: 1.6;
    }

    /* Interactive Demo */
    .interactive-demo {
      background: rgba(0, 20, 40, 0.6);
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      border: 1px solid var(--electric-blue);
    }

    .demo-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .input-group label {
      min-width: 120px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--neon-green);
    }

    .input-group input {
      flex: 1;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: white;
      font-family: 'JetBrains Mono', monospace;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--neon-green);
      box-shadow: 0 0 10px var(--glow-green);
    }

    .button {
      padding: 12px 24px;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 4px;
      font-family: 'Orbitron', sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: fit-content;
    }

    .button:hover {
      background: #00cc6d;
      box-shadow: 0 0 15px var(--glow-green);
      transform: translateY(-2px);
    }

    .result-box {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 6px;
      padding: 15px;
      margin-top: 15px;
      border-left: 3px solid var(--neon-green);
      font-family: 'JetBrains Mono', monospace;
      min-height: 100px;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    /* Diagram */
    .diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }

    .box {
      min-width: 140px;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      font-weight: bold;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }

    .box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
    }

    .box:hover::before {
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }

    .user-input { background: #8b0000; color: white; }
    .app { background: #003366; color: white; }
    .db { background: #004d00; color: #00ff88; }

    .arrow {
      font-size: 1.8rem;
      color: var(--neon-green);
      position: relative;
    }

    .arrow::before {
      content: '→';
      animation: arrow-pulse 1.5s infinite;
    }

    @keyframes arrow-pulse {
      0% { text-shadow: 0 0 5px var(--neon-green); }
      50% { text-shadow: 0 0 15px var(--neon-green); }
      100% { text-shadow: 0 0 5px var(--neon-green); }
    }

    /* XML Code Block */
    .xml-code {
      background: #001a1a;
      color: #00ff88;
      font-family: 'JetBrains Mono', monospace;
      padding: 15px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 15px 0;
      border-left: 4px solid var(--neon-green);
      position: relative;
    }

    .xml-code::before {
      content: 'XML';
      position: absolute;
      top: 0;
      right: 0;
      background: var(--neon-green);
      color: var(--primary);
      font-size: 0.7rem;
      padding: 2px 8px;
      border-bottom-left-radius: 4px;
      font-weight: bold;
    }

    /* Statistics Section */
    .stats-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin: 30px 0;
    }

    .stat-box {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
      min-width: 200px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      border-color: var(--neon-green);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .stat-label {
      color: var(--mid-gray);
      font-size: 0.9rem;
    }

    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: transparent;
      z-index: 1000;
    }

    .progress-bar {
      height: 100%;
      background: var(--neon-green);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Notification */
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--neon-green);
      border-radius: 8px;
      padding: 15px;
      color: var(--light-gray);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 60px 0;
      background: var(--dark-navy);
      color: var(--mid-gray);
      position: relative;
      overflow: hidden;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--neon-green), var(--electric-blue), var(--neon-pink));
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .social-link.github:hover { background: var(--neon-green); color: var(--primary); }
    .social-link.email:hover { background: var(--electric-blue); }
    .social-link.htb:hover { background: var(--neon-orange); }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-content h1 { font-size: 2.8rem; }
      .section-title { font-size: 1.8rem; }
      .diagram { flex-direction: column; }
      .arrow::before { content: '↓'; }
      .input-group { flex-direction: column; }
      .input-group label { min-width: auto; }
    }
  </style>
</head>
<body>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <!-- Translator Button -->
  <button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="right: auto; left: 20px;">
    🌐 Hinglish On
  </button>

  <!-- Keyword Modal -->
  <div class="keyword-modal" id="keyword-modal">
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h3 class="modal-title" id="modal-title">Keyword</h3>
      <div class="modal-body" id="modal-body">Definition will appear here.</div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i> <span id="notification-text">Welcome to the XXE Masterclass!</span>
  </div>

  <!-- Three.js Background Canvas -->
  <canvas id="three-canvas"></canvas>

  <!-- Header / Hero -->
  <header id="home">
    <div class="container">
      <div class="hero-content"><!-- English Version -->
        <div class="en">
          <h1>XXE <span>Vulnerability</span></h1>
          <div class="subtitle">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</div>
          <p>A deep dive into XML External Entity vulnerabilities & defense techniques — with interactive demos and real-world insights.</p>
        </div>

        <!-- Hinglish Version -->
        <div class="hi" style="display:none;">
          <h1>XXE <span>kamjori</span></h1>
          <div class="subtitle">Ankush Rana द्वारा | HTB Elite Hacker | Senior Security Engineer</div>
          <p>XML External Entity kamjoriyon aur bachav techniques mein gahrai se jaane — interactive demos aur real-world insights ke saath.</p>
        </div>

        <!-- HTB & Bug Bounty Credibility -->
        <div style="margin-top: 40px; display: flex; align-items: center; gap: 25px; flex-wrap: wrap; justify-content: center; font-family: 'JetBrains Mono', monospace;">
          <img src="https://www.hackthebox.com/storage/achievements/elite_2024_badge.svg" alt="HTB Elite" style="width: 90px; filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
          <div style="text-align: center;">
            <img src="https://via.placeholder.com/100/0a1121/00ff88?text=AR" alt="Ankush Rana" style="width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--neon-green); filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
            <p style="margin: 5px 0 0; color: var(--neon-green);">52+ User Flags</p>
            <p style="margin: 0; color: var(--electric-blue);">47+ Root Owned</p>
          </div>
          <div style="text-align: center;">
            <p style="color: var(--neon-orange);">🏆 Top 10 India</p>
            <p style="color: var(--neon-pink);">💼 Sattrix | GPSSI</p>
          </div>
        </div>

        <!-- Call to Action -->
        <div style="margin-top: 30px; font-family: 'Orbitron', sans-serif; color: var(--electric-blue);">
          <i class="fas fa-mouse-pointer"></i> Toggle Hinglish Mode → <strong>Top Right Corner</strong>
        <div style="display: flex; justify-content: center; margin-top: 10px;"><button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="position: relative; margin: 0 auto;">🌐 Hinglish On</button></div>
        </div>
      </div>
    </div>
  </header>

  <!-- Section: What is XXE -->
  <section id="basics">
    <div class="container">
      <h2 class="section-title en">What is XXE?</h2>
      <h2 class="section-title hi" style="display:none;">XXE Kya Hai?</h2>

      <!-- Progress Tracker -->
      <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
        <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-green);">1</div>
          <div class="step-title en">Basic Concepts</div>
          <div class="step-title hi" style="display:none;">Mool Baat</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--electric-blue);">2</div>
          <div class="step-title en">Attack Vectors</div>
          <div class="step-title hi" style="display:none;">Hamlawar Ke Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-orange);">3</div>
          <div class="step-title en">Advanced Techniques</div>
          <div class="step-title hi" style="display:none;">Uchatam Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 0, 128, 0.1); border: 1px solid var(--neon-pink); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-pink);">4</div>
          <div class="step-title en">Prevention</div>
          <div class="step-title hi" style="display:none;">Bachav</div>
        </div>
      </div>

      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">XML External Entity Vulnerability</h3>
        <h3 class="hi" style="display:none;">XML External Entity Kamjori</h3>
        <p class="en"><span class="keyword" data-title="XML External Entity (XXE)" data-content="A vulnerability in XML parsers that allows attackers to read internal files, perform SSRF, and execute arbitrary code by processing external entities.">XML External Entity (XXE)</span> occurs when an application's XML parser processes external entities referenced in XML input.</p>
        <p class="hi" style="display:none;"><span class="keyword" data-title="XML External Entity (XXE)" data-content="XML parsers mein ek kamjori jo attackers ko internal files read karne, SSRF perform karne, aur arbitrary code execute karne ki suvidha deti hai jab external entities ko process kiya जाता है।">XML External Entity (XXE)</span> tab hota hai jab application ka XML parser external entities ko process karta hai jo XML input mein referenced hote hain.</p>
        <p class="en"><strong>File Disclosure:</strong> Attackers can read sensitive local files like /etc/passwd or configuration files.</p>
        <p class="hi" style="display:none;"><strong>File Exposure:</strong> Attackers sensitive local files jaise /etc/passwd ya configuration files read kar sakte hain.</p>
        <p class="en"><strong>SSRF Potential:</strong> Can be used to make HTTP requests to internal resources or external systems.</p>
        <p class="hi" style="display:none;"><strong>SSRF Sambhavna:</strong> Internal resources ya external systems par HTTP requests banane ke liye use kiya ja sakta hai.</p>
        <p class="en">If exploited, XXE can lead to sensitive data disclosure and internal network compromise.</p>
        <p class="hi" style="display:none;">Agar exploit kiya jaye, toh XXE sensitive data ki disclosure aur internal network compromise le sakta hai.</p>
      </div>

      <!-- XXE Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">How XXE Works - Visualization</h3>
        <h3 class="hi" style="display:none;">XXE Kaise Kaam Karta Hai - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 180px;">
            <div class="en">XML Input</div>
            <div class="hi" style="display:none;">XML Input</div>
            <div style="font-size: 0.8rem; margin-top: 10px;"><!ENTITY xxe SYSTEM "file:///etc/passwd"></div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 180px;">
            <div class="en">XML Parser</div>
            <div class="hi" style="display:none;">XML Parser</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Processes External Entities</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 180px;">
            <div class="en">File System</div>
            <div class="hi" style="display:none;">File System</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Returns File Contents</div>
          </div>
        </div>
        <p class="en">The vulnerable XML parser executes the external entity, allowing access to the file system and internal resources.</p>
        <p class="hi" style="display:none;">Kamzor XML parser external entity ko execute karta hai, jiski wajah se file system aur internal resources tak access mil jaata hai.</p>
      </div>

      <!-- XML Structure Explanation -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">XML Entity Structure Breakdown</h3>
        <h3 class="hi" style="display:none;">XML Entity Structure Ki Vistrit Jankari</h3>
        <div class="xml-code">
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
  <!ENTITY <span style="color: #00aaff;">internal</span> "<span style="color: #ff0080;">Hello World</span>">
  <!ENTITY <span style="color: #00ffff;">external</span> SYSTEM "<span style="color: #ffdd57;">file:///etc/passwd</span>">
]>
<root>&internal;&external;</root>
        </div>
        <ul style="margin: 15px 0 15px 30px;">
          <li class="en"><!DOCTYPE>: Defines document structure and entities</li>
          <li class="hi" style="display:none;"><!DOCTYPE>: Document structure aur entities define karta hai</li>
          <li class="en"><!ENTITY>: Declares entity references</li>
          <li class="hi" style="display:none;"><!ENTITY>: Entity references declare karta hai</li>
          <li class="en">SYSTEM: Indicates external resource reference</li>
          <li class="hi" style="display:none;">SYSTEM: External resource reference ko indicate karta hai</li>
          <li class="en">&entity;: References and expands the entity</li>
          <li class="hi" style="display:none;">&entity;: Entity ko reference aur expand karta hai</li>
        </ul>
      </div>

      <!-- Statistics -->
      <div class="stats-container animate-on-scroll">
        <div class="stat-box">
          <div class="stat-number">85%</div>
          <div class="stat-label en">of XXE vulnerabilities involve file disclosure</div>
          <div class="stat-label hi" style="display:none;">XXE kamjoriyon mein file disclosure shaamil hai</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">52+</div>
          <div class="stat-label en">User Flags on HackTheBox</div>
          <div class="stat-label hi" style="display:none;">HackTheBox par User Flags</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">CVE-2021</div>
          <div class="stat-label en">Recent XXE CVEs</div>
          <div class="stat-label hi" style="display:none;">Recent XXE CVEs</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Basic XXE -->
  <section id="try-basic">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Basic XXE</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Mool XXE</h2>

      <!-- Learning Path Progress -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Learning Path: Basic to Advanced</h3>
        <h3 class="hi" style="display:none;">Sikshna Marg: Mool Se Uchatam</h3>
        <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
          <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-green);">1</div>
            <div class="step-title en">Basic XXE</div>
            <div class="step-title hi" style="display:none;">Mool XXE</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--electric-blue);">2</div>
            <div class="step-title en">XXE to SSRF</div>
            <div class="step-title hi" style="display:none;">XXE to SSRF</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-orange);">3</div>
            <div class="step-title en">Blind XXE</div>
            <div class="step-title hi" style="display:none;">Andha XXE</div>
          </div>
        </div>
      </div>

      <!-- Basic XXE Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Level 1: Basic File Disclosure</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Level 1: Mool File Disclosure</h3>
        <p class="en">Inject XML external entities to read system files.</p>
        <p class="hi" style="display:none;">System files read karne ke liye XML external entities inject karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="xml-input" class="en">XML Payload:</label>
            <label for="xml-input" class="hi" style="display:none;">XML Payload:</label>
            <input type="text" id="xml-input" value='<!DOCTYPE root [<!ENTITY file SYSTEM "file:///etc/hostname">]><root>&file;</root>'>
          </div>
          <button class="button" onclick="runBasicXXEDemo()">Parse XML</button>
          <div class="result-box" id="xml-result">
// Try basic XXE payload
          </div>
        </div>
      </div>

      <!-- XXE to SSRF Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--electric-blue); margin-bottom: 15px;" class="en">Level 2: XXE to SSRF</h3>
        <h3 style="color: var(--electric-blue); margin-bottom: 15px; display:none;" class="hi">Level 2: XXE to SSRF</h3>
        <p class="en">Use XXE to make HTTP requests to internal resources.</p>
        <p class="hi" style="display:none;">Internal resources par HTTP requests banane ke liye XXE ka upyog karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="ssrf-input" class="en">SSRF Payload:</label>
            <label for="ssrf-input" class="hi" style="display:none;">SSRF Payload:</label>
            <input type="text" id="ssrf-input" value='<!DOCTYPE root [<!ENTITY ssrf SYSTEM "http://169.254.169.254/latest/meta-data/">]><root>&ssrf;</root>'>
          </div>
          <button class="button" onclick="runSSRFDemo()">Execute SSRF</button>
          <div class="result-box" id="ssrf-result">
// Try XXE to SSRF payload
          </div>
        </div>
      </div>

      <!-- Blind XXE Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-orange); margin-bottom: 15px;" class="en">Level 3: Blind XXE</h3>
        <h3 style="color: var(--neon-orange); margin-bottom: 15px; display:none;" class="hi">Level 3: Andha XXE</h3>
        <p class="en">When XML response is not shown, exfiltrate data through external requests.</p>
        <p class="hi" style="display:none;">Jab XML response nahi dikhaata, toh external requests ke through data exfiltrate karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="blind-input" class="en">File to Read:</label>
            <label for="blind-input" class="hi" style="display:none;">Read Karne Vala File:</label>
            <input type="text" id="blind-input" value="/etc/passwd">
          </div>
          <button class="button" onclick="runBlindDemo()">Try Blind XXE</button>
          <div class="result-box" id="blind-result">
// Data exfiltrated via external request
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Advanced XXE Techniques -->
  <section id="advanced">
    <div class="container">
      <h2 class="section-title en">Advanced XXE Techniques</h2>
      <h2 class="section-title hi" style="display:none;">Uchatam XXE Tarika</h2>

      <!-- Attack Vector Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">XXE Attack Vectors - Visualization</h3>
        <h3 class="hi" style="display:none;">XXE Hamlawar Ke Tarika - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Malicious XML</div>
            <div class="hi" style="display:none;">Dushit XML</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">&file;/etc/passwd</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Vulnerable Parser</div>
            <div class="hi" style="display:none;">Kamzor Parser</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Default Settings</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Data Exposure</div>
            <div class="hi" style="display:none;">Data Exposure</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">File Contents</div>
          </div>
        </div>
      </div>

      <!-- Advanced Bypass Techniques -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Advanced Bypass Techniques</h3>
        <h3 class="hi" style="display:none;">Uchatam Bypass Tarika</h3>

        <!-- DTD Inclusion Bypass -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. DTD Parameter Entity Bypass</h4>
          <p class="en">Use parameter entities to bypass restrictions.</p>
          <p class="hi" style="display:none;">Restrictions ko bypass karne ke liye parameter entities ka upyog karein.</p>
          <div class="xml-code">
Example:
<!DOCTYPE root [
  <!ENTITY % param "<!ENTITY file SYSTEM 'file:///etc/passwd'>">
  %param;
]>
<root>&file;</root>
          </div>
        </div>

        <!-- Encoding Bypass -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Encoding Bypass</h4>
          <p class="en">Use URL encoding to obfuscate XXE payloads.</p>
          <p class="hi" style="display:none;">XXE payloads ko obfuscate karne ke liye URL encoding ka upyog karein.</p>
          <div class="xml-code">
Example:
<!ENTITY file SYSTEM "file://%2fetc%2fpasswd">
          </div>
        </div>

        <!-- Base64 Encoding -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Base64 Encoding</h4>
          <p class="en">Encode file paths to bypass filename restrictions.</p>
          <p class="hi" style="display:none;">Filename restrictions ko bypass karne ke liye file paths ko encode karein.</p>
          <div class="xml-code">
Example:
<!DOCTYPE data [
  <!ENTITY file SYSTEM "data:text/plain;base64,PGZpbGU+L2V0Yy9wYXNzd2Q8L2ZpbGU+" >
]>
<data>&file;</data>
          </div>
        </div>
      </div>

      <!-- Real-World Case Studies -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Real-World XXE Cases</h3>
        <h3 class="hi" style="display:none;">Vastavik XXE Cases</h3>

        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--neon-green);">Case Study 1: Facebook XXE Vulnerability</h4>
          <p class="en"><strong>Impact:</strong> Could read any file on Facebook's servers including configuration files and source code.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Facebook ke servers par koi bhi file read kar sakta tha including configuration files aur source code.</p>
        </div>

        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--electric-blue);">Case Study 2: Shopify XXE</h4>
          <p class="en"><strong>Impact:</strong> Potential data exfiltration and AWS metadata access.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Data exfiltration aur AWS metadata access ka sambhav.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Advanced XXE -->
  <section id="try-advanced">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Advanced XXE</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Uchatam XXE</h2>
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Advanced Exploitation</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Uchatam Exploitation</h3>
        <p class="en">Try different XXE payloads to bypass filters and extract data.</p>
        <p class="hi" style="display:none;">Filters ko bypass karne aur data extract karne ke liye alag-alag XXE payloads ka prayog karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="advanced-input" class="en">Advanced XXE Payload:</label>
            <label for="advanced-input" class="hi" style="display:none;">Uchatam XXE Payload:</label>
            <input type="text" id="advanced-input" value='<!DOCTYPE r [%param;]><r>&e1;</r>'>
          </div>
          <button class="button" onclick="runAdvancedXXEDemo()">Execute</button>
          <div class="result-box" id="advanced-result">
// Try parameter entity payload
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Prevention -->
  <section id="prevention">
    <div class="container">
      <h2 class="section-title en">How to Prevent XXE</h2>
      <h2 class="section-title hi" style="display:none;">XXE Ko Kaise Rokein</h2>

      <!-- Prevention Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">XXE Prevention - Visualization</h3>
        <h3 class="hi" style="display:none;">XXE Bachav - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">User XML</div>
            <div class="hi" style="display:none;">User XML</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">External Entity</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Secure Parser</div>
            <div class="hi" style="display:none;">Secure Parser</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">External Entity Off</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Safe Processing</div>
            <div class="hi" style="display:none;">Surakshit Processing</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Blocked Attack</div>
          </div>
        </div>
      </div>

      <!-- Secure Coding Practices -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Secure Configurations</h3>
        <h3 class="hi" style="display:none;">Surakshit Configurations</h3>

        <!-- Disable External Entities -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Disable External Entities</h4>
          <p class="en">Set external-general-entities and external-parameter-entities to false.</p>
          <p class="hi" style="display:none;">External-general-entities aur external-parameter-entities ko false set karein.</p>
          <div class="xml-code">
// Java XML Parser
SAXParserFactory spf = SAXParserFactory.newInstance();
spf.setFeature("http://xml.org/sax/features/external-general-entities", false);
spf.setFeature("http://xml.org/sax/features/external-parameter-entities", false);
          </div>
        </div>

        <!-- Use Safe Parsers -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Use Safe Parsers</h4>
          <p class="en">Use libraries that don't support XXE by default.</p>
          <p class="hi" style="display:none;">Libraries ka upyog karein jo by default XXE support nahi karte.</p>
          <div class="xml-code">
// JSON instead of XML
// Or use secure XML libraries like Jackson XML with safe configuration
          </div>
        </div>

        <!-- Input Validation -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Input Validation</h4>
          <p class="en">Validate XML input against strict schemas.</p>
          <p class="hi" style="display:none;">XML input ko strict schemas ke against validate karein.</p>
          <div class="xml-code">
// XSD Schema validation
Validator validator = schema.newValidator();
validator.validate(new StreamSource(xmlFile));
          </div>
        </div>
      </div>

      <!-- Lab Environment Simulation -->
      <div class="interactive-demo animate-on-scroll">
        <h4 style="color: var(--neon-green);">XXE Protection Testing</h4>
        <div class="demo-container">
          <div class="input-group">
            <label for="test-input" class="en">Test XML Input:</label>
            <label for="test-input" class="hi" style="display:none;">Test XML Input:</label>
            <input type="text" id="test-input" value='<!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><root>&xxe;</root>'>
          </div>
          <button class="button" onclick="testXXEProtection()">Test Protection</button>
          <div class="result-box" id="protection-result">
// Results will appear here
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Quiz -->
  <section id="quiz">
    <div class="container">
      <h2 class="section-title en">Knowledge Check</h2>
      <h2 class="section-title hi" style="display:none;">Jaankari Ki Jaanch</h2>
      <div class="quiz-container animate-on-scroll">
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px;" class="en">Test Your XXE Knowledge</h3>
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px; display:none;" class="hi">Apni XXE Jaankari Ka Pariksha Karen</h3>
        <div id="quiz-questions">
          <!-- Questions will be injected here -->
        </div>
        <div class="score-display" id="score-display">Score: 0 / 10</div>
        <button class="button quiz-submit" onclick="submitQuiz()">Submit Quiz</button>

        <!-- Feedback Section -->
        <div id="feedback" class="feedback">
          <!-- Feedback will appear here -->
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <h3 class="en">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</h3>
      <h3 class="hi" style="display:none;">Ankush Rana Dwara | HTB Elite Hacker | Senior Security Engineer</h3>
      <p class="en">Breaking Systems. Building Defenses.</p>
      <p class="hi" style="display:none;">Systems todte hain. Defenses banate hain.</p>

      <div class="social-links">
        <a href="https://github.com/ankushrana6395" target="_blank" class="social-link github">
          <i class="fab fa-github"></i>
        </a>
        <a href="mailto:ankushrana6395@gmail.com" class="social-link email">
          <i class="fas fa-envelope"></i>
        </a>
        <a href="https://app.hackthebox.com/profile/117501" target="_blank" class="social-link htb">
          <i class="fas fa-cube"></i>
        </a>
      </div>

      <p style="margin-top: 30px;" class="en">&copy; 2025 Ankush Rana. All Rights Reserved.</p>
      <p style="margin-top: 30px; display:none;" class="hi">&copy; 2025 Ankush Rana. Sabhi Adhikar Sanchit Hai.</p>
    </div>
  </footer>

  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>    let isHinglish = false;




    // Safe DOM access functions
    function safeGetElementById(id) {
      return document.getElementById(id);
    }

    function safeGetElementsByClassName(className) {
      return document.getElementsByClassName(className) || [];
    }

    function safeQuerySelectorAll(selector) {
      try {
        return document.querySelectorAll(selector) || [];
      } catch (e) {
        return [];
      }
    }

    // Card Interaction Functions
    function highlightCard(card) {
      if (card && card.classList) {
        card.classList.add('pop-out');
        showNotification('Hovering: ' + card.querySelector('h3').textContent);
      }
    }

    function unhighlightCard(card) {
      if (card && card.classList && !card.classList.contains('focused')) {
        card.classList.remove('pop-out');
      }
    }

    function focusCard(card) {
      safeQuerySelectorAll('.lecture-card').forEach(c => {
        if (c && c.classList) {
          c.classList.remove('focused');
          c.classList.remove('pop-out');
        }
      });
      if (card && card.classList) {
        card.classList.add('focused');
        card.classList.add('pop-out');
        showNotification('Focused on: ' + card.querySelector('h3').textContent);
      }
    }

    // Initialize Three.js
    const canvas = safeGetElementById('three-canvas');
    if (canvas) {
      try {
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        // Grid
        const gridHelper = new THREE.GridHelper(100, 100, 0x00ff88, 0x003322);
        gridHelper.position.z = -20;
        scene.add(gridHelper);

        // Floating Points
        const geometry = new THREE.BufferGeometry();
        const count = 500;
        const positions = new Float32Array(count * 3);
        for (let i = 0; i < count * 3; i++) {
          positions[i] = (Math.random() - 0.5) * 100;
        }
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        const material = new THREE.PointsMaterial({ color: 0x00ff88, size: 0.5, transparent: true, opacity: 0.8 });
        const points = new THREE.Points(geometry, material);
        scene.add(points);

        // Add floating cubes
        const cubeGeometry = new THREE.BoxGeometry(2, 2, 2);
        const cubeMaterial = new THREE.MeshBasicMaterial({
          color: 0x00aaff,
          wireframe: true,
          transparent: true,
          opacity: 0.5
        });
        const cubes = [];
        for (let i = 0; i < 10; i++) {
          const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
          cube.position.x = (Math.random() - 0.5) * 50;
          cube.position.y = (Math.random() - 0.5) * 50;
          cube.position.z = (Math.random() - 0.5) * 50;
          cube.rotation.x = Math.random() * Math.PI;
          cube.rotation.y = Math.random() * Math.PI;
          cubes.push({ mesh: cube, speed: Math.random() * 0.02 });
          scene.add(cube);
        }

        camera.position.z = 30;

        // Animation
        function animate() {
          requestAnimationFrame(animate);
          gridHelper.rotation.y += 0.005;
          points.rotation.y += 0.003;
          cubes.forEach(cube => {
            cube.mesh.rotation.x += cube.speed;
            cube.mesh.rotation.y += cube.speed;
          });
          renderer.render(scene, camera);
        }
        animate();

        // Store renderer and camera globally for resize handler
        window.threeRenderer = renderer;
        window.threeCamera = camera;
      } catch (e) {
        console.warn('Three.js initialization failed:', e);
      }
    }

    // Resize
    window.addEventListener('resize', () => {
      if (window.threeRenderer && window.threeCamera) {
        window.threeCamera.aspect = window.innerWidth / window.innerHeight;
        window.threeCamera.updateProjectionMatrix();
        window.threeRenderer.setSize(window.innerWidth, window.innerHeight);
      }
    });

    // Keyword Modal
    const keywordModal = safeGetElementById('keyword-modal');
    const modalTitle = safeGetElementById('modal-title');
    const modalBody = safeGetElementById('modal-body');
    const modalClose = safeGetElementById('modal-close');
    const keywordElements = safeQuerySelectorAll('.keyword');

    if (keywordModal && modalTitle && modalBody) {
      keywordElements.forEach(keyword => {
        if (keyword && keyword.addEventListener) {
          keyword.addEventListener('click', function(e) {
            e.preventDefault && e.preventDefault();
            e.stopPropagation && e.stopPropagation();
            const title = this.getAttribute && this.getAttribute('data-title');
            const content = this.getAttribute && this.getAttribute('data-content');
            modalTitle.textContent = title;
            modalBody.textContent = content;
            keywordModal.classList && keywordModal.classList.add('active');
          });
        }
      });

      if (modalClose && modalClose.addEventListener) {
        modalClose.addEventListener('click', () => {
          keywordModal.classList && keywordModal.classList.remove('active');
        });
      }

      if (keywordModal.addEventListener) {
        keywordModal.addEventListener('click', (e) => {
          if (e.target === keywordModal) {
            keywordModal.classList && keywordModal.classList.remove('active');
          }
        });
      }
    }

    // Language Toggle
    const translatorBtn = safeGetElementById('translator-btn');
    function toggleLanguage() {
      if (translatorBtn) {
        isHinglish = !isHinglish;
        const enElements = safeQuerySelectorAll('.en');
        const hiElements = safeQuerySelectorAll('.hi');

        enElements.forEach(el => {
          if (el && el.style) {
            el.style.display = isHinglish ? 'none' : 'block';
          }
        });

        hiElements.forEach(el => {
          if (el && el.style) {
            el.style.display = isHinglish ? 'block' : 'none';
          }
        });

        if (translatorBtn.textContent !== undefined) {
          translatorBtn.textContent = isHinglish ? '🌐 English On' : '🌐 Hinglish On';
          showNotification(isHinglish ? 'Hinglish mode activated!' : 'English mode activated!');
        }
      }
    }

    // Quiz Questions
    const quizQuestions = [
      {
        question: {
          en: "What does XXE stand for?",
          hi: "XXE ka matlab kya hota hai?"
        },
        options: {
          en: [
            "XML External Entity",
            "XML Execution Engine",
            "XML XQuery Engine",
            "XML Encryption Extension"
          ],
          hi: [
            "XML External Entity",
            "XML Execution Engine",
            "XML XQuery Engine",
            "XML Encryption Extension"
          ]
        },
        correct: 0,
        explanation: {
          en: "XXE stands for XML External Entity, where attackers can read files via XML parsing.",
          hi: "XXE ka matlab XML External Entity hota hai, jahan attackers XML parsing ke through files read kar sakte hain।"
        }
      },
      {
        question: {
          en: "How is XXE typically exploited?",
          hi: "XXE typically kaise exploit hota hai?"
        },
        options: {
          en: [
            "Through SQL injection",
            "By manipulating XML entity declarations",
            "Via buffer overflow",
            "Using XSS payloads"
          ],
          hi: [
            "SQL injection ke through",
            "XML entity declarations ko manipulate karke",
            "Buffer overflow ke through",
            "XSS payloads ka upyog karke"
          ]
        },
        correct: 1,
        explanation: {
          en: "XXE is exploited by crafting malicious XML with entity declarations that reference external resources.",
          hi: "XXE exploit kiya jaata hai malicious XML banakar jo external resources ko reference karta hai।"
        }
      },
      {
        question: {
          en: "Which XML declaration contains XXE attack vectors?",
          hi: "Kon sa XML declaration XXE attack vectors contain karta hai?"
        },
        options: {
          en: [
            "<xml version>",
            "<!DOCTYPE>",
            "<xml-stylesheet>",
            "<xml encoding>"
          ],
          hi: [
            "<xml version>",
            "<!DOCTYPE>",
            "<xml-stylesheet>",
            "<xml encoding>"
          ]
        },
        correct: 1,
        explanation: {
          en: "The DOCTYPE declaration is used to define external entities in XML.",
          hi: "DOCTYPE declaration XML mein external entities define karne ke liye use kiya jaata hai।"
        }
      },
      {
        question: {
          en: "What can XXE be used for besides file disclosure?",
          hi: "File disclosure ke alawa XXE kya ke liye use kiya ja sakta hai?"
        },
        options: {
          en: [
            "Only file reading",
            "SSRF attacks to internal resources",
            "Database queries",
            "Authentication bypass"
          ],
          hi: [
            "Sirf file reading",
            "Internal resources par SSRF attacks",
            "Database queries",
            "Authentication bypass"
          ]
        },
        correct: 1,
        explanation: {
          en: "XXE can be chained with SSRF to access internal resources like AWS metadata.",
          hi: "XXE SSRF ke saath chain kar sakta hai internal resources jaise AWS metadata access karne ke liye।"
        }
      },
      {
        question: {
          en: "How can XXE be prevented?",
          hi: "XXE ko kaise prevent kiya ja sakta hai?"
        },
        options: {
          en: [
            "Add input validation only",
            "Disable external entity processing in parser",
            "Use HTTPS certificates",
            "Implement rate limiting"
          ],
          hi: [
            "Sirf input validation add karein",
            "Parser mein external entity processing disable kar dein",
            "HTTPS certificates ka upyog karein",
            "Rate limiting implement karein"
          ]
        },
        correct: 1,
        explanation: {
          en: "The most effective prevention is disabling external entity processing in XML parsers.",
          hi: "Sabse effective prevention XML parsers mein external entity processing disable karna hai।"
        }
      },
      {
        question: {
          en: "Which common file can be read using basic XXE?",
          hi: "Mool XXE ka upyog karke konsa common file read kiya ja sakta hai?"
        },
        options: {
          en: [
            "/var/log/apache2/access.log",
            "/etc/passwd",
            "/var/www/config.php",
            "/proc/version"
          ],
          hi: [
            "/var/log/apache2/access.log",
            "/etc/passwd",
            "/var/www/config.php",
            "/proc/version"
          ]
        },
        correct: 1,
        explanation: {
          en: "/etc/passwd is the most common file targeted in XXE attacks on Unix systems.",
          hi: "/etc/passwd Unix systems par XXE attacks mein sabse zyada target kiya jaata hai।"
        }
      },
      {
        question: {
          en: "What is the difference between internal and external entities in XXE?",
          hi: "XXE mein internal aur external entities mein kya difference hai?"
        },
        options: {
          en: [
            "Internal entities reference external resources",
            "External entities are defined in the document, internal reference external files",
            "Internal entities contain data within the document, external reference outside resources",
            "There is no difference"
          ],
          hi: [
            "Internal entities external resources ko reference karte hain",
            "External entities document mein defined hoti hain, internal external files ko reference karti hain",
            "Internal entities document mein data contain karti hain, external outside resources ko reference karti hain",
            "Koi difference nahi hai"
          ]
        },
        correct: 2,
        explanation: {
          en: "Internal entities contain data within the XML document, while external entities reference resources outside the document.",
          hi: "Internal entities XML document ke andar data contain karti hain, jabki external entities document ke bahar resources ko reference karti hain।"
        }
      },
      {
        question: {
          en: "What is parameter entity in XXE context?",
          hi: "XXE context mein parameter entity kya hota hai?"
        },
        options: {
          en: [
            "Entity that contains parameters",
            "Entity declared with % that can be referenced in DTD",
            "Entity used for URL parameters",
            "Entity that processes parameters automatically"
          ],
          hi: [
            "Entity jo parameters contain karta hai",
            "Entity jo % ke saath declare hota hai aur DTD mein reference kiya ja sakta hai",
            "Entity jo URL parameters ke liye use hota hai",
            "Entity jo automatically parameters process karta hai"
          ]
        },
        correct: 1,
        explanation: {
          en: "Parameter entities are declared with % and can be referenced within DTD declarations, often used in advanced XXE attacks.",
          hi: "Parameter entities % ke saath declare hoti hain aur DTD declarations ke andar reference ki ja sakti hain, aksar advanced XXE attacks mein use hoti hain।"
        }
      },
      {
        question: {
          en: "Which XML parser feature should be disabled to prevent XXE?",
          hi: "XXE ko prevent karne ke liye konsa XML parser feature disable karna chahiye?"
        },
        options: {
          en: [
            "external-general-entities",
            "internal-general-entities",
            "xml-validation",
            "namespace-processing"
          ],
          hi: [
            "external-general-entities",
            "internal-general-entities",
            "xml-validation",
            "namespace-processing"
          ]
        },
        correct: 0,
        explanation: {
          en: "external-general-entities and external-parameter-entities features should be disabled to prevent XXE.",
          hi: "XXE ko prevent karne ke liye external-general-entities aur external-parameter-entities features disable karne chahiye।"
        }
      },
      {
        question: {
          en: "What does the SYSTEM keyword indicate in XXE?",
          hi: "XXE mein SYSTEM keyword kya indicate karta hai?"
        },
        options: {
          en: [
            "Internal entity declaration",
            "External resource reference",
            "Entity processing system",
            "Security feature enabled"
          ],
          hi: [
            "Internal entity declaration",
            "External resource reference",
            "Entity processing system",
            "Security feature enabled"
          ]
        },
        correct: 1,
        explanation: {
          en: "SYSTEM indicates that the entity references an external resource (file or URL).",
          hi: "SYSTEM indicate karta hai ki entity ek external resource (file ya URL) ko reference karti hai।"
        }
      }
    ];

    // Render Quiz
    function renderQuiz() {
      const quizContainer = document.getElementById('quiz-questions');
      quizContainer.innerHTML = '';
      quizQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'quiz-question';
        const qText = isHinglish ? q.question.hi : q.question.en;
        const opts = isHinglish ? q.options.hi : q.options.en;
        questionDiv.innerHTML = `
          <h4>Q${index + 1}: ${qText}</h4>
          <div class="options" id="options-${index}">
            ${opts.map((opt, i) => `
              <div class="option" onclick="selectOption(${index}, ${i})">${opt}</div>
            `).join('')}
          </div>
        `;
        quizContainer.appendChild(questionDiv);
      });
    }

    // Track selected answers
    const selectedAnswers = new Array(quizQuestions.length).fill(-1);

    // Select Option
    window.selectOption = function(questionIndex, optionIndex) {
      document.querySelectorAll(`#options-${questionIndex} .option`).forEach(opt => {
        opt.classList.remove('selected');
      });
      document.querySelectorAll(`#options-${questionIndex} .option`)[optionIndex].classList.add('selected');
      selectedAnswers[questionIndex] = optionIndex;
    };

    // Submit Quiz
    window.submitQuiz = function() {
      let score = 0;
      const feedback = document.getElementById('feedback');
      feedback.innerHTML = '';
      feedback.style.display = 'block';

      quizQuestions.forEach((q, index) => {
        const options = document.querySelectorAll(`#options-${index} .option`);
        const explanation = isHinglish ? q.explanation.hi : q.explanation.en;

        if (selectedAnswers[index] === q.correct) {
          score++;
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1) options[selectedAnswers[index]].classList.add('correct');
        } else {
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1 && selectedAnswers[index] !== q.correct) {
            options[selectedAnswers[index]].classList.add('incorrect');
          }
        }

        feedback.innerHTML += `<strong>Q${index + 1}:</strong> ${explanation}<br><br>`;
      });

      document.getElementById('score-display').textContent = `Score: ${score} / ${quizQuestions.length}`;
      showNotification(isHinglish ? `Quiz pura! Score: ${score}/${quizQuestions.length}` : `Quiz complete! You scored ${score}/${quizQuestions.length}`);
    };

    // Notification
    function showNotification(message) {
      const notification = document.getElementById('notification');
      const notificationText = document.getElementById('notification-text');
      notificationText.textContent = message;
      notification.classList.add('show');
      setTimeout(() => notification.classList.remove('show'), 3000);
    }

    // Scroll Progress Bar
    window.addEventListener('scroll', () => {
      const progressBar = document.getElementById('progress-bar');
      if (progressBar && progressBar.style) {
        const winHeight = window.innerHeight;
        const docHeight = document.documentElement.scrollHeight;
        const scrollTop = window.pageYOffset;
        const trackLength = docHeight - winHeight;
        const progress = scrollTop / trackLength * 100;
        progressBar.style.width = progress + '%';
      }
    });

    // Animation on Scroll
    document.addEventListener('DOMContentLoaded', () => {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) entry.target.classList.add('visible');
        });
      }, { threshold: 0.1 });
      document.querySelectorAll('.animate-on-scroll').forEach(el => observer.observe(el));
      renderQuiz();
    });

    // XXE Demo Functions
    function runBasicXXEDemo() {
      const payload = document.getElementById('xml-input').value;
      const result = document.getElementById('xml-result');

      if (payload.includes('SYSTEM "file://')) {
        result.innerHTML = `<span style="color: #00ff88">✓ Basic XXE successful!</span>
Extracted /etc/hostname:
debian

Query executed: ${payload}`;
      } else {
        result.innerHTML = `<span style="color: #ff8800">✗ Invalid XXE payload</span>
Include SYSTEM and file://`;
      }
    }

    function runSSRFDemo() {
      const payload = document.getElementById('ssrf-input').value;
      const result = document.getElementById('ssrf-result');

      if (payload.includes('169.254.169.254')) {
        result.innerHTML = `<span style="color: #00ff88">✓ SSRF successful via XXE!</span>
AWS Metadata accessed:
ami-id: ami-12345678
instance-type: t2.micro
security-groups: sg-12345

Query executed: ${payload}`;
      } else {
        result.innerHTML = `<span style="color: #ff8800">✗ Invalid SSRF payload</span>
Use internal IP like 169.254.169.254`;
      }
    }

    function runBlindDemo() {
      const file = document.getElementById('blind-input').value;
      const result = document.getElementById('blind-result');

      if (file === '/etc/passwd') {
        result.innerHTML = `<span style="color: #00ff88">✓ Data exfiltrated via out-of-band!</span>
Contents of ${file} sent to attacker's server:
root:x:0:0:root:/root:/bin/bash
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin`;
      } else {
        result.innerHTML = `<span style="color: #ff8800">✗ File not accessible or doesn't exist</span>`;
      }
    }

    function runAdvancedXXEDemo() {
      const payload = document.getElementById('advanced-input').value;
      const result = document.getElementById('advanced-result');

      if (payload.includes('%param;') || payload.includes('external-parameter-entities')) {
        result.innerHTML = `<span style="color: #00ff88">✓ Advanced XXE successful!</span>
Parameter entity bypassed restrictions:
Extracted data: secret_api_key = sk-123456789ABCDEFGHIJKL

Query executed: ${payload}`;
      } else {
        result.innerHTML = `<span style="color: #ff8800">✗ Invalid advanced payload</span>
Try parameter entities or DTD injection`;
      }
    }

    function testXXEProtection() {
      const testInput = document.getElementById('test-input').value;
      const result = document.getElementById('protection-result');

      if (testInput.includes('SYSTEM') && testInput.includes('file://')) {
        result.innerHTML = `<span style="color: #ff8800">❌ XXE attack vector detected</span>
Recommendation: Disable external entity processing in XML parser`;
      } else {
        result.innerHTML = `<span style="color: #00ff88">✅ Input appears safe</span>
No XXE patterns detected`;
      }
    }

  </script>
</body>
</html>
