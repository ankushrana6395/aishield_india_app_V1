<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Interactive Web Cache Poisoning Masterclass with Live Hinglish Translation | Quiz | Try It Yourself | By HTB Elite Hacker">
  <title>Web Cache Poisoning | By Ankush Rana</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;600;700;900&family=Roboto:wght@300;400;500;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --primary: #0a1121;
      --dark-navy: #0b1b30;
      --neon-green: #00ff88;
      --electric-blue: #00aaff;
      --neon-orange: #ff8800;
      --neon-pink: #ff0080;
      --glow-green: rgba(0, 255, 136, 0.3);
      --glow-blue: rgba(0, 170, 255, 0.2);
      --glow-pink: rgba(255, 0, 128, 0.3);
      --light-gray: #e0e0e0;
      --mid-gray: #aaaaaa;
      --card-bg: #111c30;
      --border: #2a4060;
      --keyword: #ffdd57;
      --keyword-bg: rgba(255, 221, 87, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--primary);
      color: var(--light-gray);
      line-height: 1.7;
      overflow-x: hidden;
    }

    /* Three.js Background */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Translator Button */
    .translator-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 0 15px var(--glow-green);
      transition: all 0.3s ease;
    }

    .translator-btn:hover {
      transform: translateY(-2px);
      background: #00cc6d;
    }

    /* Header / Hero */
    header {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-content {
      z-index: 2;
      max-width: 900px;
      position: relative;
    }

    .hero-content h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2.8rem, 8vw, 4rem);
      color: white;
      margin-bottom: 10px;
      text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
      50% { text-shadow: 0 0 25px rgba(0, 255, 136, 0.9), 0 0 35px rgba(0, 255, 136, 0.5); }
      100% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
    }

    .hero-content h1 span {
      color: var(--neon-green);
    }

    .subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: clamp(1.2rem, 3.5vw, 1.5rem);
      color: var(--electric-blue);
      margin: 15px 0;
    }

    /* Section Styling */
    section {
      padding: 100px 0;
      position: relative;
    }

    .section-title {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2rem, 5vw, 2.5rem);
      color: var(--neon-green);
      margin-bottom: 50px;
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -8px;
      width: 70px;
      height: 4px;
      background: var(--electric-blue);
      animation: expand 2s infinite;
    }

    @keyframes expand {
      0% { width: 70px; }
      50% { width: 100px; }
      100% { width: 70px; }
    }

    /* Lecture Card */
    .lecture-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .lecture-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 136, 0.05), transparent);
      z-index: 0;
    }

    .lecture-card.pop-out {
      transform: translateY(-20px) scale(1.05);
      box-shadow:
        0 30px 60px rgba(0, 0, 0, 0.5),
        0 0 50px var(--glow-green);
      border-color: var(--neon-green);
      z-index: 5;
    }

    .lecture-card.focused {
      transform: translateY(-20px) scale(1.06);
      box-shadow:
        0 40px 80px rgba(0, 0, 0, 0.6),
        0 0 70px var(--glow-green);
      filter: brightness(1.1);
    }

    .lecture-card h3 {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 18px;
      font-size: 1.8rem;
      position: relative;
      z-index: 2;
    }

    /* Keyword Style */
    .keyword {
      background: var(--keyword-bg);
      color: var(--keyword);
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 1px dashed var(--keyword);
      position: relative;
      transition: all 0.3s ease;
      z-index: 2;
    }

    .keyword:hover {
      background: rgba(255, 221, 87, 0.3);
      box-shadow: 0 0 12px rgba(255, 221, 87, 0.4);
    }

    /* Tooltip (Modal) */
    .keyword-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 17, 33, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .keyword-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border: 2px solid var(--neon-green);
      border-radius: 14px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 50px var(--glow-green);
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .keyword-modal.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--neon-green);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-title {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .modal-body {
      color: var(--light-gray);
      line-height: 1.6;
    }

    /* Interactive Demo */
    .interactive-demo {
      background: rgba(0, 20, 40, 0.6);
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      border: 1px solid var(--electric-blue);
    }

    .demo-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .input-group label {
      min-width: 120px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--neon-green);
    }

    .input-group input {
      flex: 1;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: white;
      font-family: 'JetBrains Mono', monospace;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--neon-green);
      box-shadow: 0 0 10px var(--glow-green);
    }

    .button {
      padding: 12px 24px;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 4px;
      font-family: 'Orbitron', sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: fit-content;
    }

    .button:hover {
      background: #00cc6d;
      box-shadow: 0 0 15px var(--glow-green);
      transform: translateY(-2px);
    }

    .result-box {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 6px;
      padding: 15px;
      margin-top: 15px;
      border-left: 3px solid var(--neon-green);
      font-family: 'JetBrains Mono', monospace;
      min-height: 100px;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    /* Diagram */
    .diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }

    .box {
      min-width: 140px;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      font-weight: bold;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }

    .box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
    }

    .box:hover::before {
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }

    .user-input { background: #8b0000; color: white; }
    .app { background: #003366; color: white; }
    .db { background: #004d00; color: #00ff88; }

    .arrow {
      font-size: 1.8rem;
      color: var(--neon-green);
      position: relative;
    }

    .arrow::before {
      content: '→';
      animation: arrow-pulse 1.5s infinite;
    }

    @keyframes arrow-pulse {
      0% { text-shadow: 0 0 5px var(--neon-green); }
      50% { text-shadow: 0 0 15px var(--neon-green); }
      100% { text-shadow: 0 0 5px var(--neon-green); }
    }

    /* Code Block */
    .code-block {
      background: #001a1a;
      color: #00ff88;
      font-family: 'JetBrains Mono', monospace;
      padding: 15px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 15px 0;
      border-left: 4px solid var(--neon-green);
      position: relative;
    }

    .code-block::before {
      content: 'CODE';
      position: absolute;
      top: 0;
      right: 0;
      background: var(--neon-green);
      color: var(--primary);
      font-size: 0.7rem;
      padding: 2px 8px;
      border-bottom-left-radius: 4px;
      font-weight: bold;
    }

    /* Statistics Section */
    .stats-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin: 30px 0;
    }

    .stat-box {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
      min-width: 200px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      border-color: var(--neon-green);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .stat-label {
      color: var(--mid-gray);
      font-size: 0.9rem;
    }

    /* Quiz Section */
    .quiz-container {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .quiz-question {
      margin-bottom: 20px;
    }

    .quiz-question h4 {
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      background: rgba(0, 255, 136, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
    }

    .option.selected {
      background: var(--neon-green);
      color: var(--primary);
      font-weight: bold;
    }

    .score-display {
      text-align: center;
      font-size: 1.5rem;
      margin: 20px 0;
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
    }

    .button.quiz-submit {
      background: var(--neon-orange);
      color: white;
    }

    .button.quiz-submit:hover {
      background: #cc7000;
    }

    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: transparent;
      z-index: 1000;
    }

    .progress-bar {
      height: 100%;
      background: var(--neon-green);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Notification */
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--neon-green);
      border-radius: 8px;
      padding: 15px;
      color: var(--light-gray);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 60px 0;
      background: var(--dark-navy);
      color: var(--mid-gray);
      position: relative;
      overflow: hidden;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--neon-green), var(--electric-blue), var(--neon-pink));
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .social-link.github:hover { background: var(--neon-green); color: var(--primary); }
    .social-link.email:hover { background: var(--electric-blue); }
    .social-link.htb:hover { background: var(--neon-orange); }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-content h1 { font-size: 2.8rem; }
      .section-title { font-size: 1.8rem; }
      .diagram { flex-direction: column; }
      .arrow::before { content: '↓'; }
      .input-group { flex-direction: column; }
      .input-group label { min-width: auto; }
    }
  </style>
</head>
<body>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <!-- Translator Button -->
  <button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="right: auto; left: 20px;">
    🌐 Hinglish On
  </button>

  <!-- Keyword Modal -->
  <div class="keyword-modal" id="keyword-modal">
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h3 class="modal-title" id="modal-title">Keyword</h3>
      <div class="modal-body" id="modal-body">Definition will appear here.</div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i> <span id="notification-text">Welcome to the Web Cache Poisoning Masterclass!</span>
  </div>

  <!-- Three.js Background Canvas -->
  <canvas id="three-canvas"></canvas>

  <!-- Header / Hero -->
  <header id="home">
    <div class="container">
      <div class="hero-content"><!-- English Version -->
        <div class="en">
          <h1>Web Cache <span>Poisoning</span></h1>
          <div class="subtitle">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</div>
          <p>A deep dive into web cache poisoning attacks, CDN exploitation, header manipulation, and real-world cache busting techniques — with interactive demos and elite-level insights.</p>
        </div>

        <!-- Hinglish Version -->
        <div class="hi" style="display:none;">
          <h1>Web Cache <span>Poisoning</span></h1>
          <div class="subtitle">Ankush Rana द्वारा | HTB Elite Hacker | Senior Security Engineer</div>
          <p>Web cache poisoning attacks, CDN exploitation, header manipulation, aur real-world cache busting tarikon mein gahrai se jaane — interactive demos aur elite-level samajh ke saath.</p>
        </div>

        <!-- HTB & Bug Bounty Credibility -->
        <div style="margin-top: 40px; display: flex; align-items: center; gap: 25px; flex-wrap: wrap; justify-content: center; font-family: 'JetBrains Mono', monospace;">
          <img src="https://www.hackthebox.com/storage/achievements/elite_2024_badge.svg" alt="HTB Elite" style="width: 90px; filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
          <div style="text-align: center;">
            <img src="https://via.placeholder.com/100/0a1121/00ff88?text=AR" alt="Ankush Rana" style="width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--neon-green); filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
            <p style="margin: 5px 0 0; color: var(--neon-green);">52+ User Flags</p>
            <p style="margin: 0; color: var(--electric-blue);">47+ Root Owned</p>
          </div>
          <div style="text-align: center;">
            <p style="color: var(--neon-orange);">🏆 Top 10 India</p>
            <p style="color: var(--neon-pink);">💼 Sattrix | GPSSI</p>
          </div>
        </div>

        <!-- Call to Action -->
        <div style="margin-top: 30px; font-family: 'Orbitron', sans-serif; color: var(--electric-blue);">
          <i class="fas fa-mouse-pointer"></i> Toggle Hinglish Mode → <strong>Top Right Corner</strong>
        <div style="display: flex; justify-content: center; margin-top: 10px;"><button class="translator-btn" id="hero-translator-btn" onclick="toggleLanguage()" style="position: relative; margin: 0 auto;">🌐 Hinglish On</button></div>
        </div>
      </div>
    </div>
  </header>

  <!-- Section: What is Web Cache Poisoning? -->
  <section id="basics">
    <div class="container">
      <h2 class="section-title en">What is Web Cache Poisoning?</h2>
      <h2 class="section-title hi" style="display:none;">Web Cache Poisoning Kya Hai?</h2>

      <!-- Progress Tracker -->
      <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
        <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-green);">1</div>
          <div class="step-title en">Basic Concepts</div>
          <div class="step-title hi" style="display:none;">Mool Baat</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--electric-blue);">2</div>
          <div class="step-title en">Attack Vectors</div>
          <div class="step-title hi" style="display:none;">Hamlawar Ke Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-orange);">3</div>
          <div class="step-title en">Advanced Techniques</div>
          <div class="step-title hi" style="display:none;">Uchatam Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 0, 128, 0.1); border: 1px solid var(--neon-pink); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-pink);">4</div>
          <div class="step-title en">Prevention</div>
          <div class="step-title hi" style="display:none;">Bachav</div>
        </div>
      </div>

      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Understanding Web Cache Poisoning</h3>
        <h3 class="hi" style="display:none;">Web Cache Poisoning Ki Samajh</h3>
        <p class="en">Web cache poisoning is an advanced attack that exploits cache mechanisms to serve malicious content to other users. When successful, it allows an attacker to modify cached responses and affect multiple users simultaneously.</p>
        <p class="hi" style="display:none;">Web cache poisoning ek uchatam attack hai jo cache yantron ka faida uthakar doosre upyogkartiyon ko dushit content serve karta hai. Jab yeh successful hota hai, toh attacker cached responses ko modify kar sakta hai aur ek saath kai upyogkartiyon ko prabhavit kar sakta hai.</p>
        <p class="en"><strong>Real Analogy:</strong> Like poisoning a shared water supply system. Instead of affecting one person, the poison contaminates the entire water source, affecting everyone who drinks from it.</p>
        <p class="hi" style="display:none;"><strong>Asli Example:</strong> Ek shared water supply system ko poison karne ke jaise. Ek vyakti ko prabhavit karne ke bajaye, poison pure water source ko contaminate kar deta hai, jis se jo bhi us se pani piyega woh prabhavit ho jata hai.</p>
        <p class="en">Web cache poisoning is particularly dangerous because it can persist malware, deface websites, or redirect traffic indefinitely until the cache is flushed.</p>
        <p class="hi" style="display:none;">Web cache poisoning bahut khatar naak hai kyunki yeh malware ki persist karta hai, websites ko deface karta hai, ya traffic ko indefinitely redirect kar deta hai jab tak cache flush nahi ho jata.</p>
        <p class="en"><span class="keyword" data-title="Cache Poisoning" data-content="An attack that injects malicious content into cache mechanisms to serve harmful responses to other users.">Cache Poisoning</span> can lead to widespread compromise if the malicious content includes scripts or DOM-based attacks.</p>
        <p class="hi" style="display:none;"><span class="keyword" data-title="Cache Poisoning" data-content="Ek attack jo cache mechanisms mein malicious content inject karta hai taaki doosre users ko harmful responses serve kar sakein.">Cache Poisoning</span> ke phal se widespread compromise ho sakta hai agar malicious content mein scripts ya DOM-based attacks shamil ho.</p>
      </div>

      <!-- Cache Working Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">How Cache Poisoning Works - Visualization</h3>
        <h3 class="hi" style="display:none;">Cache Poisoning Kaise Kaam Karta Hai - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 180px;">
            <div class="en">Attacker Request</div>
            <div class="hi" style="display:none;">Attacker Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">X-Host: evil.com</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 180px;">
            <div class="en">Cache Server</div>
            <div class="hi" style="display:none;">Cache Server</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Stores Poisoned Response</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 180px;">
            <div class="en">Victim Users</div>
            <div class="hi" style="display:none;">Victim Users</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Serve Poisoned Content</div>
          </div>
        </div>
        <p class="en">The cache server receives a malicious request from the attacker. If the cache key is constructed improperly, it stores the poisoned response and serves it to subsequent legitimate users.</p>
        <p class="hi" style="display:none;">Cache server attacker se malicious request receive karta hai. Agar cache key galat tareeke se construct kiya gaya hai, toh yeh poisoned response store kar deta hai aur subsequent legitimate users ko serve kar deta hai.</p>
      </div>

      <!-- Types of Cache Poisoning -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Types of Web Cache Poisoning Attacks</h3>
        <h3 class="hi" style="display:none;">Web Cache Poisoning Attacks Ke Prakar</h3>
        <ul style="margin: 15px 0 15px 30px;">
          <li class="en"><span class="keyword" data-title="Header-Based Poisoning" data-content="Injecting malicious headers to manipulate cache behavior and response content.">Header-Based Poisoning</span>: Using unconventional headers to inject XSS, redirect responses</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Header-Based Poisoning" data-content="Cache behavior aur response content ko manipulate karne ke liye malicious headers inject karna.">Header-Based Poisoning</span>: Unconventional headers ka upyog XSS inject karne aur responses redirect karne ke liye</li>
          <li class="en"><span class="keyword" data-title="Parameter-Based Poisoning" data-content="Using request parameters to inject malicious content that gets cached and served to other users.">Parameter-Based Poisoning</span>: Request parameters to inject malicious content that's cached</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Parameter-Based Poisoning" data-content="Doosre users ko send kiye jane wale malicious content ko inject karne ke liye request parameters ka upyog jo cache ho jata hai.">Parameter-Based Poisoning</span>: Request parameters jo malicious content inject karta hai aur cache ho jata hai</li>
          <li class="en"><span class="keyword" data-title="FAT GET Poisoning" data-content="Exploiting cache key construction to poison responses without traditional cache flushing techniques.">FAT GET Poisoning</span>: Exploiting abnormal cache key construction techniques</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="FAT GET Poisoning" data-content="Traditional cache flushing techniques ke bina responses ko poison karne ke liye abnormal cache key construction techniques ka faida uthana.">FAT GET Poisoning</span>: Abnormal cache key construction techniques ka faida uthana</li>
        </ul>
      </div>

      <!-- Statistics -->
      <div class="stats-container animate-on-scroll">
        <div class="stat-box">
          <div class="stat-number en">High</div>
          <div class="stat-number hi" style="display:none;">Uchatam</div>
          <div class="stat-label en">severity rating</div>
          <div class="stat-label hi" style="display:none;">khatre ka level</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">50+</div>
          <div class="stat-label en">User Flags on HackTheBox</div>
          <div class="stat-label hi" style="display:none;">HackTheBox par User Flags</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">$15K+</div>
          <div class="stat-label en">in bug bounty rewards</div>
          <div class="stat-label hi" style="display:none;">bug bounty mein kamai</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Cache Poisoning -->
  <section id="try-poison">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Cache Poisoning Exploitation</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Cache Poisoning Doharpan</h2>

      <!-- Learning Path Progress -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Learning Path: Basic to Advanced</h3>
        <h3 class="hi" style="display:none;">Sikshna Marg: Mool Se Uchatam</h3>
        <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
          <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-green);">1</div>
            <div class="step-title en">Basic Headers</div>
            <div class="step-title hi" style="display:none;">Mool Headers</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--electric-blue);">2</div>
            <div class="step-title en">Parameter Injection</div>
            <div class="step-title hi" style="display:none;">Parameter Injection</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-orange);">3</div>
            <div class="step-title en">Advanced FAT GET</div>
            <div class="step-title hi" style="display:none;">Uchatam FAT GET</div>
          </div>
        </div>
      </div>

      <!-- Basic Header Poisoning Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Level 1: Basic Header Injection</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Level 1: Mool Header Injection</h3>
        <p class="en">Test different headers to see how cache servers handle them.</p>
        <p class="hi" style="display:none;">Dhoondhein ki cache servers unko kaise handle karte hain - alag-alag headers test karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="header-input" class="en">Header:</label>
            <label for="header-input" class="hi" style="display:none;">Header:</label>
            <input type="text" id="header-input" value="X-Forwarded-Host: evil.com">
          </div>
          <button class="button" onclick="runHeaderPoisoning()">Test Poisoning</button>
          <div class="result-box" id="header-result">
// Try injecting malicious headers
          </div>
        </div>
      </div>

      <!-- Parameter Poisoning Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--electric-blue); margin-bottom: 15px;" class="en">Level 2: Parameter-Based Poisoning</h3>
        <h3 style="color: var(--electric-blue); margin-bottom: 15px; display:none;" class="hi">Level 2: Parameter-Based Poisoning</h3>
        <p class="en">Inject parameters that get reflected in cached responses.</p>
        <p class="hi" style="display:none;">Parameters inject karein jo cached responses mein reflect hote hain.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="param-input" class="en">URL with Parameter:</label>
            <label for="param-input" class="hi" style="display:none;">Parameter waale URL:</label>
            <input type="text" id="param-input" value="https://example.com/?cb=<script>alert(1)</script>">
          </div>
          <div class="code-block">
// Example porous parameters:
// ?page=
// ?search=
// ?lang=
// ?theme=
          </div>
        </div>
      </div>

      <!-- FAT GET Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-orange); margin-bottom: 15px;" class="en">Level 3: FAT GET Poisoning</h3>
        <h3 style="color: var(--neon-orange); margin-bottom: 15px; display:none;" class="hi">Level 3: FAT GET Poisoning</h3>
        <p class="en">Use FAT GET techniques to poison JSON responses.</p>
        <p class="hi" style="display:none;">JSON responses ko poison karne ke liye FAT GET techniques ka upyog karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="fat-input" class="en">FAT GET Payload:</label>
            <label for="fat-input" class="hi" style="display:none;">FAT GET Payload:</label>
            <input type="text" id="fat-input" value='{"test": "value", "test": "<script>alert(1)</script>", "__proto__.__proto__.toString": "xss"}'>
          </div>
          <div class="code-block">
// FAT GET uses duplicated keys in JSON:
// {"id": 123, "id": "<script>alert(1)</script>"}
// This exploits cache key normalization bugs
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Attack Techniques -->
  <section id="techniques">
    <div class="container">
      <h2 class="section-title en">Attack Techniques & Exploitation Methods</h2>
      <h2 class="section-title hi" style="display:none;">Hamlawar Tarika Aur Doharpan Methods</h2>

      <!-- Attack Vector Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Cache Poisoning Attack Vectors - Visualization</h3>
        <h3 class="hi" style="display:none;">Cache Poisoning Hamlawar Vectors - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Attacker Injection</div>
            <div class="hi" style="display:none;">Attacker Injection</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Malicious Headers/Params</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Cache Storage</div>
            <div class="hi" style="display:none;">Cache Storage</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Poisoned Entry</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Mass Distribution</div>
            <div class="hi" style="display:none;">Mass Distribution</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Serves to All Users</div>
          </div>
        </div>
      </div>

      <!-- Detailed Techniques -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Advanced Exploitation Techniques</h3>
        <h3 class="hi" style="display:none;">Uchatam Doharpan Tarika</h3>

        <!-- Unkeyed Headers -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Unkeyed Request Headers</h4>
          <p class="en">Headers that aren't included in cache key generation can be exploited to poison responses.</p>
          <p class="hi" style="display:none;">Headers jo cache key generation mein include nahi hote woh responses ko poison karne ke liye exploit kiye ja sakte hain.</p>
          <div class="code-block">
// Common unkeyed headers:
X-Forwarded-Host: attacker.com
X-Rewrite-URL: /admin
X-Host: evil.example.com
User-Agent: Mozilla/5.0
Referer: https://evil.com
          </div>
        </div>

        <!-- Parameter Pollution -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Parameter Pollution & Cache Bypasses</h4>
          <p class="en">Different backends process parameters differently, leading to cache inconsistencies.</p>
          <p class="hi" style="display:none;">Alag-alag backends parameters ko alag tarikon se process karte hain, jis se cache inconsistencies hoti hain.</p>
          <div class="code-block">
// Parameter pollution examples:
GET /?lang=en&lang=<script>alert(1)</script>
// Or query parameter pollution
GET /?utm_source=x&utm_source=<script>alert(1)</script>
// CDN vs origin differences
          </div>
        </div>

        <!-- Cache Buster Manipulation -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Cache Busting Techniques</h4>
          <p class="en">Find ways to invalidate cache entries or force cache misses for specific resources.</p>
          <p class="hi" style="display:none;">Cache entries ko invalidate karne ya specific resources ke liye cache misses force karne ke tarike dhoondhein.</p>
          <div class="code-block">
// Cache busting methods:
GET /style.css?cb=1
// Add random parameters
GET /api/v1/user/123?_t=123456789
// Use cache buster headers
Pragma: no-cache
Cache-Control: no-cache
// Path variations
GET /api/user/123//.json
GET /api/user/123/././.json
          </div>
        </div>

        <!-- JSON Dieseal Attacks -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. PIE Technique (Parameter Injection Exploitation)</h4>
          <p class="en">Exploit protes in how parameters can be reflected in different output contexts.</p>
          <p class="hi" style="display:none;">Explore kijiye ki parameters kaise alag-alag output contexts mein reflect hote hain.</p>
          <div class="code-block">
// PIE technique examples:
GET /?url=https://evil.com
// In JSON context
GET /?callback=<script>alert(1)</script>
// In HTML attributes
GET /?src=javascript:alert(1)
// In inline CSS
GET /?color=red;background:url(javascript:alert(1))
          </div>
        </div>
      </div>

      <!-- Real-World Case Studies -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Real-World Cache Poisoning Incidents</h3>
        <h3 class="hi" style="display:none;">Vastavik Duniya Ke Cache Poisoning Cases</h3>

        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--neon-green);">Case Study: Laravel Framework Vulnerability</h4>
          <p class="en"><strong>Issue:</strong> Laravel's route caching mechanism allowed poisoning cache with 404 responses.</p>
          <p class="hi" style="display:none;"><strong>Mamla:</strong> Laravel ke route caching mechanism ne 404 responses ke saath cache ko poison karne ki anumati di.</p>
          <p class="en"><strong>Impact:</strong> Attackers could cache 404 pages for legitimate routes, effectively DoSing the site.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Attackers legitimate routes ke liye 404 pages cache kar sakte the, effectively site ko DoS karte hue.</p>
        </div>

        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--electric-blue);">Case Study: Server-Side Template Injection via Cache</h4>
          <p class="en"><strong>Issue:</strong> SSTI payloads were cached and served to other users through cached templates.</p>
          <p class="hi" style="display:none;"><strong>Mamla:</strong> SSTI payloads cache kiye gaye the aur cached templates ke zariye doosre users ko serve kiye gaye.</p>
          <p class="en"><strong>Impact:</strong> Remote code execution affecting thousands of users simultaneously.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Remote code execution jo thousands of users par ek saath prabhav phellaya.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Prevention -->
  <section id="prevention">
    <div class="container">
      <h2 class="section-title en">How to Prevent Cache Poisoning Attacks</h2>
      <h2 class="section-title hi" style="display:none;">Cache Poisoning Attacks Ko Kaise Rokein</h2>

      <!-- Prevention Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Web Cache Poisoning Prevention - Visualization</h3>
        <h3 class="hi" style="display:none;">Web Cache Poisoning Bachav - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Malicious Request</div>
            <div class="hi" style="display:none;">Dushit Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">X-Host: evil.com</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Validation Layer</div>
            <div class="hi" style="display:none;">Validation Layer</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Input Sanitization</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Safe Response</div>
            <div class="hi" style="display:none;">Surakshit Response</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Clean Content</div>
          </div>
        </div>
      </div>

      <!-- Secure Implementation Practices -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Secure Cache Implementation Practices</h3>
        <h3 class="hi" style="display:none;">Surakshit Cache Implementation Abhyas</h3>

        <!-- Cache Key Design -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Proper Cache Key Construction</h4>
          <p class="en">Design cache keys that include all relevant request characteristics to prevent poisoning.</p>
          <p class="hi" style="display:none;">Cache keys design karein jo sabhi relevant request characteristics ko include rakhein taaki poisoning prevent ho sake.</p>
          <div class="code-block">
// Good cache key design:
const cacheKey = `${method}:${url}:${queryString}:${importantHeaders}`;
// Include:
GET   // HTTP method
/path  // Request path
?a=1&b=2  // Query parameters
Host, User-Agent, Accept-Language  // Important headers
//
DON'T include arbitrary user-controlled headers
          </div>
        </div>

        <!-- Input Validation -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Comprehensive Input Validation</h4>
          <p class="en">Validate all inputs that could affect cached content or be reflected in responses.</p>
          <p class="hi" style="display:none;">Sabhi inputs ki validation karein jo cached content ko prabhavit kar sakte hon ya responses mein reflect ho sakte hon.</p>
          <div class="code-block">
// Validate user inputs:
function validateHeader(header, expectedFormat) {
  return expectedFormat.test(header);
}

// Use allowlists for parameters
const allowedParams = ['lang', 'theme', 'page'];
function isAllowedParam(param) {
  return allowedParams.includes(param);
}

// Sanitize before caching
currentUserId !== null && currentUserId !== undefined;
          </div>
        </div>

        <!-- Cache Segregation -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Cache Segregation & Isolation</h4>
          <p class="en">Use separate cache instances or namespaces to prevent cross-contamination between users.</p>
          <p class="hi" style="display:none;">Cross-contamination prevent karne ke liye separate cache instances ya namespaces ka upyog karein.</p>
          <div class="code-block">
// Separate caches by user context:
const userCache = new Map();
const globalCache = new Map();

// Instead of
cache.set('user:123', data);

// Use
cache.set(`user:${userId}:resource:${resourceId}`, data);

// Or use Redis namespaces
redis.set(`user:${userId}:sessions:${sessionId}`, data);
          </div>
        </div>

        <!-- Cache Policies -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. Proper Cache Policies & TTL</h4>
          <p class="en">Implement appropriate cache expiration policies to limit the impact of successful attacks.</p>
          <p class="hi" style="display:none;">Successful attacks par padne wale prabhav ko limit karne ke liye appropriate cache expiration policies implement karein.</p>
          <div class="code-block">
// Set reasonable TTL:
cache.set(key, data, { expiration: '5 minutes' });

// For dynamic content, use shorter TTL
cache.set(dynamicKey, data, {
  expiration: '1 minute',
  sliding: true  // Renew on access
});

// sensitive data - don't cache at all
if (isSensitiveData(data)) {
  return freshData; // Skip cache
}
          </div>
        </div>
      </div>

      <!-- Testing & Monitoring -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Testing & Monitoring Cache Poisoning</h3>
        <h3 class="hi" style="display:none;">Cache Poisoning Ki Testing Aur Monitoring</h3>

        <!-- Interactive Testing -->
        <div class="interactive-demo animate-on-scroll">
          <h4 style="color: var(--neon-green);">Cache Poisoning Prevention Testing</h4>
          <div class="demo-container">
            <div class="input-group">
              <label for="cache-test-url" class="en">Test URL:</label>
              <label for="cache-test-url" class="hi" style="display:none;">Test URL:</label>
              <input type="text" id="cache-test-url" value="https://example.com/resource">
            </div>
            <button class="button" onclick="testCacheProtection()" style="position: relative; z-index: 10;">Test Prevention</button>
            <div class="result-box" id="cache-protection-result">
// Test results will appear here
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Quiz -->
  <section id="quiz">
    <div class="container">
      <h2 class="section-title en">Knowledge Check</h2>
      <h2 class="section-title hi" style="display:none;">Jaankari Check Karein</h2>
      <div class="quiz-container animate-on-scroll">
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px;" class="en">Test Your Understanding</h3>
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px; display:none;" class="hi">Apni Samajh Ko Test Karein</h3>
        <div id="quiz-questions">
          <!-- Questions will be injected here -->
        </div>
        <div class="score-display" id="score-display">Score: 0 / 10</div>
        <button class="button quiz-submit" onclick="submitQuiz()">Submit Quiz</button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <h3 class="en">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</h3>
      <h3 class="hi" style="display:none;">Ankush Rana Dwara | HTB Elite Hacker | Senior Security Engineer</h3>
      <p class="en">Breaking Systems. Building Defenses.</p>
      <p class="hi" style="display:none;">Systems todte hain. Defenses banate hain.</p>

      <div class="social-links">
        <a href="https://github.com/ankushrana6395" target="_blank" class="social-link github">
          <i class="fab fa-github"></i>
        </a>
        <a href="mailto:ankushrana6395@gmail.com" class="social-link email">
          <i class="fas fa-envelope"></i>
        </a>
        <a href="https://app.hackthebox.com/profile/117501" target="_blank" class="social-link htb">
          <i class="fab fa-cube"></i>
        </a>
      </div>

      <p style="margin-top: 30px;" class="en">&copy; 2025 Ankush Rana. All Rights Reserved.</p>
      <p style="margin-top: 30px; display:none;" class="hi">&copy; 2025 Ankush Rana. Sabhi Adhikar Sanchit Hai.</p>
    </div>
  </footer>

  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>
    let isHinglish = false;

    // Wait for DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', function() {
      initializeApp();
    });

    function initializeApp() {
      // Initialize Three.js
      const canvas = document.getElementById('three-canvas');
      if (canvas) {
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        // Grid
        const gridHelper = new THREE.GridHelper(100, 100, 0x00ff88, 0x003322);
        gridHelper.position.z = -20;
        scene.add(gridHelper);

        // Floating Points
        const geometry = new THREE.BufferGeometry();
        const count = 500;
        const positions = new Float32Array(count * 3);
        for (let i = 0; i < count * 3; i++) {
          positions[i] = (Math.random() - 0.5) * 100;
        }
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        const material = new THREE.PointsMaterial({ color: 0x00ff88, size: 0.5, transparent: true, opacity: 0.8 });
        const points = new THREE.Points(geometry, material);
        scene.add(points);

        // Add floating cubes
        const cubeGeometry = new THREE.BoxGeometry(2, 2, 2);
        const cubeMaterial = new THREE.MeshBasicMaterial({
          color: 0x00aaff,
          wireframe: true,
          transparent: true,
          opacity: 0.5
        });
        const cubes = [];
        for (let i = 0; i < 10; i++) {
          const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
          cube.position.x = (Math.random() - 0.5) * 50;
          cube.position.y = (Math.random() - 0.5) * 50;
          cube.position.z = (Math.random() - 0.5) * 50;
          cube.rotation.x = Math.random() * Math.PI;
          cube.rotation.y = Math.random() * Math.PI;
          cubes.push({ mesh: cube, speed: Math.random() * 0.02 });
          scene.add(cube);
        }

        camera.position.z = 30;

        // Animation
        function animate() {
          requestAnimationFrame(animate);
          gridHelper.rotation.y += 0.005;
          points.rotation.y += 0.003;
          cubes.forEach(cube => {
            cube.mesh.rotation.x += cube.speed;
            cube.mesh.rotation.y += cube.speed;
          });
          renderer.render(scene, camera);
        }
        animate();

        // Resize
        window.addEventListener('resize', () => {
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(window.innerWidth, window.innerHeight);
        });
      }

      // Initialize keyword modal
      const keywordModal = document.getElementById('keyword-modal');
      const modalTitle = document.getElementById('modal-title');
      const modalBody = document.getElementById('modal-body');
      const modalClose = document.getElementById('modal-close');

      if (keywordModal && modalTitle && modalBody && modalClose) {
        document.querySelectorAll('.keyword').forEach(keyword => {
          keyword.addEventListener('click', function(e) {
            e.stopPropagation();
            modalTitle.textContent = this.getAttribute('data-title');
            modalBody.textContent = this.getAttribute('data-content');
            keywordModal.classList.add('active');
          });
        });

        modalClose.addEventListener('click', () => {
          keywordModal.classList.remove('active');
        });

        keywordModal.addEventListener('click', (e) => {
          if (e.target === keywordModal) {
            keywordModal.classList.remove('active');
          }
        });
      }

      // Initialize quiz
      renderQuiz();

      // Initialize scroll animation
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) entry.target.classList.add('visible');
        });
      }, { threshold: 0.1 });

      document.querySelectorAll('.animate-on-scroll').forEach(el => observer.observe(el));
    }

    // Card Interaction Functions
    function highlightCard(card) {
      if (card) {
        card.classList.add('pop-out');
        showNotification('Hovering: ' + card.querySelector('h3').textContent);
      }
    }

    function unhighlightCard(card) {
      if (card && !card.classList.contains('focused')) {
        card.classList.remove('pop-out');
      }
    }

    function focusCard(card) {
      document.querySelectorAll('.lecture-card').forEach(c => {
        c.classList.remove('focused');
        c.classList.remove('pop-out');
      });

      if (card) {
        card.classList.add('focused');
        card.classList.add('pop-out');
        showNotification('Focused on: ' + card.querySelector('h3').textContent);
      }
    }

    // Language Toggle
    function toggleLanguage() {
      isHinglish = !isHinglish;
      const enElements = document.querySelectorAll('.en');
      const hiElements = document.querySelectorAll('.hi');

      enElements.forEach(el => {
        if (el) el.style.display = isHinglish ? 'none' : 'block';
      });

      hiElements.forEach(el => {
        if (el) el.style.display = isHinglish ? 'block' : 'none';
      });

      // Update both translator buttons
      const translatorBtns = document.querySelectorAll('.translator-btn');
      translatorBtns.forEach(btn => {
        if (btn) btn.textContent = isHinglish ? '🌐 English On' : '🌐 Hinglish On';
      });

      showNotification(isHinglish ? 'Hinglish mode activated!' : 'English mode activated!');

      // Re-render quiz with new language
      renderQuiz();
    }

    // Quiz Questions (10 Questions about Cache Poisoning)
    const quizQuestions = [
      {
        question: {
          en: "What is the main goal of web cache poisoning?",
          hi: "Web cache poisoning ka mukhya uddeshya kya hota hai?"
        },
        options: {
          en: [
            "To speed up websites",
            "To serve malicious content to other users",
            "To block access to a site",
            "To change caching settings"
          ],
          hi: [
            "Websites ko tez karna",
            "Doosre users ko malicious content serve karna",
            "Kisi site tak pravesh block karna",
            "Caching settings badalna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Cache poisoning serves malicious cached content to other users.",
          hi: "Cache poisoning doosre users ko malicious cached content serve karta hai।"
        }
      },
      {
        question: {
          en: "Which header is commonly used for cache poisoning?",
          hi: "Cache poisoning ke liye kaunsa header commonly use kiya jata hai?"
        },
        options: {
          en: [
            "X-Forwarded-Host",
            "User-Agent",
            "Accept-Language",
            "Referer"
          ],
          hi: [
            "X-Forwarded-Host",
            "User-Agent",
            "Accept-Language",
            "Referer"
          ]
        },
        correct: 0,
        explanation: {
          en: "X-Forwarded-Host is commonly unkeyed and can be abused.",
          hi: "X-Forwarded-Host aksar unkeyed hota hai aur abuse kiya ja sakta hai।"
        }
      },
      {
        question: {
          en: "What is parameter pollution in cache context?",
          hi: "Cache context mein parameter pollution kya hota hai?"
        },
        options: {
          en: [
            "Too many query parameters",
            "Multiple parameters with same name causing cache inconsistency",
            "Encrypting parameters",
            "Removing parameters"
          ],
          hi: [
            "Bahut zyada query parameters",
            "Same naam ke multiple parameters jinse cache inconsistency hoti hai",
            "Parameters encrypt karna",
            "Parameters hataana"
          ]
        },
        correct: 1,
        explanation: {
          en: "Parameter pollution exploits how different backends handle duplicated params.",
          hi: "Parameter pollution exploit karta hai ki alag-alag backends duplicated params ko kaise handle karte hain।"
        }
      },
      {
        question: {
          en: "What does FAT GET stand for?",
          hi: "FAT GET ka kya matlab hota hai?"
        },
        options: {
          en: [
            "Fast Action Threat GET",
            "Fat (JSON) GET",
            "File Allocation Table GET",
            "Full Attack Technique GET"
          ],
          hi: [
            "Fast Action Threat GET",
            "Fat (JSON) GET",
            "File Allocation Table GET",
            "Full Attack Technique GET"
          ]
        },
        correct: 1,
        explanation: {
          en: "FAT GET uses duplicated keys in JSON for cache poisoning.",
          hi: "FAT GET JSON mein duplicated keys ka upyog cache poisoning ke liye karta hai."
        }
      },
      {
        question: {
          en: "How can you prevent cache poisoning?",
          hi: "Cache poisoning ko kaise prevent kar sakte hain?"
        },
        options: {
          en: [
            "Disable all caching",
            "Proper cache key construction and input validation",
            "Use only POST requests",
            "Remove all headers"
          ],
          hi: [
            "Sabhi caching disable karein",
            "Proper cache key construction aur input validation",
            "Kewal POST requests hi use karein",
            "Sabhi headers hata dein"
          ]
        },
        correct: 1,
        explanation: {
          en: "Proper cache key design and validation prevent most attacks.",
          hi: "Proper cache key design aur validation most attacks prevent karta hai।"
        }
      },
      {
        question: {
          en: "What is an unkeyed header?",
          hi: "Unkeyed header kya hota hai?"
        },
        options: {
          en: [
            "Encrypted headers",
            "Headers not included in cache key calculations",
            "Headers with passwords",
            "Headers that are always cached"
          ],
          hi: [
            "Encrypted headers",
            "Headers jo cache key calculations mein include nahi hote",
            "Headers jinme passwords hote hain",
            "Headers jo hamesha cache hote hain"
          ]
        },
        correct: 1,
        explanation: {
          en: "Unkeyed headers allow different cache entries for the same URL.",
          hi: "Unkeyed headers ek hi URL ke liye alag-alag cache entries allow karte hain।"
        }
      },
      {
        question: {
          en: "Why is cache poisoning dangerous?",
          hi: "Cache poisoning kyun khatarnaak hota hai?"
        },
        options: {
          en: [
            "It slows down servers",
            "It can affect thousands of users simultaneously",
            "It requires admin access",
            "It only works on local development"
          ],
          hi: [
            "Servers ko slow kar deta hai",
            "Thousands of users ko ek saath prabhavit kar sakta hai",
            "Admin access require karta hai",
            "Kewal local development par work karta hai"
          ]
        },
        correct: 1,
        explanation: {
          en: "Poisoned cache entries serve malicious content to all visitors.",
          hi: "Poisoned cache entries sabhi visitors ko malicious content serve karte hain।"
        }
      },
      {
        question: {
          en: "What is key in preventing cache poisoning?",
          hi: "Cache poisoning prevent karne mein key kya hai?"
        },
        options: {
          en: [
            "Using bigger cache servers",
            "Including only safe headers in cache keys",
            "Disabling all user inputs",
            "Using HTTP instead of HTTPS"
          ],
          hi: [
            "Bigger cache servers use karna",
            "Cache keys mein kewal safe headers include karna",
            "Sabhi user inputs disable karna",
            "HTTP instead of HTTPS use karna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Safe cache keys prevent malicious variations.",
          hi: "Safe cache keys malicious variations prevent karte hain।"
        }
      },
      {
        question: {
          en: "What does cache busting mean?",
          hi: "Cache busting ka kya matlab hai?"
        },
        options: {
          en: [
            "Making cache bigger",
            "Forcing cache to reload resources",
            "Deleting all cached data",
            "Encrypting cache contents"
          ],
          hi: [
            "Cache ko bada karna",
            "Cache ko force karna ki resources reload kare",
            "Sabhi cached data delete karna",
            "Cache contents encrypt karna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Cache busting forces fresh loads of resources.",
          hi: "Cache busting resources ke fresh loads ko force karta hai।"
        }
      },
      {
        question: {
          en: "Why should you use cache segregation?",
          hi: "Aapko cache segregation kyun use karna chahiye?"
        },
        options: {
          en: [
            "To save disk space",
            "Prevent one user's poison affecting others",
            "To speed up access",
            "To reduce bandwidth"
          ],
          hi: [
            "Disk space bachaane ke liye",
            "Ek user ka poison doosre ko na prabhavit kare",
            "Access speed badhaane ke liye",
            "Bandwidth kam karne ke liye"
          ]
        },
        correct: 1,
        explanation: {
          en: "Segregation prevents cross-user contamination.",
          hi: "Segregation cross-user contamination prevent karta hai।"
        }
      }
    ];

    // Render Quiz
    function renderQuiz() {
      const quizContainer = document.getElementById('quiz-questions');
      if (!quizContainer) return;

      quizContainer.innerHTML = '';
      quizQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'quiz-question';
        const qText = isHinglish ? q.question.hi : q.question.en;
        const opts = isHinglish ? q.options.hi : q.options.en;
        questionDiv.innerHTML = `
          <h4>Q${index + 1}: ${qText}</h4>
          <div class="options" id="options-${index}">
            ${opts.map((opt, i) => `
              <div class="option" onclick="selectOption(${index}, ${i})">${opt}</div>
            `).join('')}
          </div>
        `;
        quizContainer.appendChild(questionDiv);
      });
    }

    // Track selected answers
    const selectedAnswers = new Array(quizQuestions.length).fill(-1);

    // Select Option
    window.selectOption = function(questionIndex, optionIndex) {
      const optionsContainer = document.getElementById(`options-${questionIndex}`);
      if (!optionsContainer) return;

      optionsContainer.querySelectorAll('.option').forEach(opt => {
        opt.classList.remove('selected');
      });

      optionsContainer.querySelectorAll('.option')[optionIndex].classList.add('selected');
      selectedAnswers[questionIndex] = optionIndex;
    };

    // Submit Quiz
    window.submitQuiz = function() {
      let score = 0;
      const scoreDisplay = document.getElementById('score-display');
      const quizContainer = document.getElementById('quiz-questions');
      if (!scoreDisplay || !quizContainer) return;

      // Create detailed results summary
      let resultsSummary = isHinglish ?
        '<h3 style="color: var(--neon-green); margin-bottom: 20px;">📊 Quiz Results Summary</h3>\n' :
        '<h3 style="color: var(--neon-green); margin-bottom: 20px;">📊 Quiz Results Summary</h3>\n';

      let correctCount = 0;
      let incorrectCount = 0;
      let unattemptedCount = 0;

      quizQuestions.forEach((q, index) => {
        const optionsContainer = document.getElementById(`options-${index}`);
        if (!optionsContainer) return;

        const options = optionsContainer.querySelectorAll('.option');
        const questionText = isHinglish ? q.question.hi : q.question.en;
        const correctOption = isHinglish ? q.options.hi[q.correct] : q.options.en[q.correct];
        const explanation = isHinglish ? q.explanation.hi : q.explanation.en;
        let userAnswer = 'Not attempted';

        if (selectedAnswers[index] === q.correct) {
          score++;
          correctCount++;
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1) options[selectedAnswers[index]].classList.add('correct');
          userAnswer = correctOption;
        } else if (selectedAnswers[index] !== -1) {
          incorrectCount++;
          const userOption = isHinglish ? q.options.hi[selectedAnswers[index]] : q.options.en[selectedAnswers[index]];
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== q.correct) {
            options[selectedAnswers[index]].classList.add('incorrect');
          }
          userAnswer = userOption;
        } else {
          unattemptedCount++;
          options[q.correct].classList.add('correct');
        }

        // Add detailed result for this question
        const statusIcon = selectedAnswers[index] === q.correct ? '✅' : (selectedAnswers[index] !== -1 ? '❌' : '⚠️');
        const statusText = selectedAnswers[index] === q.correct ? 'Correct' : (selectedAnswers[index] !== -1 ? 'Incorrect' : 'Not Attempted');

        resultsSummary += `
          <div style="margin-bottom: 20px; padding: 15px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
            <h4 style="color: var(--electric-blue); margin-bottom: 10px;">Question ${index + 1}: ${statusIcon} ${statusText}</h4>
            <p style="font-weight: bold; margin-bottom: 8px;">${questionText}</p>
            <p><strong>${isHinglish ? 'Aapka Answer:' : 'Your Answer:'}</strong> ${userAnswer}</p>
            <p><strong>${isHinglish ? 'Sahii Answer:' : 'Correct Answer:'}</strong> ${correctOption}</p>
            <p style="color: var(--keyword);"><strong>${isHinglish ? 'Samjhavyaa:' : 'Explanation:'}</strong> ${explanation}</p>
          </div>
        `;
      });

      // Add summary statistics
      resultsSummary += `
        <div style="margin-top: 30px; padding: 20px; border: 2px solid var(--neon-green); border-radius: 12px; background: rgba(0, 255, 136, 0.1);">
          <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 15px;">
            🎯 Performance Summary
          </h3>
          <div style="display: flex; justify-content: space-around; flex-wrap: wrap; gap: 20px;">
            <div style="text-align: center;">
              <div style="font-size: 2rem; font-weight: bold; color: var(--neon-green);">${correctCount}</div>
              <div style="color: var(--mid-gray);">${isHinglish ? 'Sahii Answer' : 'Correct Answers'}</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 2rem; font-weight: bold; color: #ff8800;">${incorrectCount}</div>
              <div style="color: var(--mid-gray);">${isHinglish ? 'Galat Answer' : 'Incorrect Answers'}</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 2rem; font-weight: bold; color: #aaa;">${unattemptedCount}</div>
              <div style="color: var(--mid-gray);">${isHinglish ? 'Na Answer Kiye' : 'Not Attempted'}</div>
            </div>
          </div>
        </div>
      `;

      // Update the quiz container with detailed results
      quizContainer.innerHTML = resultsSummary;

      scoreDisplay.textContent = `Score: ${score} / ${quizQuestions.length}`;
      showNotification(isHinglish ? `Quiz pura! Score: ${score}/${quizQuestions.length}` : `Quiz complete! You scored ${score}/${quizQuestions.length}`);
    };

    // Notification
    function showNotification(message) {
      const notification = document.getElementById('notification');
      const notificationText = document.getElementById('notification-text');

      if (notification && notificationText) {
        notificationText.textContent = message;
        notification.classList.add('show');
        setTimeout(() => notification.classList.remove('show'), 3000);
      }
    }

    // Scroll Progress Bar
    window.addEventListener('scroll', () => {
      const progressBar = document.getElementById('progress-bar');
      if (!progressBar) return;

      const winHeight = window.innerHeight;
      const docHeight = document.documentElement.scrollHeight;
      const scrollTop = window.pageYOffset;
      const trackLength = docHeight - winHeight;
      const progress = scrollTop / trackLength * 100;
      progressBar.style.width = progress + '%';
    });

    // Interactive Demo Functions
    function runHeaderPoisoning() {
      const headerInput = document.getElementById('header-input');
      const result = document.getElementById('header-result');

      if (!headerInput || !result) return;

      const header = headerInput.value;

      result.innerHTML = isHinglish
        ? `<span style="color: #00ff88">🔍 HEADER POISONING ATTEMPT:</span> ${header}<br>❌ If this header is unkeyed, it could poison the cache.<br><br>Common poisonous headers could lead to:<br>• Host header injection<br>• DoS through cache flushing<br>• Cache decontamination attacks`
        : `<span style="color: #00ff88">🔍 HEADER POISONING ATTEMPT:</span> ${header}<br>❌ If this header is unkeyed, it could poison the cache.<br><br>Common poisonous headers could lead to:<br>• Host header injection<br>• DoS through cache flushing<br>• Cache decontamination attacks`;

      showNotification(isHinglish ? 'Header poisoning simulated!' : 'Header poisoning simulated!');
    }

    function testCacheProtection() {
      const urlInput = document.getElementById('cache-test-url');
      const result = document.getElementById('cache-protection-result');

      if (!urlInput || !result) return;

      const url = urlInput.value;

      result.innerHTML = isHinglish
        ? `<span style="color: #00ff88">🛡️ PROTECTION TEST for:</span> ${url}<br><br>🔍 Testing for:<br>✅ Cache key validation<br>✅ Header sanitization<br>✅ Parameter validation<br>✅ Cache segregation<br><br><span style="color: #ff8800">💡 Real protection would include rate limiting and content validation.</span>`
        : `<span style="color: #00ff88">🛡️ PROTECTION TEST for:</span> ${url}<br><br>🔍 Testing for:<br>✅ Cache key validation<br>✅ Header sanitization<br>✅ Parameter validation<br>✅ Cache segregation<br><br><span style="color: #ff8800">💡 Real protection would include rate limiting and content validation.</span>`;

      showNotification(isHinglish ? 'Cache protection tested!' : 'Cache protection tested!');
    }

    function testAccessControlProtection() {
      const urlInput = document.getElementById('test-url');
      const result = document.getElementById('protection-result');

      if (!urlInput || !result) return;

      const url = urlInput.value;

      result.innerHTML = isHinglish
        ? `<span style="color: #00ff88">🛡️ PROTECTION TEST:</span> ${url}<br><br>🔍 Checking for:<br>✅ Role-based access control<br>✅ Input validation<br>✅ CORS policy<br>✅ Rate limiting<br>✅ JWT verification<br><br><span style="color: #ff8800">❌ Potential bypass methods would be tested here.</span>`
        : `<span style="color: #00ff88">🛡️ PROTECTION TEST:</span> ${url}<br><br>🔍 Checking for:<br>✅ Role-based access control<br>✅ Input validation<br>✅ CORS policy<br>✅ Rate limiting<br>✅ JWT verification<br><br><span style="color: #ff8800">❌ Potential bypass methods would be tested here.</span>`;

      showNotification(isHinglish ? 'Access control protection tested!' : 'Access control protection tested!');
    }

    function runIdorExploit() {
      const input = document.getElementById('idor-input');
      const result = document.getElementById('idor-result');

      if (!input || !result) return;

      const url = input.value;
      const urlParts = url.split('?');
      if (urlParts.length > 1) {
        const params = new URLSearchParams(urlParts[1]);
        const id = params.get('id');
        let newId = parseInt(id) + 1; // Try accessing next ID
        params.set('id', newId.toString());
        const newUrl = urlParts[0] + '?' + params.toString();

        result.innerHTML = isHinglish
          ? `<span style="color: #00ff88">🔍 IDOR ATTEMPT:</span> Trying URL:<br><code>${newUrl}</code><br>❌ This would attempt unauthorized access in a real scenario.`
          : `<span style="color: #00ff88">🔍 IDOR ATTEMPT:</span> Trying URL:<br><code>${newUrl}</code><br>❌ This would attempt unauthorized access in a real scenario.`;
      } else {
        result.innerHTML = isHinglish
          ? `<span style="color: #ff8800">❌ Invalid URL format.</span>`
          : `<span style="color: #ff8800">❌ Invalid URL format.</span>`;
      }
      showNotification(isHinglish ? 'IDOR demo simulated!' : 'IDOR demo simulated!');
    }

    function runPrivilegeEscalation() {
      const input = document.getElementById('privilege-input');
      const result = document.getElementById('privilege-result');

      if (!input || !result) return;

      const url = input.value;

      result.innerHTML = isHinglish
        ? `<span style="color: #00ff88">🚀 PRIVILEGE ESCALATION ATTEMPT:</span><br>📍 Target: Admin Dashboard<br>❌ ACCESS DENIED (Simulation)<br><br>Real attack would try:<br>• Path traversal: ../admin<br>• IDOR: Change user ID<br>• SQL injection: UNION SELECT<br>• Header injection: X-Role: admin`
        : `<span style="color: #00ff88">🚀 PRIVILEGE ESCALATION ATTEMPT:</span><br>📍 Target: Admin Dashboard<br>❌ ACCESS DENIED (Simulation)<br><br>Real attack would try:<br>• Path traversal: ../admin<br>• IDOR: Change user ID<br>• SQL injection: UNION SELECT<br>• Header injection: X-Role: admin`;

      showNotification(isHinglish ? 'Privilege escalation simulated!' : 'Privilege escalation simulated!');
    }

    function clearLabResults() {
      const labResult = document.getElementById('lab-result');
      const protectionResult = document.getElementById('protection-result');
      const idorResult = document.getElementById('idor-result');
      const privilegeResult = document.getElementById('privilege-result');

      if (labResult) labResult.innerHTML = isHinglish
        ? '// Lab results cleared'
        : '// Lab results cleared';

      if (protectionResult) protectionResult.innerHTML = isHinglish
        ? '// Results will appear here'
        : '// Results will appear here';

      if (idorResult) idorResult.innerHTML = isHinglish
        ? '// Try changing the ID parameter'
        : '// Try changing the ID parameter';

      if (privilegeResult) privilegeResult.innerHTML = isHinglish
        ? '// Try accessing admin functionality'
        : '// Try accessing admin functionality';

      showNotification(isHinglish ? 'Results cleared!' : 'Results cleared!');
    }

    function setTestURL(url) {
      const labUrlInput = document.getElementById('lab-url');
      if (labUrlInput) {
        labUrlInput.value = url;
        showNotification(isHinglish ? 'URL set!' : 'URL set!');
      }
    }

    // Parameter pollution demo function
    window.runParamPollution = function() {
      const paramInput = document.getElementById('param-input');
      if (!paramInput) return;

      showNotification(isHinglish ? 'Parameter pollution simulated!' : 'Parameter pollution simulated!');
    };
  </script>
</body>
</html>
