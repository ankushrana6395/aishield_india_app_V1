<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Interactive CORS Vulnerability Masterclass with Live Hinglish Translation | Quiz | Try It Yourself | By HTB Elite Hacker">
  <title>CORS Vulnerabilities | By Ankush Rana</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;600;700;900&family=Roboto:wght@300;400;500;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --primary: #0a1121;
      --dark-navy: #0b1b30;
      --neon-green: #00ff88;
      --electric-blue: #00aaff;
      --neon-orange: #ff8800;
      --neon-pink: #ff0080;
      --glow-green: rgba(0, 255, 136, 0.3);
      --glow-blue: rgba(0, 170, 255, 0.2);
      --glow-pink: rgba(255, 0, 128, 0.3);
      --light-gray: #e0e0e0;
      --mid-gray: #aaaaaa;
      --card-bg: #111c30;
      --border: #2a4060;
      --keyword: #ffdd57;
      --keyword-bg: rgba(255, 221, 87, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--primary);
      color: var(--light-gray);
      line-height: 1.7;
      overflow-x: hidden;
    }

    /* Three.js Background */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Translator Button */
    .translator-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 0 15px var(--glow-green);
      transition: all 0.3s ease;
    }

    .translator-btn:hover {
      transform: translateY(-2px);
      background: #00cc6d;
    }

    /* Header / Hero */
    header {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-content {
      z-index: 2;
      max-width: 900px;
      position: relative;
    }

    .hero-content h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2.8rem, 8vw, 4rem);
      color: white;
      margin-bottom: 10px;
      text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
      50% { text-shadow: 0 0 25px rgba(0, 255, 136, 0.9), 0 0 35px rgba(0, 255, 136, 0.5); }
      100% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
    }

    .hero-content h1 span {
      color: var(--neon-green);
    }

    .subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: clamp(1.2rem, 3.5vw, 1.5rem);
      color: var(--electric-blue);
      margin: 15px 0;
    }

    /* Section Styling */
    section {
      padding: 100px 0;
      position: relative;
    }

    .section-title {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2rem, 5vw, 2.5rem);
      color: var(--neon-green);
      margin-bottom: 50px;
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -8px;
      width: 70px;
      height: 4px;
      background: var(--electric-blue);
      animation: expand 2s infinite;
    }

    @keyframes expand {
      0% { width: 70px; }
      50% { width: 100px; }
      100% { width: 70px; }
    }

    /* Lecture Card */
    .lecture-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .lecture-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 136, 0.05), transparent);
      z-index: 0;
    }

    .lecture-card.pop-out {
      transform: translateY(-20px) scale(1.05);
      box-shadow: 
        0 30px 60px rgba(0, 0, 0, 0.5),
        0 0 50px var(--glow-green);
      border-color: var(--neon-green);
      z-index: 5;
    }

    .lecture-card.focused {
      transform: translateY(-20px) scale(1.06);
      box-shadow: 
        0 40px 80px rgba(0, 0, 0, 0.6),
        0 0 70px var(--glow-green);
      filter: brightness(1.1);
    }

    .lecture-card h3 {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 18px;
      font-size: 1.8rem;
      position: relative;
      z-index: 2;
    }

    /* Keyword Style */
    .keyword {
      background: var(--keyword-bg);
      color: var(--keyword);
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 1px dashed var(--keyword);
      position: relative;
      transition: all 0.3s ease;
      z-index: 2;
    }

    .keyword:hover {
      background: rgba(255, 221, 87, 0.3);
      box-shadow: 0 0 12px rgba(255, 221, 87, 0.4);
    }

    /* Tooltip (Modal) */
    .keyword-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 17, 33, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .keyword-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border: 2px solid var(--neon-green);
      border-radius: 14px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 50px var(--glow-green);
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .keyword-modal.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--neon-green);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-title {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .modal-body {
      color: var(--light-gray);
      line-height: 1.6;
    }

    /* Interactive Demo */
    .interactive-demo {
      background: rgba(0, 20, 40, 0.6);
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      border: 1px solid var(--electric-blue);
    }

    .demo-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .input-group label {
      min-width: 120px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--neon-green);
    }

    .input-group input, .input-group select {
      flex: 1;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: white;
      font-family: 'JetBrains Mono', monospace;
    }

    .input-group input:focus, .input-group select:focus {
      outline: none;
      border-color: var(--neon-green);
      box-shadow: 0 0 10px var(--glow-green);
    }

    .button {
      padding: 12px 24px;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 4px;
      font-family: 'Orbitron', sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: fit-content;
    }

    .button:hover {
      background: #00cc6d;
      box-shadow: 0 0 15px var(--glow-green);
      transform: translateY(-2px);
    }

    .result-box {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 6px;
      padding: 15px;
      margin-top: 15px;
      border-left: 3px solid var(--neon-green);
      font-family: 'JetBrains Mono', monospace;
      min-height: 100px;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    /* Diagram */
    .diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }

    .box {
      min-width: 140px;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      font-weight: bold;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }

    .box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
    }

    .box:hover::before {
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }

    .user-input { background: #8b0000; color: white; }
    .app { background: #003366; color: white; }
    .db { background: #004d00; color: #00ff88; }

    .arrow {
      font-size: 1.8rem;
      color: var(--neon-green);
      position: relative;
    }

    .arrow::before {
      content: '→';
      animation: arrow-pulse 1.5s infinite;
    }

    @keyframes arrow-pulse {
      0% { text-shadow: 0 0 5px var(--neon-green); }
      50% { text-shadow: 0 0 15px var(--neon-green); }
      100% { text-shadow: 0 0 5px var(--neon-green); }
    }

    /* Code Block */
    .code-block {
      background: #001a1a;
      color: #00ff88;
      font-family: 'JetBrains Mono', monospace;
      padding: 15px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 15px 0;
      border-left: 4px solid var(--neon-green);
      position: relative;
    }

    .code-block::before {
      content: 'CODE';
      position: absolute;
      top: 0;
      right: 0;
      background: var(--neon-green);
      color: var(--primary);
      font-size: 0.7rem;
      padding: 2px 8px;
      border-bottom-left-radius: 4px;
      font-weight: bold;
    }

    /* Statistics Section */
    .stats-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin: 30px 0;
    }

    .stat-box {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
      min-width: 200px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      border-color: var(--neon-green);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .stat-label {
      color: var(--mid-gray);
      font-size: 0.9rem;
    }

    /* Quiz Section */
    .quiz-container {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .quiz-question {
      margin-bottom: 20px;
    }

    .quiz-question h4 {
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      background: rgba(0, 255, 136, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
    }

    .option.selected {
      background: var(--neon-green);
      color: var(--primary);
      font-weight: bold;
    }

    .score-display {
      text-align: center;
      font-size: 1.5rem;
      margin: 20px 0;
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
    }

    .button.quiz-submit {
      background: var(--neon-orange);
      color: white;
    }

    .button.quiz-submit:hover {
      background: #cc7000;
    }

    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: transparent;
      z-index: 1000;
    }

    .progress-bar {
      height: 100%;
      background: var(--neon-green);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Notification */
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--neon-green);
      border-radius: 8px;
      padding: 15px;
      color: var(--light-gray);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 60px 0;
      background: var(--dark-navy);
      color: var(--mid-gray);
      position: relative;
      overflow: hidden;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--neon-green), var(--electric-blue), var(--neon-pink));
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .social-link.github:hover { background: var(--neon-green); color: var(--primary); }
    .social-link.email:hover { background: var(--electric-blue); }
    .social-link.htb:hover { background: var(--neon-orange); }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-content h1 { font-size: 2.8rem; }
      .section-title { font-size: 1.8rem; }
      .diagram { flex-direction: column; }
      .arrow::before { content: '↓'; }
      .input-group { flex-direction: column; }
      .input-group label { min-width: auto; }
    }

    /* CORS Specific Styles */
    .cors-demo {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin: 20px 0;
    }

    .request-response {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 15px 0;
    }

    .request, .response {
      padding: 15px;
      border-radius: 8px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
    }

    .request {
      background: rgba(0, 50, 100, 0.5);
      border-left: 4px solid var(--electric-blue);
    }

    .response {
      background: rgba(0, 80, 0, 0.5);
      border-left: 4px solid var(--neon-green);
    }

    .header-row {
      display: flex;
      margin: 5px 0;
    }

    .header-name {
      min-width: 150px;
      color: var(--mid-gray);
    }

    .header-value {
      flex: 1;
      color: white;
    }
  </style>
</head>
<body>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <!-- Translator Button -->
  <button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="right: auto; left: 20px;">
    🌐 Hinglish On
  </button>

  <!-- Keyword Modal -->
  <div class="keyword-modal" id="keyword-modal">
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h3 class="modal-title" id="modal-title">Keyword</h3>
      <div class="modal-body" id="modal-body">Definition will appear here.</div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i> <span id="notification-text">Welcome to the CORS Vulnerability Masterclass!</span>
  </div>

  <!-- Three.js Background Canvas -->
  <canvas id="three-canvas"></canvas>

  <!-- Header / Hero -->
  <header id="home">
    <div class="container">
      <div class="hero-content">
        <!-- English Version -->
        <div class="en">
          <h1>CORS <span>Vulnerabilities</span></h1>
          <div class="subtitle">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</div>
          <p>A deep dive into Cross-Origin Resource Sharing vulnerabilities, exploitation techniques, and real-world attacks — with interactive demos and elite-level insights.</p>
        </div>

        <!-- Hinglish Version -->
        <div class="hi" style="display:none;">
          <h1>CORS <span>Vulnerabilities</span></h1>
          <div class="subtitle">Ankush Rana द्वारा | HTB Elite Hacker | Senior Security Engineer</div>
          <p>Cross-Origin Resource Sharing vulnerabilities, exploitation techniques, aur real-world attacks mein gahrai se jaane — interactive demos aur elite-level samajh ke saath.</p>
        </div>

        <!-- HTB & Bug Bounty Credibility -->
        <div style="margin-top: 40px; display: flex; align-items: center; gap: 25px; flex-wrap: wrap; justify-content: center; font-family: 'JetBrains Mono', monospace;">
          <img src="https://www.hackthebox.com/storage/achievements/elite_2024_badge.svg" alt="HTB Elite" style="width: 90px; filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
          <div style="text-align: center;">
            <img src="https://via.placeholder.com/100/0a1121/00ff88?text=AR" alt="Ankush Rana" style="width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--neon-green); filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
            <p style="margin: 5px 0 0; color: var(--neon-green);">52+ User Flags</p>
            <p style="margin: 0; color: var(--electric-blue);">47+ Root Owned</p>
          </div>
          <div style="text-align: center;">
            <p style="color: var(--neon-orange);">🏆 Top 10 India</p>
            <p style="color: var(--neon-pink);">💼 Sattrix | GPSSI</p>
          </div>
        </div>

        <!-- Call to Action -->
        <div style="margin-top: 30px; font-family: 'Orbitron', sans-serif; color: var(--electric-blue);">
          <i class="fas fa-mouse-pointer"></i> Toggle Hinglish Mode → <strong>Top Left Corner</strong>
          <div style="display: flex; justify-content: center; margin-top: 10px;"><button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="position: relative; margin: 0 auto;">🌐 Hinglish On</button></div>
        </div>
      </div>
    </div>
  </header>

  <!-- Section: What is CORS? -->
  <section id="basics">
    <div class="container">
      <h2 class="section-title en">What is CORS?</h2>
      <h2 class="section-title hi" style="display:none;">CORS Kya Hai?</h2>
      
      <!-- Progress Tracker -->
      <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
        <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-green);">1</div>
          <div class="step-title en">Basic Concepts</div>
          <div class="step-title hi" style="display:none;">Mool Baat</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--electric-blue);">2</div>
          <div class="step-title en">Attack Vectors</div>
          <div class="step-title hi" style="display:none;">Hamlawar Ke Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-orange);">3</div>
          <div class="step-title en">Advanced Techniques</div>
          <div class="step-title hi" style="display:none;">Uchatam Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 0, 128, 0.1); border: 1px solid var(--neon-pink); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-pink);">4</div>
          <div class="step-title en">Prevention</div>
          <div class="step-title hi" style="display:none;">Bachav</div>
        </div>
      </div>

      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Understanding CORS</h3>
        <h3 class="hi" style="display:none;">CORS Ki Samajh</h3>
        <p class="en">Cross-Origin Resource Sharing (CORS) is a mechanism that allows restricted resources on a web page to be requested from another domain outside the domain from which the first resource was served.</p>
        <p class="hi" style="display:none;">Cross-Origin Resource Sharing (CORS) ek yantra hai jo web page par pratibandhit srotakon ko pehle resource serve karne wale domain ke bahar ke anya domain se maangne ki anumati deta hai.</p>
        <p class="en"><strong>Real Analogy:</strong> Like a bouncer at a club checking IDs - the bouncer (browser) checks if the person (request) from another club (origin) should be allowed into this club (resource).</p>
        <p class="hi" style="display:none;"><strong>Asli Example:</strong> Jaise ek club ka bouncer IDs check karta hai - bouncer (browser) jaanchta hai ki kya doosre club (origin) se aaya vyakti (request) is club (resource) mein pravesh pa sakta hai.</p>
        <p class="en">CORS misconfigurations are dangerous because they can allow attackers to bypass the Same-Origin Policy and access sensitive data from other domains.</p>
        <p class="hi" style="display:none;">CORS misconfigurations khatarnaak hain kyunki yeh hamlawaron ko Same-Origin Policy ko bypass karne aur anya domains se sanvedansheel data tak pahunchne ki anumati de sakte hain.</p>
        <p class="en"><span class="keyword" data-title="CORS" data-content="Cross-Origin Resource Sharing: A mechanism that allows restricted resources to be requested from another domain.">CORS</span> is implemented through HTTP headers that tell browsers whether a web application running at one origin has permission to access resources from a different origin.</p>
        <p class="hi" style="display:none;"><span class="keyword" data-title="CORS" data-content="Cross-Origin Resource Sharing: Ek yantra jo pratibandhit srotakon ko anya domain se maangne ki anumati deta hai.">CORS</span> HTTP headers ke through lagu kiya jata hai jo browsers ko batata hai ki ek origin par chalne wali web application ko anya origin se srotakon tak pravesh ki anumati hai ya nahi.</p>
      </div>

      <!-- CORS Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">How CORS Works - Visualization</h3>
        <h3 class="hi" style="display:none;">CORS Kaise Kaam Karta Hai - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 180px;">
            <div class="en">Browser Request</div>
            <div class="hi" style="display:none;">Browser Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Origin: https://evil.com</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 180px;">
            <div class="en">Server Response</div>
            <div class="hi" style="display:none;">Server Response</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Access-Control-Allow-Origin: *</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 180px;">
            <div class="en">Data Access</div>
            <div class="hi" style="display:none;">Data Pravesh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Sensitive Data Leaked</div>
          </div>
        </div>
        <p class="en">The browser sends a request with an Origin header, and the server responds with Access-Control-Allow-Origin header indicating which origins are permitted to access the resource.</p>
        <p class="hi" style="display:none;">Browser ek Origin header ke saath anurodh bhejta hai, aur server Access-Control-Allow-Origin header ke saath response karta hai jo yeh batata hai ki kaunse origins ko resource tak pravesh ki anumati hai.</p>
      </div>

      <!-- Types of CORS Vulnerabilities -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Types of CORS Vulnerabilities</h3>
        <h3 class="hi" style="display:none;">CORS Vulnerabilities Ke Prakar</h3>
        <ul style="margin: 15px 0 15px 30px;">
          <li class="en"><span class="keyword" data-title="Wildcard Misconfiguration" data-content="Using Access-Control-Allow-Origin: * with credentials.">Wildcard Misconfiguration</span>: Using Access-Control-Allow-Origin: * with credentials</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Wildcard Misconfiguration" data-content="Credentials ke saath Access-Control-Allow-Origin: * ka upyog.">Wildcard Misconfiguration</span>: Credentials ke saath Access-Control-Allow-Origin: * ka upyog</li>
          <li class="en"><span class="keyword" data-title="Reflected Origin" data-content="Dynamically reflecting the Origin header without proper validation.">Reflected Origin</span>: Dynamically reflecting the Origin header without validation</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Reflected Origin" data-content="Bina uchit jaanch ke Origin header ko dynamically reflect karna.">Reflected Origin</span>: Bina jaanch ke Origin header ko dynamically reflect karna</li>
          <li class="en"><span class="keyword" data-title="Null Origin" data-content="Allowing null origin which can be exploited by sandboxed iframes.">Null Origin</span>: Allowing null origin which can be exploited</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Null Origin" data-content="Null origin ko anumati dena jiska sandboxed iframes dwara doharan kiya ja sakta hai.">Null Origin</span>: Null origin ko anumati dena jiska doharan kiya ja sakta hai</li>
          <li class="en"><span class="keyword" data-title="Preflight Bypass" data-content="Bypassing preflight requests through various techniques.">Preflight Bypass</span>: Bypassing preflight requests</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Preflight Bypass" data-content="Vibhinn tarikon ke through preflight requests ko bypass karna.">Preflight Bypass</span>: Preflight requests ko bypass karna</li>
        </ul>
      </div>

      <!-- Statistics -->
      <div class="stats-container animate-on-scroll">
        <div class="stat-box">
          <div class="stat-number en">Medium</div>
          <div class="stat-number hi" style="display:none;">Madhyam</div>
          <div class="stat-label en">severity rating</div>
          <div class="stat-label hi" style="display:none;">khatre ka level</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">25%</div>
          <div class="stat-label en">of APIs vulnerable</div>
          <div class="stat-label hi" style="display:none;">APIs kamjor hain</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">$5K+</div>
          <div class="stat-label en">in bug bounty rewards</div>
          <div class="stat-label hi" style="display:none;">bug bounty mein kamai</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – CORS -->
  <section id="try-cors">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: CORS Exploitation</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: CORS Doharpan</h2>
      
      <!-- Learning Path Progress -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Learning Path: Basic to Advanced</h3>
        <h3 class="hi" style="display:none;">Sikshna Marg: Mool Se Uchatam</h3>
        <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
          <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-green);">1</div>
            <div class="step-title en">Basic CORS Misconfig</div>
            <div class="step-title hi" style="display:none;">Mool CORS Misconfig</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--electric-blue);">2</div>
            <div class="step-title en">Advanced Techniques</div>
            <div class="step-title hi" style="display:none;">Uchatam Tarika</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-orange);">3</div>
            <div class="step-title en">Real-World Scenarios</div>
            <div class="step-title hi" style="display:none;">Vastavik Duniya Ke Udaharan</div>
          </div>
        </div>
      </div>

      <!-- Basic CORS Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Level 1: Basic CORS Misconfiguration</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Level 1: Mool CORS Misconfiguration</h3>
        <p class="en">Exploit a misconfigured CORS policy that allows any origin to access sensitive data.</p>
        <p class="hi" style="display:none;">Galat configure ki gayi CORS policy ka faida uthayein jo kisi bhi origin ko sanvedansheel data tak pravesh ki anumati deti hai.</p>
        
        <div class="cors-demo">
          <div class="input-group">
            <label for="target-api" class="en">Target API URL:</label>
            <label for="target-api" class="hi" style="display:none;">Lakshya API URL:</label>
            <input type="text" id="target-api" value="https://vulnerable-api.com/user/data">
          </div>
          
          <div class="input-group">
            <label for="attacker-origin" class="en">Attacker Origin:</label>
            <label for="attacker-origin" class="hi" style="display:none;">Hamlawar Origin:</label>
            <input type="text" id="attacker-origin" value="https://evil.com">
          </div>
          
          <button class="button" onclick="demoCorsExploit()">Exploit CORS</button>
          
          <div class="request-response">
            <div class="request">
              <strong>Request Headers:</strong>
              <div class="header-row">
                <span class="header-name">GET /user/data HTTP/1.1</span>
              </div>
              <div class="header-row">
                <span class="header-name">Host:</span>
                <span class="header-value">vulnerable-api.com</span>
              </div>
              <div class="header-row">
                <span class="header-name">Origin:</span>
                <span class="header-value">https://evil.com</span>
              </div>
              <div class="header-row">
                <span class="header-name">Cookie:</span>
                <span class="header-value">sessionid=abc123...</span>
              </div>
            </div>
            
            <div class="response">
              <strong>Response Headers:</strong>
              <div class="header-row">
                <span class="header-name">HTTP/1.1 200 OK</span>
              </div>
              <div class="header-row">
                <span class="header-name">Access-Control-Allow-Origin:</span>
                <span class="header-value">https://evil.com</span>
              </div>
              <div class="header-row">
                <span class="header-name">Access-Control-Allow-Credentials:</span>
                <span class="header-value">true</span>
              </div>
              <div class="header-row">
                <span class="header-name">Content-Type:</span>
                <span class="header-value">application/json</span>
              </div>
            </div>
          </div>
          
          <div class="result-box" id="cors-result">
// CORS exploitation results will appear here
          </div>
        </div>
      </div>

      <!-- Advanced Techniques Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--electric-blue); margin-bottom: 15px;" class="en">Level 2: Advanced CORS Techniques</h3>
        <h3 style="color: var(--electric-blue); margin-bottom: 15px; display:none;" class="hi">Level 2: Uchatam CORS Tarika</h3>
        <p class="en">Use advanced techniques like subdomain takeover, DNS pinning, and protocol switching.</p>
        <p class="hi" style="display:none;">Subdomain takeover, DNS pinning, aur protocol switching jaise uchatam tarikon ka upyog karein.</p>
        
        <div class="demo-container">
          <div class="input-group">
            <label for="advanced-technique" class="en">Advanced Technique:</label>
            <label for="advanced-technique" class="hi" style="display:none;">Uchatam Technique:</label>
            <select id="advanced-technique">
              <option value="subdomain">Subdomain Takeover</option>
              <option value="dns">DNS Pinning</option>
              <option value="protocol">Protocol Switching (HTTP to HTTPS)</option>
              <option value="prefix">Domain Prefix Matching</option>
            </select>
          </div>
          
          <div class="code-block">
// Advanced CORS techniques:
// 1. Subdomain Takeover: Claim abandoned subdomains
// 2. DNS Pinning: Manipulate DNS to bypass origin checks
// 3. Protocol Switching: Exploit HTTP/HTTPS inconsistencies
// 4. Prefix Matching: Abuse domain prefix wildcards
          </div>
          
          <button class="button" onclick="testAdvancedTechnique()">Test Technique</button>
          
          <div class="result-box" id="advanced-result">
// Advanced technique results will appear here
          </div>
        </div>
      </div>

      <!-- Real-World Scenarios Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-orange); margin-bottom: 15px;" class="en">Level 3: Real-World CORS Scenarios</h3>
        <h3 style="color: var(--neon-orange); margin-bottom: 15px; display:none;" class="hi">Level 3: Vastavik Duniya Ke CORS Udaharan</h3>
        <p class="en">Simulate real-world CORS attacks against APIs, cloud services, and authentication systems.</p>
        <p class="hi" style="display:none;">APIs, cloud services, aur authentication systems ke khilaf vastavik duniya ke CORS attacks ka anukaran karein.</p>
        
        <div class="demo-container">
          <div class="input-group">
            <label for="scenario-type" class="en">Attack Scenario:</label>
            <label for="scenario-type" class="hi" style="display:none;">Hamla Scenario:</label>
            <select id="scenario-type">
              <option value="api">API Data Extraction</option>
              <option value="cloud">Cloud Storage Access</option>
              <option value="auth">Authentication Bypass</option>
              <option value="internal">Internal Network Access</option>
            </select>
          </div>
          
          <div class="code-block">
// Real-world scenarios:
// 1. API Data Extraction: Steal user data from APIs
// 2. Cloud Storage: Access private cloud storage buckets
// 3. Authentication Bypass: bypass authentication mechanisms
// 4. Internal Network: Access internal network resources
          </div>
          
          <button class="button" onclick="testScenario()">Test Scenario</button>
          
          <div class="result-box" id="scenario-result">
// Scenario results will appear here
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Bypass Techniques -->
  <section id="bypass">
    <div class="container">
      <h2 class="section-title en">Bypassing CORS Protections</h2>
      <h2 class="section-title hi" style="display:none;">CORS Protections Ko Kaise Bypass Karein</h2>
      
      <!-- Attack Vector Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">CORS Bypass - Visualization</h3>
        <h3 class="hi" style="display:none;">CORS Bypass - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">CORS Protection</div>
            <div class="hi" style="display:none;">CORS Suraksha</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Origin Validation</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Bypass Techniques</div>
            <div class="hi" style="display:none;">Bypass Tarika</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">DNS, Subdomains, Null</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Data Accessed</div>
            <div class="hi" style="display:none;">Data Pravesh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Bypass Successful</div>
          </div>
        </div>
      </div>

      <!-- Bypass Techniques with Examples -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Advanced Bypass Techniques</h3>
        <h3 class="hi" style="display:none;">Uchatam Bypass Tarika</h3>
        
        <!-- DNS Pinning -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. DNS Pinning</h4>
          <p class="en">Exploit DNS pinning to make requests appear to come from allowed origins.</p>
          <p class="hi" style="display:none;">Anumati prapt origins se aane wale anurodon ko dikhane ke liye DNS pinning ka faida uthayein.</p>
          <div class="code-block">
// DNS pinning technique:
// 1. Control a subdomain of the target domain
// 2. Point DNS to attacker-controlled server
// 3. Make requests from controlled subdomain
// 4. Server allows due to same-origin policy relaxation

// Example: 
// Target allows: *.example.com
// Attacker uses: evil.example.com
          </div>
        </div>
        
        <!-- Null Origin -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Null Origin Exploitation</h4>
          <p class="en">Exploit servers that allow null origins in sandboxed iframes.</p>
          <p class="hi" style="display:none;">Sandboxed iframes mein null origins ko anumati dene wale servers ka faida uthayein.</p>
          <div class="code-block">
// Null origin attack:
// 1. Create a sandboxed iframe with null origin
// 2. Make requests from the iframe
// 3. Server responds with Access-Control-Allow-Origin: null
// 4. Read sensitive data from the response

// Example iframe:
<iframe sandbox="allow-scripts" src="data:text/html,<script>fetch('https://vulnerable-api.com/data')</script>"></iframe>
          </div>
        </div>
        
        <!-- Protocol Switching -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Protocol Switching</h4>
          <p class="en">Exploit inconsistencies between HTTP and HTTPS origins.</p>
          <p class="hi" style="display:none;">HTTP aur HTTPS origins ke beech ke antaralon ka faida uthayein.</p>
          <div class="code-block">
// Protocol switching attack:
// 1. Server allows: http://example.com
// 2. Attacker uses: https://example.com (different origin)
// 3. Server may not properly validate the protocol difference
// 4. Exploit the mismatch to gain access

// Some servers treat http and https as same origin
// due to improper validation
          </div>
        </div>
        
        <!-- Preflight Bypass -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. Preflight Request Bypass</h4>
          <p class="en">Bypass preflight requests using various techniques.</p>
          <p class="hi" style="display:none;">Vibhinn tarikon ka upyog karke preflight requests ko bypass karein.</p>
          <div class="code-block">
// Preflight bypass techniques:
// 1. Use simple requests that don't trigger preflight
// 2. Use GET requests with query parameters instead of POST
// 3. Use form submissions with enctype=text/plain
// 4. Exploit servers that skip preflight for certain origins

// Simple requests conditions:
// - Only GET, HEAD, POST methods
// - Limited set of headers
// - Content-Type: application/x-www-form-urlencoded, multipart/form-data, or text/plain
          </div>
        </div>
      </div>

      <!-- Real-World Case Studies -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Real-World Case Studies</h3>
        <h3 class="hi" style="display:none;">Vastavik Duniya Ke Udaharan</h3>
        
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--neon-green);">Case Study 1: Social Media API</h4>
          <p class="en"><strong>Scenario:</strong> A major social media platform had a misconfigured CORS policy on its API.</p>
          <p class="hi" style="display:none;"><strong>Paristhiti:</strong> Ek pramukh social media platform ki API par galat configure ki gayi CORS policy thi.</p>
          <p class="en"><strong>Exploitation:</strong> Attackers exploited the wildcard CORS configuration to steal user data from authenticated sessions.</p>
          <p class="hi" style="display:none;"><strong>Doharpan:</strong> Hamlawaron ne wildcard CORS configuration ka faida uthakar authenticated sessions se upyogkartri data chura liya.</p>
          <p class="en"><strong>Impact:</strong> Personal information and private messages of millions of users were exposed.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Lakshon upyogkartriyon ki vyaktigat jankari aur niji sandesh expose ho gaye.</p>
        </div>
        
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--electric-blue);">Case Study 2: Cloud Storage Service</h4>
          <p class="en"><strong>Scenario:</strong> A cloud storage service had reflected origin vulnerability in its CORS implementation.</p>
          <p class="hi" style="display:none;"><strong>Paristhiti:</strong> Ek cloud storage service ki CORS implementation mein reflected origin vulnerability thi.</p>
          <p class="en"><strong>Exploitation:</strong> Attackers crafted malicious origins that were reflected in the Access-Control-Allow-Origin header, allowing access to private files.</p>
          <p class="hi" style="display:none;"><strong>Doharpan:</strong> Hamlawaron ne dushit origins banaye jo Access-Control-Allow-Origin header mein reflect kiye gaye, jisse niji files tak pravesh ki anumati mil gayi.</p>
          <p class="en"><strong>Impact:</strong> Sensitive corporate documents and personal files were accessible to attackers.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Sanvedansheel corporate documents aur vyaktigat files hamlawaron ke liye accessible ho gaye.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Protection Bypass -->
  <section id="try-bypass">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Protection Bypass</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Protection Bypass</h2>
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Bypass CORS Protections</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">CORS Protections Ko Bypass Karein</h3>
        <p class="en">Test techniques to bypass various CORS protections implemented by servers.</p>
        <p class="hi" style="display:none;">Servers dwara lagu kiye gaye vibhinn CORS protections ko bypass karne ke tarikon ka parikshan karein.</p>
        
        <div class="demo-container">
          <div class="input-group">
            <label for="protection-type" class="en">Protection Type:</label>
            <label for="protection-type" class="hi" style="display:none;">Suraksha Type:</label>
            <select id="protection-type">
              <option value="wildcard">Wildcard with Credentials</option>
              <option value="origin">Origin Validation</option>
              <option value="null">Null Origin Check</option>
              <option value="preflight">Preflight Validation</option>
            </select>
          </div>
          
          <div class="code-block">
// Common protection methods:
// 1. Wildcard with Credentials: ACAO: * with ACAC: true
// 2. Origin Validation: Checking against whitelist
// 3. Null Origin Check: Allowing/denying null origin
// 4. Preflight Validation: Proper OPTIONS handling
          </div>
          
          <button class="button" onclick="testBypass()">Test Bypass</button>
          
          <div class="result-box" id="bypass-result">
// Bypass results will appear here
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Prevention -->
  <section id="prevention">
    <div class="container">
      <h2 class="section-title en">How to Prevent CORS Vulnerabilities</h2>
      <h2 class="section-title hi" style="display:none;">CORS Vulnerabilities Ko Kaise Rokein</h2>
      
      <!-- Prevention Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">CORS Prevention - Visualization</h3>
        <h3 class="hi" style="display:none;">CORS Bachav - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Malicious Request</div>
            <div class="hi" style="display:none;">Dushit Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Origin: https://evil.com</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Defense Mechanisms</div>
            <div class="hi" style="display:none;">Bachav Yantra</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Origin Validation, Headers</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Request Blocked</div>
            <div class="hi" style="display:none;">Anurodh Blocked</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Protection Successful</div>
          </div>
        </div>
      </div>

      <!-- Secure Coding Practices -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Secure Coding Practices</h3>
        <h3 class="hi" style="display:none;">Surakshit Coding Abhyas</h3>
        
        <!-- Proper Origin Validation -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Proper Origin Validation</h4>
          <p class="en">Validate the Origin header against a whitelist of allowed origins.</p>
          <p class="hi" style="display:none;">Origin header ki anumati prapt origins ki whitelist ke against jaanch karein.</p>
          <div class="code-block">
// Example: Validate origin against whitelist
const allowedOrigins = [
  'https://example.com',
  'https://api.example.com',
  'https://trusted-site.com'
];

function isValidOrigin(origin) {
  return allowedOrigins.includes(origin);
}

// In your server code:
const origin = req.headers.origin;
if (isValidOrigin(origin)) {
  res.setHeader('Access-Control-Allow-Origin', origin);
  res.setHeader('Access-Control-Allow-Credentials', 'true');
} else {
  // Deny the request or don't set CORS headers
}
          </div>
        </div>
        
        <!-- Avoid Wildcards with Credentials -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Avoid Wildcards with Credentials</h4>
          <p class="en">Never use Access-Control-Allow-Origin: * with Access-Control-Allow-Credentials: true.</p>
          <p class="hi" style="display:none;">Access-Control-Allow-Credentials: true ke saath kabhi bhi Access-Control-Allow-Origin: * ka upyog na karein.</p>
          <div class="code-block">
// UNSAFE configuration:
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true

// This allows any website to make authenticated requests
// and read responses, leading to data leakage

// SAFE approach:
// Use a specific origin instead of wildcard
// when credentials are involved
Access-Control-Allow-Origin: https://trusted-site.com
Access-Control-Allow-Credentials: true
          </div>
        </div>
        
        <!-- Proper Preflight Handling -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Proper Preflight Handling</h4>
          <p class="en">Implement proper preflight request handling with validation and appropriate headers.</p>
          <p class="hi" style="display:none;">Validation aur uchit headers ke saath proper preflight request handling lagu karein.</p>
          <div class="code-block">


// Animation on Scroll
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) entry.target.classList.add('visible');
  });
}, { threshold: 0.1 });
document.querySelectorAll('.animate-on-scroll').forEach(el => observer.observe(el));
renderQuiz();
          </div>
        </div>
        
        <!-- Additional Security Headers -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. Additional Security Headers</h4>
          <p class="en">Implement additional security headers to enhance protection against various attacks.</p>
          <p class="hi" style="display:none;">Vibhinn attacks ke khilaf suraksha badhane ke liye adhik suraksha headers lagu karein.</p>
          <div class="code-block">
// Additional security headers:
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Content-Security-Policy: default-src 'self'

// These headers provide defense in depth
// and protect against other attack vectors

// Example in Express.js:
app.use(helmet({
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true
  },
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"]
    }
  }
}));
          </div>
        </div>
      </div>

      <!-- Lab Environment Simulation -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Lab Environment Simulation</h3>
        <h3 class="hi" style="display:none;">Prayogshala Vatavaran Anukaran</h3>
        <p class="en">Test CORS prevention techniques in a safe environment.</p>
        <p class="hi" style="display:none;">Surakshit vatavaran mein CORS bachav tarikon ka parikshan karein.</p>
        
        <div class="interactive-demo animate-on-scroll">
          <h4 style="color: var(--neon-green);">CORS Prevention Testing</h4>
          <div class="demo-container">
            <div class="input-group">
              <label for="prevention-type" class="en">Prevention Type:</label>
              <label for="prevention-type" class="hi" style="display:none;">Bachav Type:</label>
              <select id="prevention-type">
                <option value="whitelist">Origin Whitelisting</option>
                <option value="credentials">Credential Validation</option>
                <option value="preflight">Preflight Validation</option>
                <option value="none">No Protection</option>
              </select>
            </div>
            <button class="button" onclick="testPrevention()" style="position: relative; z-index: 10;">Test Prevention</button>
            <div class="result-box" id="prevention-result">
// Results will appear here
            </div>
          </div>
        </div>
        
        <!-- Interactive Lab Exercise -->
        <div class="interactive-demo animate-on-scroll">
          <h4 style="color: var(--electric-blue);">Interactive Lab Exercise</h4>
          <p class="en">Test different prevention mechanisms against CORS attacks:</p>
          <p class="hi" style="display:none;">CORS attacks ke khilaf alag-alag bachav yantron ka parikshan karein:</p>
          
          <div class="demo-container">
            <div class="input-group">
              <label for="test-prevention" class="en">Test Prevention:</label>
              <label for="test-prevention" class="hi" style="display:none;">Parikshan Bachav:</label>
              <select id="test-prevention">
                <option value="strict">Strict Origin Validation</option>
                <option value="wildcard">Wildcard with Credentials</option>
                <option value="null">Null Origin Handling</option>
                <option value="reflect">Reflected Origin</option>
                <option value="none">No Protection</option>
              </select>
            </div>
            <div style="display: flex; gap: 10px;">
              <button class="button" onclick="testLabPrevention()" style="position: relative; z-index: 10;">Test Prevention</button>
              <button class="button" style="background: var(--neon-orange); position: relative; z-index: 10;" onclick="clearLabResults()">Clear</button>
            </div>
            <div class="result-box" id="lab-result">
// Lab results will appear here
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Quiz -->
  <section id="quiz">
    <div class="container">
      <h2 class="section-title en">Knowledge Check</h2>
      <h2 class="section-title hi" style="display:none;">Jaankari Check Karein</h2>
      <div class="quiz-container animate-on-scroll">
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px;" class="en">Test Your Understanding</h3>
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px; display:none;" class="hi">Apni Samajh Ko Test Karein</h3>
        <div id="quiz-questions">
          <!-- Questions will be injected here -->
        </div>
        <div class="score-display" id="score-display">Score: 0 / 10</div>
        <button class="button quiz-submit" onclick="submitQuiz()">Submit Quiz</button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <h3 class="en">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</h3>
      <h3 class="hi" style="display:none;">Ankush Rana Dwara | HTB Elite Hacker | Senior Security Engineer</h3>
      <p class="en">Breaking Systems. Building Defenses.</p>
      <p class="hi" style="display:none;">Systems todte hain. Defenses banate hain.</p>
      
      <div class="social-links">
        <a href="https://github.com/ankushrana6395" target="_blank" class="social-link github">
          <i class="fab fa-github"></i>
        </a>
        <a href="mailto:ankushrana6395@gmail.com" class="social-link email">
          <i class="fas fa-envelope"></i>
        </a>
        <a href="https://app.hackthebox.com/profile/117501" target="_blank" class="social-link htb">
          <i class="fas fa-cube"></i>
        </a>
      </div>
      
      <p style="margin-top: 30px;" class="en">&copy; 2025 Ankush Rana. All Rights Reserved.</p>
      <p style="margin-top: 30px; display:none;" class="hi">&copy; 2025 Ankush Rana. Sabhi Adhikar Sanchit Hai.</p>
    </div>
  </footer>

  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>
    (function() {
      // Shared variables
      let isHinglish = false;
      
      // Utility functions
      function showNotification(message) {
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');
        if (notification && notificationText) {
          notificationText.textContent = message;
          notification.classList.add('show');
          setTimeout(() => notification.classList.remove('show'), 3000);
        }
      }

      // Card Interaction Functions
      function highlightCard(card) {
        if (!card) return;
        card.classList.add('pop-out');
        const heading = card.querySelector('h3');
        if (heading) {
          showNotification('Hovering: ' + heading.textContent);
        }
      }

      function unhighlightCard(card) {
        if (!card) return;
        if (!card.classList.contains('focused')) {
          card.classList.remove('pop-out');
        }
      }

      function focusCard(card) {
        if (!card) return;
        document.querySelectorAll('.lecture-card').forEach(c => {
          c.classList.remove('focused');
          c.classList.remove('pop-out');
        });
        card.classList.add('focused');
        card.classList.add('pop-out');
        const heading = card.querySelector('h3');
        if (heading) {
          showNotification('Focused on: ' + heading.textContent);
        }
      }

      // Initialize Three.js
    const canvas = document.getElementById('three-canvas');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

    // Grid
    const gridHelper = new THREE.GridHelper(100, 100, 0x00ff88, 0x003322);
    gridHelper.position.z = -20;
    scene.add(gridHelper);

    // Floating Points
    const geometry = new THREE.BufferGeometry();
    const count = 500;
    const positions = new Float32Array(count * 3);
    for (let i = 0; i < count * 3; i++) {
      positions[i] = (Math.random() - 0.5) * 100;
    }
    geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
    const material = new THREE.PointsMaterial({ color: 0x00ff88, size: 0.5, transparent: true, opacity: 0.8 });
    const points = new THREE.Points(geometry, material);
    scene.add(points);

    // Add floating cubes
    const cubeGeometry = new THREE.BoxGeometry(2, 2, 2);
    const cubeMaterial = new THREE.MeshBasicMaterial({ 
      color: 0x00aaff, 
      wireframe: true,
      transparent: true,
      opacity: 0.5
    });
    const cubes = [];
    for (let i = 0; i < 10; i++) {
      const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
      cube.position.x = (Math.random() - 0.5) * 50;
      cube.position.y = (Math.random() - 0.5) * 50;
      cube.position.z = (Math.random() - 0.5) * 50;
      cube.rotation.x = Math.random() * Math.PI;
      cube.rotation.y = Math.random() * Math.PI;
      cubes.push({ mesh: cube, speed: Math.random() * 0.02 });
      scene.add(cube);
    }

    camera.position.z = 30;

    // Animation
    function animate() {
      requestAnimationFrame(animate);
      gridHelper.rotation.y += 0.005;
      points.rotation.y += 0.003;
      cubes.forEach(cube => {
        cube.mesh.rotation.x += cube.speed;
        cube.mesh.rotation.y += cube.speed;
      });
      renderer.render(scene, camera);
    }
    animate();

    // Resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Keyword Modal
    const keywordModal = document.getElementById('keyword-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    const modalClose = document.getElementById('modal-close');
    document.querySelectorAll('.keyword').forEach(keyword => {
      keyword.addEventListener('click', function(e) {
        e.stopPropagation();
        modalTitle.textContent = this.getAttribute('data-title');
        modalBody.textContent = this.getAttribute('data-content');
        keywordModal.classList.add('active');
      });
    });
    modalClose.addEventListener('click', () => {
      keywordModal.classList.remove('active');
    });
    keywordModal.addEventListener('click', (e) => {
      if (e.target === keywordModal) {
        keywordModal.classList.remove('active');
      }
    });

    // Language Toggle
    const translatorBtn = document.getElementById('translator-btn');
    function toggleLanguage() {
      isHinglish = !isHinglish;
      const enElements = document.querySelectorAll('.en');
      const hiElements = document.querySelectorAll('.hi');
      enElements.forEach(el => el.style.display = isHinglish ? 'none' : 'block');
      hiElements.forEach(el => el.style.display = isHinglish ? 'block' : 'none');
      translatorBtn.textContent = isHinglish ? '🌐 English On' : '🌐 Hinglish On';
      showNotification(isHinglish ? 'Hinglish mode activated!' : 'English mode activated!');
      renderQuiz();
    }

    // CORS Demo Functions
    function demoCorsExploit() {
      const targetApi = document.getElementById('target-api').value;
      const attackerOrigin = document.getElementById('attacker-origin').value;
      const result = document.getElementById('cors-result');
      
      result.innerHTML = isHinglish 
        ? `✅ CORS doharpan safal!\n\nServer ne Access-Control-Allow-Origin header mein "${attackerOrigin}" reflect kiya, jisse upyogkartri data tak pravesh mil gaya.\n\nResponse Data: {"user": "ankush", "email": "ankush@example.com", "api_key": "abc123xyz"}` 
        : `✅ CORS exploitation successful!\n\nServer reflected "${attackerOrigin}" in Access-Control-Allow-Origin header, allowing access to user data.\n\nResponse Data: {"user": "ankush", "email": "ankush@example.com", "api_key": "abc123xyz"}`;
      
      showNotification(isHinglish ? 'CORS doharpan safal!' : 'CORS exploitation successful!');
    }

    function testAdvancedTechnique() {
      const technique = document.getElementById('advanced-technique').value;
      const result = document.getElementById('advanced-result');
      
      let message = '';
      
      switch(technique) {
        case 'subdomain':
          message = isHinglish 
            ? '✅ Subdomain takeover safal!\n\nAbandoned subdomain ko claim karke CORS restrictions ko bypass kiya gaya.' 
            : '✅ Subdomain takeover successful!\n\nClaimed abandoned subdomain to bypass CORS restrictions.';
          break;
        case 'dns':
          message = isHinglish 
            ? '✅ DNS pinning safal!\n\nDNS configuration ko manipulate karke requests ko allowed origin se aane ka bana diya gaya.' 
            : '✅ DNS pinning successful!\n\nManipulated DNS configuration to make requests appear from allowed origin.';
          break;
        case 'protocol':
          message = isHinglish 
            ? '✅ Protocol switching safal!\n\nHTTP/HTTPS inconsistencies ka faida uthakar origin validation ko bypass kiya gaya.' 
            : '✅ Protocol switching successful!\n\nExploited HTTP/HTTPS inconsistencies to bypass origin validation.';
          break;
        case 'prefix':
          message = isHinglish 
            ? '✅ Domain prefix matching safal!\n\nDomain prefix wildcards ka galat upyog karke CORS policy ko bypass kiya gaya.' 
            : '✅ Domain prefix matching successful!\n\nAbused domain prefix wildcards to bypass CORS policy.';
          break;
      }
      
      result.innerHTML = message;
      showNotification(isHinglish ? 'Advanced technique safal!' : 'Advanced technique successful!');
    }

    function testScenario() {
      const scenario = document.getElementById('scenario-type').value;
      const result = document.getElementById('scenario-result');
      
      let message = '';
      
      switch(scenario) {
        case 'api':
          message = isHinglish 
            ? '✅ API data extraction safal!\n\nCORS misconfiguration ka faida uthakar API se sanvedansheel user data extract kiya gaya.' 
            : '✅ API data extraction successful!\n\nExploited CORS misconfiguration to extract sensitive user data from API.';
          break;
        case 'cloud':
          message = isHinglish 
            ? '✅ Cloud storage access safal!\n\nCORS vulnerability ka faida uthakar private cloud storage buckets tak pravesh mil gaya.' 
            : '✅ Cloud storage access successful!\n\nExploited CORS vulnerability to access private cloud storage buckets.';
          break;
        case 'auth':
          message = isHinglish 
            ? '✅ Authentication bypass safal!\n\nCORS misconfiguration ka upyog karke authentication mechanisms ko bypass kiya gaya.' 
            : '✅ Authentication bypass successful!\n\nUsed CORS misconfiguration to bypass authentication mechanisms.';
          break;
        case 'internal':
          message = isHinglish 
            ? '✅ Internal network access safal!\n\nCORS vulnerability ke through internal network resources tak pravesh mil gaya.' 
            : '✅ Internal network access successful!\n\nGained access to internal network resources through CORS vulnerability.';
          break;
      }
      
      result.innerHTML = message;
      showNotification(isHinglish ? 'Scenario test safal!' : 'Scenario test successful!');
    }

    function testBypass() {
      const protectionType = document.getElementById('protection-type').value;
      const result = document.getElementById('bypass-result');
      
      let message = '';
      
      switch(protectionType) {
        case 'wildcard':
          message = isHinglish 
            ? '✅ Wildcard with credentials bypass safal!\n\nBrowser security restrictions ko exploit karke wildcard configuration se data extract kiya gaya.' 
            : '✅ Wildcard with credentials bypass successful!\n\nExploited browser security restrictions to extract data from wildcard configuration.';
          break;
        case 'origin':
          message = isHinglish 
            ? '✅ Origin validation bypass safal!\n\nOrigin validation implementation flaws ka faida uthakar allowed origin ka bana diya gaya.' 
            : '✅ Origin validation bypass successful!\n\nExploited origin validation implementation flaws to appear as allowed origin.';
          break;
        case 'null':
          message = isHinglish 
            ? '✅ Null origin check bypass safal!\n\nSandboxed iframes aur data URLs ka upyog karke null origin restrictions ko bypass kiya gaya.' 
            : '✅ Null origin check bypass successful!\n\nUsed sandboxed iframes and data URLs to bypass null origin restrictions.';
          break;
        case 'preflight':
          message = isHinglish 
            ? '✅ Preflight validation bypass safal!\n\nSimple requests aur header manipulation ka upyog karke preflight checks ko avoid kiya gaya.' 
            : '✅ Preflight validation bypass successful!\n\nUsed simple requests and header manipulation to avoid preflight checks.';
          break;
      }
      
      result.innerHTML = message;
      showNotification(isHinglish ? 'Bypass test safal!' : 'Bypass test successful!');
    }

    // Quiz Questions (10 Questions)
    const quizQuestions = [
      {
        question: {
          en: "What does CORS stand for?",
          hi: "CORS ka matlab kya hai?"
        },
        options: {
          en: [
            "Cross-Origin Resource Sharing",
            "Cross-Origin Request Security",
            "Cross-Origin Response System",
            "Cross-Origin Retrieval Service"
          ],
          hi: [
            "Cross-Origin Resource Sharing",
            "Cross-Origin Request Security",
            "Cross-Origin Response System",
            "Cross-Origin Retrieval Service"
          ]
        },
        correct: 0,
        explanation: {
          en: "CORS stands for Cross-Origin Resource Sharing, a mechanism for cross-domain requests.",
          hi: "CORS ka matlab hai Cross-Origin Resource Sharing, cross-domain requests ke liye ek yantra."
        }
      },
      {
        question: {
          en: "Which header is used by the server to indicate allowed origins?",
          hi: "Server dwara anumati prapt origins ko indicate karne ke liye kaunsa header upyog hota hai?"
        },
        options: {
          en: [
            "Access-Control-Allow-Origin",
            "Access-Control-Allow-Methods",
            "Access-Control-Allow-Headers",
            "Access-Control-Allow-Credentials"
          ],
          hi: [
            "Access-Control-Allow-Origin",
            "Access-Control-Allow-Methods",
            "Access-Control-Allow-Headers",
            "Access-Control-Allow-Credentials"
          ]
        },
        correct: 0,
        explanation: {
          en: "Access-Control-Allow-Origin header specifies which origins are allowed to access the resource.",
          hi: "Access-Control-Allow-Origin header nirdharit karta hai ki kaunse origins ko resource tak pravesh ki anumati hai."
        }
      },
      {
        question: {
          en: "Why is Access-Control-Allow-Origin: * with credentials dangerous?",
          hi: "Access-Control-Allow-Origin: * credentials ke saath kyun khatarnaak hai?"
        },
        options: {
          en: [
            "It allows any website to make authenticated requests",
            "It slows down the server performance",
            "It exposes server version information",
            "It prevents caching of resources"
          ],
          hi: [
            "Yeh kisi bhi website ko authenticated requests banane ki anumati deta hai",
            "Yeh server performance ko slow karta hai",
            "Yeh server version information expose karta hai",
            "Yeh resources ke caching ko rokta hai"
          ]
        },
        correct: 0,
        explanation: {
          en: "Using wildcard with credentials allows any website to make authenticated requests and read responses, leading to data leakage.",
          hi: "Credentials ke saath wildcard ka upyog kisi bhi website ko authenticated requests banane aur responses padhne ki anumati deta hai, jisse data leakage hoti hai."
        }
      },
      {
        question: {
          en: "What is a preflight request?",
          hi: "Preflight request kya hoti hai?"
        },
        options: {
          en: [
            "An OPTIONS request to check what requests are allowed",
            "A GET request to preload resources",
            "A HEAD request to check if resources exist",
            "A POST request to initialize a session"
          ],
          hi: [
            "Yeh jaanchne ke liye ek OPTIONS request hai ki kaunse requests anumati prapt hain",
            "Resources ko preload karne ke liye ek GET request",
            "Yeh jaanchne ke liye ek HEAD request hai ki resources exist karte hain ya nahi",
            "Session initialize karne ke liye ek POST request"
          ]
        },
        correct: 0,
        explanation: {
          en: "A preflight request is an OPTIONS request sent by the browser to determine what HTTP methods and headers are allowed for cross-origin requests.",
          hi: "Preflight request ek OPTIONS request hai jo browser dwara bheji jati hai yeh nirdharit karne ke liye ki cross-origin requests ke liye kaunse HTTP methods aur headers anumati prapt hain."
        }
      },
      {
        question: {
          en: "Which of these is NOT a safe CORS configuration?",
          hi: "Inmein se kaunsa surakshit CORS configuration nahi hai?"
        },
        options: {
          en: [
            "Access-Control-Allow-Origin: * with credentials",
            "Access-Control-Allow-Origin: https://example.com",
            "Validating Origin against a whitelist",
            "Using specific origins instead of wildcards"
          ],
          hi: [
            "Access-Control-Allow-Origin: * credentials ke saath",
            "Access-Control-Allow-Origin: https://example.com",
            "Origin ki whitelist ke against jaanch karna",
            "Wildcards ke bajaye specific origins ka upyog karna"
          ]
        },
        correct: 0,
        explanation: {
          en: "Access-Control-Allow-Origin: * with credentials is dangerous as it allows any website to make authenticated requests.",
          hi: "Access-Control-Allow-Origin: * credentials ke saath khatarnaak hai kyunki yeh kisi bhi website ko authenticated requests banane ki anumati deta hai."
        }
      },
      {
        question: {
          en: "What is the purpose of the Access-Control-Allow-Credentials header?",
          hi: "Access-Control-Allow-Credentials header ka uddeshya kya hai?"
        },
        options: {
          en: [
            "To indicate whether credentials can be included in requests",
            "To specify which credentials are allowed",
            "To encrypt credentials in transit",
            "To store credentials on the client"
          ],
          hi: [
            "Yeh indicate karne ke liye ki kya requests mein credentials shaamil ki ja sakti hain",
            "Yeh specify karne ke liye ki kaunsi credentials anumati prapt hain",
            "Transit mein credentials ko encrypt karne ke liye",
            "Client par credentials store karne ke liye"
          ]
        },
        correct: 0,
        explanation: {
          en: "Access-Control-Allow-Credentials indicates whether the browser should include credentials (cookies, authorization headers) in cross-origin requests.",
          hi: "Access-Control-Allow-Credentials yeh indicate karta hai ki kya browser ko cross-origin requests mein credentials (cookies, authorization headers) shaamil karni chahiye."
        }
      },
      {
        question: {
          en: "How can you prevent CORS vulnerabilities?",
          hi: "Aap CORS vulnerabilities ko kaise rok sakte hain?"
        },
        options: {
          en: [
            "Validate Origin against a whitelist",
            "Use Access-Control-Allow-Origin: *",
            "Disable all CORS headers",
            "Allow credentials with wildcard origins"
          ],
          hi: [
            "Origin ki whitelist ke against jaanch karein",
            "Access-Control-Allow-Origin: * ka upyog karein",
            "Sabhi CORS headers ko disable karein",
            "Wildcard origins ke saath credentials allow karein"
          ]
        },
        correct: 0,
        explanation: {
          en: "Validating the Origin header against a whitelist of allowed origins is a key prevention measure against CORS vulnerabilities.",
          hi: "Origin header ki anumati prapt origins ki whitelist ke against jaanch karna CORS vulnerabilities ke khilaf ek mukhya bachav upay hai."
        }
      },
      {
        question: {
          en: "What is a reflected Origin vulnerability?",
          hi: "Reflected Origin vulnerability kya hoti hai?"
        },
        options: {
          en: [
            "When the server reflects the Origin header without validation",
            "When the Origin header is missing from requests",
            "When the Origin header is encrypted",
            "When the Origin header is too long"
          ],
          hi: [
            "Jab server bina jaanch ke Origin header ko reflect kar deta hai",
            "Jab requests mein Origin header missing hota hai",
            "Jab Origin header encrypted hota hai",
            "Jab Origin header bahut lamba hota hai"
          ]
        },
        correct: 0,
        explanation: {
          en: "A reflected Origin vulnerability occurs when the server blindly reflects the Origin header value in the Access-Control-Allow-Origin response header without proper validation.",
          hi: "Reflected Origin vulnerability tab hoti hai jab server bina uchit jaanch ke Origin header value ko Access-Control-Allow-Origin response header mein reflect kar deta hai."
        }
      },
      {
        question: {
          en: "Which technique can be used to bypass Origin validation?",
          hi: "Origin validation ko bypass karne ke liye kaunsa technique upyog kiya ja sakta hai?"
        },
        options: {
          en: [
            "DNS pinning",
            "HTML encoding",
            "Password cracking",
            "SQL injection"
          ],
          hi: [
            "DNS pinning",
            "HTML encoding",
            "Password cracking",
            "SQL injection"
          ]
        },
        correct: 0,
        explanation: {
          en: "DNS pinning can be used to make requests appear to come from allowed origins, bypassing Origin validation.",
          hi: "DNS pinning ka upyog requests ko anumati prapt origins se aane ka dikhane ke liye kiya ja sakta hai, jisse Origin validation bypass ho jati hai."
        }
      },
      {
        question: {
          en: "What should you do if you don't need cross-origin requests?",
          hi: "Agar aapko cross-origin requests ki zaroorat nahi hai toh aapko kya karna chahiye?"
        },
        options: {
          en: [
            "Not set any CORS headers",
            "Set Access-Control-Allow-Origin: *",
            "Set Access-Control-Allow-Origin: null",
            "Set Access-Control-Allow-Credentials: true"
          ],
          hi: [
            "Koi bhi CORS headers set na karein",
            "Access-Control-Allow-Origin: * set karein",
            "Access-Control-Allow-Origin: null set karein",
            "Access-Control-Allow-Credentials: true set karein"
          ]
        },
        correct: 0,
        explanation: {
          en: "If you don't need cross-origin requests, you should not set any CORS headers, which will enforce the same-origin policy.",
          hi: "Agar aapko cross-origin requests ki zaroorat nahi hai, toh aapko koi bhi CORS headers set nahi karna chahiye, jisse same-origin policy lagu hogi."
        }
      }
    ];

    // Render Quiz
    function renderQuiz() {
      const quizContainer = document.getElementById('quiz-questions');
      quizContainer.innerHTML = '';
      quizQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'quiz-question';
        const qText = isHinglish ? q.question.hi : q.question.en;
        const opts = isHinglish ? q.options.hi : q.options.en;
        questionDiv.innerHTML = `
          <h4>Q${index + 1}: ${qText}</h4>
          <div class="options" id="options-${index}">
            ${opts.map((opt, i) => `
              <div class="option" onclick="selectOption(${index}, ${i})">${opt}</div>
            `).join('')}
          </div>
        `;
        quizContainer.appendChild(questionDiv);
      });
    }

    // Lab functions
    function testPrevention() {
      const preventionType = document.getElementById('prevention-type').value;
      const result = document.getElementById('prevention-result');

      let message = '';

      if (preventionType === 'none') {
        message = isHinglish
          ? `❌ Koi suraksha nahi!\n\nCORS attack safal hoga kyunki koi bachav upay nahi hai.`
          : `❌ No protection!\n\nCORS attack will succeed because no protection is in place.`;
      } else {
        message = isHinglish
          ? `✅ ${preventionType.toUpperCase()} suraksha lagoo hai!\n\nCORS attack rok diya gaya.`
          : `✅ ${preventionType.toUpperCase()} protection applied!\n\nCORS attack prevented.`;
      }

      result.innerHTML = message;
    }

    function testLabPrevention() {
      const preventionType = document.getElementById('test-prevention').value;
      const result = document.getElementById('lab-result');

      let message = '';

      if (preventionType === 'none' || preventionType === 'wildcard' || preventionType === 'reflect') {
        message = isHinglish
          ? `❌ ${preventionType.toUpperCase()} suraksha prabhavi nahi hai!\n\nCORS attack safal hoga.`
          : `❌ ${preventionType.toUpperCase()} protection not effective!\n\nCORS attack will succeed.`;
      } else {
        message = isHinglish
          ? `✅ ${preventionType.toUpperCase()} suraksha prabhavi hai!\n\nCORS attack rok diya gaya.`
          : `✅ ${preventionType.toUpperCase()} protection effective!\n\nCORS attack prevented.`;
      }

      result.innerHTML = message;
    }

    function clearLabResults() {
      document.getElementById('lab-result').textContent = '// Lab results will appear here';
    }

    // Quiz functions - missing feedback element
    function initQuiz() {
      document.getElementById('feedback').innerHTML = '';
      document.getElementById('feedback').style.display = 'none';
    }

    // Track selected answers
    const selectedAnswers = new Array(quizQuestions.length).fill(-1);

    // Select Option
    window.selectOption = function(questionIndex, optionIndex) {
      document.querySelectorAll(`#options-${questionIndex} .option`).forEach(opt => {
        opt.classList.remove('selected');
      });
      document.querySelectorAll(`#options-${questionIndex} .option`)[optionIndex].classList.add('selected');
      selectedAnswers[questionIndex] = optionIndex;
    };

    // Submit Quiz
    window.submitQuiz = function() {
      let score = 0;
      const feedbackDiv = document.createElement('div');
      feedbackDiv.id = 'feedback';
      feedbackDiv.style.display = 'block';
      document.getElementById('quiz-questions').appendChild(feedbackDiv);

      quizQuestions.forEach((q, index) => {
        const options = document.querySelectorAll(`#options-${index} .option`);
        const explanation = isHinglish ? q.explanation.hi : q.explanation.en;

        if (selectedAnswers[index] === q.correct) {
          score++;
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1) options[selectedAnswers[index]].classList.add('correct');
        } else {
          options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1 && selectedAnswers[index] !== q.correct) {
            options[selectedAnswers[index]].classList.add('incorrect');
          }
        }

        feedbackDiv.innerHTML += `<strong>Q${index + 1}:</strong> ${explanation}<br><br>`;
      });

      document.getElementById('score-display').textContent = `Score: ${score} / ${quizQuestions.length}`;
      showNotification(isHinglish ? `Quiz pura! Score: ${score}/${quizQuestions.length}` : `Quiz complete! You scored ${score}/${quizQuestions.length}`);
    };

    // Notification
    function showNotification(message) {
      const notification = document.getElementById('notification');
      const notificationText = document.getElementById('notification-text');
      if (notification && notificationText) {
        notificationText.textContent = message;
        notification.classList.add('show');
        setTimeout(() => notification.classList.remove('show'), 3000);
      }
    }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
          // Wait for lecture content to load
          const checkContentLoaded = setInterval(() => {
            const lectureContent = document.querySelector('.lecture-card');
            if (!lectureContent) return;
            
            clearInterval(checkContentLoaded);
            initLectureContent();
          }, 100);
  
          function initLectureContent() {
            // Initialize Three.js
            const canvas = document.getElementById('three-canvas');
            if (canvas) {
              // ... existing Three.js initialization code ...
            }
  
            // Scroll Progress Bar
            window.addEventListener('scroll', () => {
              const progressBar = document.getElementById('progress-bar');
              if (progressBar) {
                const winHeight = window.innerHeight;
                const docHeight = document.documentElement.scrollHeight;
                const scrollTop = window.pageYOffset;
                const trackLength = docHeight - winHeight;
                const progress = scrollTop / trackLength * 100;
                progressBar.style.width = progress + '%';
              }
            });
  
            // ... rest of initialization code ...
  
            // Expose needed functions to global scope
            window.toggleLanguage = toggleLanguage;
            window.demoCorsExploit = demoCorsExploit;
            window.testAdvancedTechnique = testAdvancedTechnique;
            window.testScenario = testScenario;
            window.testBypass = testBypass;
            window.selectOption = selectOption;
            window.submitQuiz = submitQuiz;
            window.testPrevention = testPrevention;
            window.testLabPrevention = testLabPrevention;
            window.clearLabResults = clearLabResults;
          }
        });
  
        // Language Toggle
        function toggleLanguage() {
          isHinglish = !isHinglish;
          const enElements = document.querySelectorAll('.en');
          const hiElements = document.querySelectorAll('.hi');
          enElements.forEach(el => el.style.display = isHinglish ? 'none' : 'block');
          hiElements.forEach(el => el.style.display = isHinglish ? 'block' : 'none');
          const translatorBtn = document.getElementById('translator-btn');
          if (translatorBtn) {
            translatorBtn.textContent = isHinglish ? '🌐 English On' : '🌐 Hinglish On';
          }
          showNotification(isHinglish ? 'Hinglish mode activated!' : 'English mode activated!');
          renderQuiz();
        }
  
        // ... include all other existing functions here ...
  
      })();

      // Animation on Scroll
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) entry.target.classList.add('visible');
        });
      }, { threshold: 0.1 });
      document.querySelectorAll('.animate-on-scroll').forEach(el => observer.observe(el));
      renderQuiz();

      // Lab functions
      window.testPrevention = function() {
      const preventionType = document.getElementById('prevention-type').value;
      const result = document.getElementById('prevention-result');
      
      let message = '';
      
      if (preventionType === 'none') {
        message = isHinglish 
          ? `❌ Koi suraksha nahi!\n\nCORS attack safal hoga kyunki koi bachav upay nahi hai.` 
          : `❌ No protection!\n\nCORS attack will succeed because no protection is in place.`;
      } else {
        message = isHinglish 
          ? `✅ ${preventionType.toUpperCase()} suraksha lagoo hai!\n\nCORS attack rok diya gaya.` 
          : `✅ ${preventionType.toUpperCase()} protection applied!\n\nCORS attack prevented.`;
      }
      
      result.innerHTML = message;
    }

      window.testLabPrevention = function() {
      const preventionType = document.getElementById('test-prevention').value;
      const result = document.getElementById('lab-result');
      
      let message = '';
      
      if (preventionType === 'none' || preventionType === 'wildcard' || preventionType === 'reflect') {
        message = isHinglish 
          ? `❌ ${preventionType.toUpperCase()} suraksha prabhavi nahi hai!\n\nCORS attack safal hoga.` 
          : `❌ ${preventionType.toUpperCase()} protection not effective!\n\nCORS attack will succeed.`;
      } else {
        message = isHinglish 
          ? `✅ ${preventionType.toUpperCase()} suraksha prabhavi hai!\n\nCORS attack rok diya gaya.` 
          : `✅ ${preventionType.toUpperCase()} protection effective!\n\nCORS attack prevented.`;
      }
      
      result.innerHTML = message;
    }

      window.clearLabResults = function() {
      document.getElementById('lab-result').textContent = '// Lab results will appear here';
    }
      // Expose functions to global scope that are called from HTML
      window.toggleLanguage = toggleLanguage;
      window.demoCorsExploit = demoCorsExploit;
      window.testAdvancedTechnique = testAdvancedTechnique;
      window.testScenario = testScenario;
      window.testBypass = testBypass;
      window.selectOption = selectOption;
      window.submitQuiz = submitQuiz;
    
  </script>
</body>
</html>
