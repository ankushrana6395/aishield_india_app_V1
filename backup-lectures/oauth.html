<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Interactive OAuth 2.0 Authentication Masterclass with Live Hinglish Translation | Quiz | Try It Yourself | By HTB Elite Hacker">
  <title>OAuth 2.0 | By Ankush Rana</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;600;700;900&family=Roboto:wght@300;400;500;700&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --primary: #0a1121;
      --dark-navy: #0b1b30;
      --neon-green: #00ff88;
      --electric-blue: #00aaff;
      --neon-orange: #ff8800;
      --neon-pink: #ff0080;
      --glow-green: rgba(0, 255, 136, 0.3);
      --glow-blue: rgba(0, 170, 255, 0.2);
      --glow-pink: rgba(255, 0, 128, 0.3);
      --light-gray: #e0e0e0;
      --mid-gray: #aaaaaa;
      --card-bg: #111c30;
      --border: #2a4060;
      --keyword: #ffdd57;
      --keyword-bg: rgba(255, 221, 87, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--primary);
      color: var(--light-gray);
      line-height: 1.7;
      overflow-x: hidden;
    }

    /* Three.js Background */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Translator Button */
    .translator-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      box-shadow: 0 0 15px var(--glow-green);
      transition: all 0.3s ease;
    }

    .translator-btn:hover {
      transform: translateY(-2px);
      background: #00cc6d;
    }

    /* Header / Hero */
    header {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-content {
      z-index: 2;
      max-width: 900px;
      position: relative;
    }

    .hero-content h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2.8rem, 8vw, 4rem);
      color: white;
      margin-bottom: 10px;
      text-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
      50% { text-shadow: 0 0 25px rgba(0, 255, 136, 0.9), 0 0 35px rgba(0, 255, 136, 0.5); }
      100% { text-shadow: 0 0 15px rgba(0, 255, 136, 0.6); }
    }

    .hero-content h1 span {
      color: var(--neon-green);
    }

    .subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: clamp(1.2rem, 3.5vw, 1.5rem);
      color: var(--electric-blue);
      margin: 15px 0;
    }

    /* Section Styling */
    section {
      padding: 100px 0;
      position: relative;
    }

    .section-title {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(2rem, 5vw, 2.5rem);
      color: var(--neon-green);
      margin-bottom: 50px;
      position: relative;
      display: inline-block;
    }

    .section-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -8px;
      width: 70px;
      height: 4px;
      background: var(--electric-blue);
      animation: expand 2s infinite;
    }

    @keyframes expand {
      0% { width: 70px; }
      50% { width: 100px; }
      100% { width: 70px; }
    }

    /* Lecture Card */
    .lecture-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 30px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .lecture-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(0, 255, 136, 0.05), transparent);
      z-index: 0;
    }

    .lecture-card.pop-out {
      transform: translateY(-20px) scale(1.05);
      box-shadow: 
        0 30px 60px rgba(0, 0, 0, 0.5),
        0 0 50px var(--glow-green);
      border-color: var(--neon-green);
      z-index: 5;
    }

    .lecture-card.focused {
      transform: translateY(-20px) scale(1.06);
      box-shadow: 
        0 40px 80px rgba(0, 0, 0, 0.6),
        0 0 70px var(--glow-green);
      filter: brightness(1.1);
    }

    .lecture-card h3 {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 18px;
      font-size: 1.8rem;
      position: relative;
      z-index: 2;
    }

    /* Keyword Style */
    .keyword {
      background: var(--keyword-bg);
      color: var(--keyword);
      padding: 3px 8px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 1px dashed var(--keyword);
      position: relative;
      transition: all 0.3s ease;
      z-index: 2;
    }

    .keyword:hover {
      background: rgba(255, 221, 87, 0.3);
      box-shadow: 0 0 12px rgba(255, 221, 87, 0.4);
    }

    /* Tooltip (Modal) */
    .keyword-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 17, 33, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .keyword-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border: 2px solid var(--neon-green);
      border-radius: 14px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 50px var(--glow-green);
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .keyword-modal.active .modal-content {
      transform: scale(1);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--neon-green);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .modal-title {
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .modal-body {
      color: var(--light-gray);
      line-height: 1.6;
    }

    /* Interactive Demo */
    .interactive-demo {
      background: rgba(0, 20, 40, 0.6);
      border-radius: 10px;
      padding: 25px;
      margin: 30px 0;
      border: 1px solid var(--electric-blue);
    }

    .demo-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .input-group label {
      min-width: 120px;
      font-family: 'JetBrains Mono', monospace;
      color: var(--neon-green);
    }

    .input-group input {
      flex: 1;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: white;
      font-family: 'JetBrains Mono', monospace;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--neon-green);
      box-shadow: 0 0 10px var(--glow-green);
    }

    .button {
      padding: 12px 24px;
      background: var(--neon-green);
      color: var(--primary);
      border: none;
      border-radius: 4px;
      font-family: 'Orbitron', sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: fit-content;
    }

    .button:hover {
      background: #00cc6d;
      box-shadow: 0 0 15px var(--glow-green);
      transform: translateY(-2px);
    }

    .result-box {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 6px;
      padding: 15px;
      margin-top: 15px;
      border-left: 3px solid var(--neon-green);
      font-family: 'JetBrains Mono', monospace;
      min-height: 100px;
      overflow-x: auto;
      white-space: pre-wrap;
    }

    /* Diagram */
    .diagram {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
      flex-wrap: wrap;
    }

    .box {
      min-width: 140px;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      font-weight: bold;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }

    .box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
    }

    .box:hover::before {
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }

    .user-input { background: #8b0000; color: white; }
    .app { background: #003366; color: white; }
    .db { background: #004d00; color: #00ff88; }

    .arrow {
      font-size: 1.8rem;
      color: var(--neon-green);
      position: relative;
    }

    .arrow::before {
      content: '→';
      animation: arrow-pulse 1.5s infinite;
    }

    @keyframes arrow-pulse {
      0% { text-shadow: 0 0 5px var(--neon-green); }
      50% { text-shadow: 0 0 15px var(--neon-green); }
      100% { text-shadow: 0 0 5px var(--neon-green); }
    }

    /* Code Block */
    .code-block {
      background: #001a1a;
      color: #00ff88;
      font-family: 'JetBrains Mono', monospace;
      padding: 15px;
      border-radius: 10px;
      overflow-x: auto;
      margin: 15px 0;
      border-left: 4px solid var(--neon-green);
      position: relative;
    }

    .code-block::before {
      content: 'CODE';
      position: absolute;
      top: 0;
      right: 0;
      background: var(--neon-green);
      color: var(--primary);
      font-size: 0.7rem;
      padding: 2px 8px;
      border-bottom-left-radius: 4px;
      font-weight: bold;
    }

    /* Statistics Section */
    .stats-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin: 30px 0;
    }

    .stat-box {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 20px;
      min-width: 200px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      border-color: var(--neon-green);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .stat-label {
      color: var(--mid-gray);
      font-size: 0.9rem;
    }

    /* Quiz Section */
    .quiz-container {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 25px;
      margin: 30px 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .quiz-question {
      margin-bottom: 20px;
    }

    .quiz-question h4 {
      color: var(--neon-green);
      margin-bottom: 10px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .option:hover {
      background: rgba(0, 255, 136, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.2);
    }

    .option.selected {
      background: var(--neon-green);
      color: var(--primary);
      font-weight: bold;
    }

    .score-display {
      text-align: center;
      font-size: 1.5rem;
      margin: 20px 0;
      color: var(--neon-green);
      font-family: 'Orbitron', sans-serif;
    }

    .button.quiz-submit {
      background: var(--neon-orange);
      color: white;
    }

    .button.quiz-submit:hover {
      background: #cc7000;
    }

    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: transparent;
      z-index: 1000;
    }

    .progress-bar {
      height: 100%;
      background: var(--neon-green);
      width: 0%;
      transition: width 0.3s ease;
    }

    /* Notification */
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--neon-green);
      border-radius: 8px;
      padding: 15px;
      color: var(--light-gray);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transform: translateY(100px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .notification.show {
      transform: translateY(0);
      opacity: 1;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 60px 0;
      background: var(--dark-navy);
      color: var(--mid-gray);
      position: relative;
      overflow: hidden;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--neon-green), var(--electric-blue), var(--neon-pink));
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .social-link {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .social-link:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .social-link.github:hover { background: var(--neon-green); color: var(--primary); }
    .social-link.email:hover { background: var(--electric-blue); }
    .social-link.htb:hover { background: var(--neon-orange); }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-content h1 { font-size: 2.8rem; }
      .section-title { font-size: 1.8rem; }
      .diagram { flex-direction: column; }
      .arrow::before { content: '↓'; }
      .input-group { flex-direction: column; }
      .input-group label { min-width: auto; }
    }
  </style>
</head>
<body>

  <!-- Progress Bar -->
  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>

  <!-- Translator Button -->
  <button class="translator-btn" id="translator-btn-top" onclick="toggleLanguage()" style="right: auto; left: 20px;">
    🌐 Hinglish On
  </button>

  <!-- Keyword Modal -->
  <div class="keyword-modal" id="keyword-modal">
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h3 class="modal-title" id="modal-title">Keyword</h3>
      <div class="modal-body" id="modal-body">Definition will appear here.</div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <i class="fas fa-info-circle"></i> <span id="notification-text">Welcome to the OAuth 2.0 Masterclass!</span>
  </div>

  <!-- Three.js Background Canvas -->
  <canvas id="three-canvas"></canvas>

  <!-- Header / Hero -->
  <header id="home">
    <div class="container">
      <div class="hero-content"><!-- English Version -->
        <div class="en">
          <h1>OAuth 2.0 <span>Authentication</span></h1>
          <div class="subtitle">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</div>
          <p>A deep dive into OAuth 2.0 flows, common misconfigurations, and real-world exploitation — with interactive demos and elite-level insights.</p>
        </div>

        <!-- Hinglish Version -->
        <div class="hi" style="display:none;">
          <h1>OAuth 2.0 <span>Authentication</span></h1>
          <div class="subtitle">Ankush Rana द्वारा | HTB Elite Hacker | Senior Security Engineer</div>
          <p>OAuth 2.0 flows, common misconfigurations, aur real-world exploitation mein gahrai se jaane — interactive demos aur elite-level samajh ke saath.</p>
        </div>

        <!-- HTB & Bug Bounty Credibility -->
        <div style="margin-top: 40px; display: flex; align-items: center; gap: 25px; flex-wrap: wrap; justify-content: center; font-family: 'JetBrains Mono', monospace;">
          <img src="https://www.hackthebox.com/storage/achievements/elite_2024_badge.svg" alt="HTB Elite" style="width: 90px; filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
          <div style="text-align: center;">
            <img src="https://via.placeholder.com/100/0a1121/00ff88?text=AR" alt="Ankush Rana" style="width: 80px; height: 80px; border-radius: 50%; border: 2px solid var(--neon-green); filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.5));">
            <p style="margin: 5px 0 0; color: var(--neon-green);">52+ User Flags</p>
            <p style="margin: 0; color: var(--electric-blue);">47+ Root Owned</p>
          </div>
          <div style="text-align: center;">
            <p style="color: var(--neon-orange);">🏆 Top 10 India</p>
            <p style="color: var(--neon-pink);">💼 Sattrix | GPSSI</p>
          </div>
        </div>

        <!-- Call to Action -->
        <div style="margin-top: 30px; font-family: 'Orbitron', sans-serif; color: var(--electric-blue);">
          <i class="fas fa-mouse-pointer"></i> Toggle Hinglish Mode → <strong>Top Right Corner</strong>
        <div style="display: flex; justify-content: center; margin-top: 10px;"><button class="translator-btn" id="translator-btn" onclick="toggleLanguage()" style="position: relative; margin: 0 auto;">🌐 Hinglish On</button></div>
        </div>
      </div>
    </div>
  </header>

  <!-- Section: What is OAuth 2.0? -->
  <section id="basics">
    <div class="container">
      <h2 class="section-title en">What is OAuth 2.0?</h2>
      <h2 class="section-title hi" style="display:none;">OAuth 2.0 Kya Hai?</h2>
      
      <!-- Progress Tracker -->
      <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
        <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-green);">1</div>
          <div class="step-title en">Basic Concepts</div>
          <div class="step-title hi" style="display:none;">Mool Baat</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--electric-blue);">2</div>
          <div class="step-title en">Attack Vectors</div>
          <div class="step-title hi" style="display:none;">Hamlawar Ke Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-orange);">3</div>
          <div class="step-title en">Advanced Techniques</div>
          <div class="step-title hi" style="display:none;">Uchatam Tarika</div>
        </div>
        <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 0, 128, 0.1); border: 1px solid var(--neon-pink); border-radius: 8px; margin: 0 5px;">
          <div class="step-number" style="font-size: 1.5rem; color: var(--neon-pink);">4</div>
          <div class="step-title en">Prevention</div>
          <div class="step-title hi" style="display:none;">Bachav</div>
        </div>
      </div>

      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">The Authorization Analogy</h3>
        <h3 class="hi" style="display:none;">Authorization Wala Scene</h3>
        <p class="en">OAuth 2.0 is an authorization framework that allows third-party applications to obtain limited access to an HTTP service on behalf of a resource owner — like giving a valet key to a parking attendant.</p>
        <p class="hi" style="display:none;">OAuth 2.0 ek authorization framework hai jo third-party applications ko resource owner ke behalf par HTTP service tak limited access pradan karta hai — jaise parking attendant ko valet key dena.</p>
        <p class="en"><strong>Real Analogy:</strong> You don't give your house keys to a housekeeper, but you give them a key that only opens certain rooms.</p>
        <p class="hi" style="display:none;"><strong>Asli Example:</strong> Tum apne ghar ki chaabi housekeeper ko nahi dete, lekin unhe ek aisi chaabi dete ho jo sirf kuch kamre kholti hai.</p>
        <p class="en">If misconfigured, OAuth 2.0 can lead to account takeover, unauthorized data access, and privilege escalation.</p>
        <p class="hi" style="display:none;">Agar galat configure kiya gaya, toh OAuth 2.0 account takeover, unauthorized data access, aur privilege escalation ka karan ban sakta hai.</p>
        <p class="en"><span class="keyword" data-title="OAuth 2.0" data-content="An open standard for access delegation, commonly used as a way for Internet users to grant websites or applications access to their information on other websites without giving them the passwords.">OAuth 2.0</span> is critical because it's widely used but often poorly implemented.</p>
        <p class="hi" style="display:none;"><span class="keyword" data-title="OAuth 2.0" data-content="Access delegation ke liye ek open standard, jiska upyog aam taur par Internet upyogakartaon dwara unki jankari ko unke passwords dena bina doosari websites par websites ya applications ko pravesh pradan karne ke liye kiya jata hai.">OAuth 2.0</span> bahut khatarnaak hai kyunki yeh vyapak roop se upyog kiya jata hai lekin aksar kharab tarike se laagu kiya jata hai.</p>
      </div>

      <!-- OAuth 2.0 Flow Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">OAuth 2.0 Flow - Visualization</h3>
        <h3 class="hi" style="display:none;">OAuth 2.0 Flow - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 180px;">
            <div class="en">User</div>
            <div class="hi" style="display:none;">Upyogakarta</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Requests Access</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 180px;">
            <div class="en">Client App</div>
            <div class="hi" style="display:none;">Client App</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Redirects to Auth Server</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 180px;">
            <div class="en">Authorization Server</div>
            <div class="hi" style="display:none;">Authorization Server</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Issues Access Token</div>
          </div>
        </div>
        <p class="en">The user authorizes the client application, which then exchanges an authorization code for an access token to access protected resources.</p>
        <p class="hi" style="display:none;">Upyogakarta client application ko authorize karta hai, jo fir access token prapt karne ke liye authorization code ka viniyay karta hai taki surakshit srotak tak pahuch sake.</p>
      </div>

      <!-- OAuth 2.0 Grant Types -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">OAuth 2.0 Grant Types</h3>
        <h3 class="hi" style="display:none;">OAuth 2.0 Grant Prakar</h3>
        <ul style="margin: 15px 0 15px 30px;">
          <li class="en"><span class="keyword" data-title="Authorization Code" data-content="Used by web and mobile apps to exchange an authorization code for an access token. Most secure flow.">Authorization Code</span>: Used by web and mobile apps. Most secure.</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Authorization Code" data-content="Web aur mobile apps dwara upyog kiya jata hai taki authorization code ko access token ke liye badala ja sake. Sabse surakshit pravah.">Authorization Code</span>: Web aur mobile apps dwara upyog kiya jata hai. Sabse surakshit.</li>
          <li class="en"><span class="keyword" data-title="Implicit" data-content="Simplified flow for client-side applications. Access token is returned directly in the URL fragment.">Implicit</span>: For client-side apps. Access token in URL fragment.</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Implicit" data-content="Client-side applications ke liye saralikrit pravah. Access token URL fragment mein pratyaksh roop se lautaya jata hai.">Implicit</span>: Client-side apps ke liye. Access token URL fragment mein.</li>
          <li class="en"><span class="keyword" data-title="Resource Owner Password Credentials" data-content="Directly exchanges user credentials for an access token. Should only be used for trusted applications.">Resource Owner Password Credentials</span>: Directly exchanges user credentials. Only for trusted apps.</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Resource Owner Password Credentials" data-content="Pratyaksh roop se upyogakarta ke pramanapatra ko access token ke liye badalta hai. Kewal vishwas yogy applications ke liye upyog kiya jana chahiye.">Resource Owner Password Credentials</span>: Pratyaksh roop se upyogakarta ke pramanapatra. Kewal vishwas yogy apps ke liye.</li>
          <li class="en"><span class="keyword" data-title="Client Credentials" data-content="Used when the client is also the resource owner. No user involvement.">Client Credentials</span>: When client is also the resource owner. No user involvement.</li>
          <li class="hi" style="display:none;"><span class="keyword" data-title="Client Credentials" data-content="Jab client bhi resource owner hota hai. Koi upyogakarta shaamil nahi.">Client Credentials</span>: Jab client bhi resource owner hota hai. Koi upyogakarta shaamil nahi.</li>
        </ul>
      </div>

      <!-- Statistics -->
      <div class="stats-container animate-on-scroll">
        <div class="stat-box">
          <div class="stat-number en">Critical</div>
          <div class="stat-number hi" style="display:none;">Khatarnaak</div>
          <div class="stat-label en">severity rating</div>
          <div class="stat-label hi" style="display:none;">khatre ka level</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">35+</div>
          <div class="stat-label en">User Flags on HackTheBox</div>
          <div class="stat-label hi" style="display:none;">HackTheBox par User Flags</div>
        </div>
        <div class="stat-box">
          <div class="stat-number">$15K+</div>
          <div class="stat-label en">in bug bounty rewards</div>
          <div class="stat-label hi" style="display:none;">bug bounty mein kamai</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – OAuth Misconfigurations -->
  <section id="try-local">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: OAuth Misconfigurations</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: OAuth Misconfigurations</h2>
      
      <!-- Learning Path Progress -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Learning Path: Basic to Advanced</h3>
        <h3 class="hi" style="display:none;">Sikshna Marg: Mool Se Uchatam</h3>
        <div class="progress-tracker" style="display: flex; justify-content: space-between; margin: 20px 0; font-family: 'Orbitron', sans-serif;">
          <div class="progress-step active" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 255, 136, 0.1); border: 1px solid var(--neon-green); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-green);">1</div>
            <div class="step-title en">Open Redirect</div>
            <div class="step-title hi" style="display:none;">Kholi Redirect</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(0, 170, 255, 0.1); border: 1px solid var(--electric-blue); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--electric-blue);">2</div>
            <div class="step-title en">Account Takeover</div>
            <div class="step-title hi" style="display:none;">Khaate Ka Nyotpan</div>
          </div>
          <div class="progress-step" style="text-align: center; flex: 1; padding: 10px; background: rgba(255, 136, 0, 0.1); border: 1px solid var(--neon-orange); border-radius: 8px; margin: 0 5px;">
            <div class="step-number" style="font-size: 1.2rem; color: var(--neon-orange);">3</div>
            <div class="step-title en">SSRF via OAuth</div>
            <div class="step-title hi" style="display:none;">OAuth Ke Madhyam Se SSRF</div>
          </div>
        </div>
      </div>

      <!-- Open Redirect Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Level 1: Open Redirect via redirect_uri</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">Level 1: redirect_uri Ke Madhyam Se Kholi Redirect</h3>
        <p class="en">Exploit a misconfigured redirect_uri parameter to redirect users to a malicious site.</p>
        <p class="hi" style="display:none;">Ek galat configure kiye gaye redirect_uri parameter ka fayda uthakar upyogakartaon ko dushit site par punarnirdeshit karne ke liye.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="redirect-input" class="en">OAuth URL:</label>
            <label for="redirect-input" class="hi" style="display:none;">OAuth URL:</label>
            <input type="text" id="redirect-input" value="https://oauth.example.com/auth?client_id=12345&redirect_uri=https://example.com/callback&response_type=code&scope=openid">
          </div>
          <button class="button" onclick="exploitRedirect()">Exploit Redirect</button>
          <div class="result-box" id="redirect-result">
// Try changing the redirect_uri parameter
          </div>
        </div>
      </div>

      <!-- Account Takeover Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--electric-blue); margin-bottom: 15px;" class="en">Level 2: Account Takeover via OAuth</h3>
        <h3 style="color: var(--electric-blue); margin-bottom: 15px; display:none;" class="hi">Level 2: OAuth Ke Madhyam Se Khaate Ka Nyotpan</h3>
        <p class="en">Exploit OAuth misconfigurations to take over another user's account.</p>
        <p class="hi" style="display:none;">OAuth misconfigurations ka fayda uthakar doosare upyogakarta ki khaate ka nyotpan karne ke liye.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="takeover-input" class="en">OAuth Callback:</label>
            <label for="takeover-input" class="hi" style="display:none;">OAuth Callback:</label>
            <input type="text" id="takeover-input" value="https://example.com/oauth/callback?code=AUTH_CODE" style="font-family: 'JetBrains Mono', monospace;">
          </div>
          <div class="code-block">
// Explanation:
// 1. Intercept OAuth callback with authorization code
// 2. Use the code to obtain an access token
// 3. Access user's resources with the token
          </div>
        </div>
      </div>

      <!-- SSRF via OAuth Demo -->
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-orange); margin-bottom: 15px;" class="en">Level 3: SSRF via OAuth redirect_uri</h3>
        <h3 style="color: var(--neon-orange); margin-bottom: 15px; display:none;" class="hi">Level 3: OAuth redirect_uri Ke Madhyam Se SSRF</h3>
        <p class="en">Use OAuth redirect_uri to access internal services via SSRF.</p>
        <p class="hi" style="display:none;">OAuth redirect_uri ka upyog karke aantarik sevaon tak SSRF ke madhyam se pahuchne ke liye.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="ssrf-oauth-input" class="en">SSRF OAuth URL:</label>
            <label for="ssrf-oauth-input" class="hi" style="display:none;">SSRF OAuth URL:</label>
            <input type="text" id="ssrf-oauth-input" value="https://oauth.example.com/auth?client_id=12345&redirect_uri=http://169.254.169.254/latest/meta-data/&response_type=code" style="font-family: 'JetBrains Mono', monospace;">
          </div>
          <div class="code-block">
// Cloud Providers Metadata Endpoints:
// AWS: http://169.254.169.254/latest/meta-data/
// Azure: http://169.254.169.254/metadata/instance
// GCP: http://metadata.google.internal/computeMetadata/v1/
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Bypass Techniques -->
  <section id="bypass">
    <div class="container">
      <h2 class="section-title en">Bypassing OAuth 2.0 Defenses</h2>
      <h2 class="section-title hi" style="display:none;">OAuth 2.0 Defenses Ko Kaise Bypass Karein</h2>
      
      <!-- Attack Vector Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">OAuth 2.0 Attack Vectors - Visualization</h3>
        <h3 class="hi" style="display:none;">OAuth 2.0 Hamlawar Ke Tarika - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Malicious Redirect</div>
            <div class="hi" style="display:none;">Dushit Punarnirdeshan</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">evil.com/callback</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Defense Mechanism</div>
            <div class="hi" style="display:none;">Bachav Yantra</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Whitelist/Validation</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Bypass Techniques</div>
            <div class="hi" style="display:none;">Bypass Tarika</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Encoding, SSRF</div>
          </div>
        </div>
      </div>

      <!-- Bypass Techniques with Examples -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Advanced Bypass Techniques</h3>
        <h3 class="hi" style="display:none;">Uchatam Bypass Tarika</h3>
        
        <!-- Open Redirect Bypass -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Open Redirect Bypass</h4>
          <p class="en">When redirect_uri validation is weak, use open redirects to bypass whitelist restrictions.</p>
          <p class="hi" style="display:none;">Jab redirect_uri validation kamzor hai, toh whitelist pratibandan ko bypass karne ke liye kholi redirects ka upyog karein.</p>
          <div class="code-block">
Example:
1. Find an open redirect endpoint: /redirect?url=TARGET
2. Use it in OAuth: https://oauth.example.com/auth?redirect_uri=https://example.com/redirect?url=https://evil.com
          </div>
        </div>
        
        <!-- Subdomain Bypass -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Subdomain Bypass</h4>
          <p class="en">Use subdomains of whitelisted domains to bypass redirect_uri validation.</p>
          <p class="hi" style="display:none;">redirect_uri validation ko bypass karne ke liye whitelisted domains ke upadomains ka upyog karein.</p>
          <div class="code-block">
Example:
1. Whitelisted domain: example.com
2. Bypass with: https://evil.example.com/callback
3. Or: https://example.com.evil.com/callback
          </div>
        </div>
        
        <!-- URL Encoding Bypass -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. URL Encoding Bypass</h4>
          <p class="en">Use URL encoding to bypass simple string matching in redirect_uri validation.</p>
          <p class="hi" style="display:none;">redirect_uri validation mein saral string matching ko bypass karne ke liye URL encoding ka upyog karein.</p>
          <div class="code-block">
Example:
1. Normal URL: https://evil.com/callback
2. URL Encoded: https://%65%76%69%6c%2e%63%6f%6d/callback
3. Mixed encoding: https://evil.com%2f%2fexample.com/callback
          </div>
        </div>
        
        <!-- Fragment Abuse Bypass -->
        <div class="technique" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. Fragment Abuse Bypass</h4>
          <p class="en">Use URL fragments to bypass some parsers that don't process them.</p>
          <p class="hi" style="display:none;">Kuch parsers ko bypass karne ke liye URL fragment ka upyog karein jo unhe sansadhit nahi karte.</p>
          <div class="code-block">
Example:
https://example.com/callback#https://evil.com/callback
Some parsers only see: https://example.com/callback
But the full URL is processed by the server.
          </div>
        </div>
      </div>

      <!-- Real-World Case Studies -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Real-World Case Studies</h3>
        <h3 class="hi" style="display:none;">Vastavik Duniya Ke Udaharan</h3>
        
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--neon-green);">Case Study 1: Social Media Platform</h4>
          <p class="en"><strong>Scenario:</strong> A social media platform had a misconfigured OAuth implementation.</p>
          <p class="hi" style="display:none;"><strong>Paristhiti:</strong> Ek social media platform mein ek galat configure kiya gaya OAuth karyanvayan tha.</p>
          <p class="en"><strong>Exploitation:</strong> Used open redirect bypass to redirect users to a phishing site.</p>
          <p class="hi" style="display:none;"><strong>Doharpan:</strong> Phishing site par upyogakartaon ko punarnirdeshit karne ke liye kholi redirect bypass ka upyog kiya gaya.</p>
          <p class="en"><strong>Impact:</strong> Thousands of users' accounts were compromised.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Hazaron upyogakartaon ki khaate sankat mein padi.</p>
        </div>
        
        <div class="case-study" style="margin: 20px 0; padding: 20px; border: 1px solid var(--border); border-radius: 8px; background: rgba(0, 0, 0, 0.2);">
          <h4 style="color: var(--electric-blue);">Case Study 2: E-commerce Platform</h4>
          <p class="en"><strong>Scenario:</strong> An e-commerce site allowed any redirect_uri in OAuth flow.</p>
          <p class="hi" style="display:none;"><strong>Paristhiti:</strong> Ek e-commerce site OAuth pravah mein kisi bhi redirect_uri ki anumati de raha tha.</p>
          <p class="en"><strong>Exploitation:</strong> Used subdomain bypass to steal authorization codes.</p>
          <p class="hi" style="display:none;"><strong>Doharpan:</strong> Authorization codes churan ke liye upadomain bypass ka upyog kiya gaya.</p>
          <p class="en"><strong>Impact:</strong> Full account takeover for multiple users.</p>
          <p class="hi" style="display:none;"><strong>Prabhav:</strong> Ekadhik upyogakartaon ke liye poori khaate ka nyotpan.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Try It Yourself – Advanced OAuth -->
  <section id="try-cloud">
    <div class="container">
      <h2 class="section-title en">Try It Yourself: Advanced OAuth Exploitation</h2>
      <h2 class="section-title hi" style="display:none;">Khud Try Karein: Uchatam OAuth Doharpan</h2>
      <div class="interactive-demo animate-on-scroll">
        <h3 style="color: var(--neon-green); margin-bottom: 15px;" class="en">Exploit OAuth Misconfigurations</h3>
        <h3 style="color: var(--neon-green); margin-bottom: 15px; display:none;" class="hi">OAuth Misconfigurations Ka Faida Uthao</h3>
        <p class="en">Try different OAuth bypass techniques to exploit misconfigurations.</p>
        <p class="hi" style="display:none;">Misconfigurations ka fayda uthane ke liye alag-alag OAuth bypass tarikon ka prayog karein.</p>
        <div class="demo-container">
          <div class="input-group">
            <label for="oauth-advanced-input" class="en">OAuth URL:</label>
            <label for="oauth-advanced-input" class="hi" style="display:none;">OAuth URL:</label>
            <input type="text" id="oauth-advanced-input" value="https://oauth.example.com/auth?client_id=12345&redirect_uri=https://example.com/callback&response_type=code&scope=openid">
          </div>
          <button class="button" onclick="exploitAdvancedOAuth()">Exploit OAuth</button>
          <div class="result-box" id="oauth-advanced-result">
// Try different bypass techniques
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Prevention -->
  <section id="prevention">
    <div class="container">
      <h2 class="section-title en">How to Prevent OAuth 2.0 Vulnerabilities</h2>
      <h2 class="section-title hi" style="display:none;">OAuth 2.0 Kamjori Ko Kaise Rokein</h2>
      
      <!-- Prevention Visualization -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">OAuth 2.0 Prevention - Visualization</h3>
        <h3 class="hi" style="display:none;">OAuth 2.0 Bachav - Chitra</h3>
        <div class="diagram" style="margin: 30px 0;">
          <div class="box user-input" style="min-width: 150px;">
            <div class="en">Malicious OAuth Request</div>
            <div class="hi" style="display:none;">Dushit OAuth Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">redirect_uri=evil.com</div>
          </div>
          <div class="arrow"></div>
          <div class="box app" style="min-width: 150px;">
            <div class="en">Defense Layers</div>
            <div class="hi" style="display:none;">Bachav Perton</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Validation, Whitelisting</div>
          </div>
          <div class="arrow"></div>
          <div class="box db" style="min-width: 150px;">
            <div class="en">Blocked Request</div>
            <div class="hi" style="display:none;">Rukawat Anurodh</div>
            <div style="font-size: 0.8rem; margin-top: 10px;">Access Denied</div>
          </div>
        </div>
      </div>

      <!-- Secure Coding Practices -->
      <div class="lecture-card animate-on-scroll" onmouseenter="highlightCard(this)" onmouseleave="unhighlightCard(this)" onclick="focusCard(this)">
        <h3 class="en">Secure OAuth 2.0 Implementation</h3>
        <h3 class="hi" style="display:none;">Surakshit OAuth 2.0 Karyanvayan</h3>
        
        <!-- Strict Validation -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-green); background: rgba(0, 255, 136, 0.05);">
          <h4 style="color: var(--neon-green);">1. Strict redirect_uri Validation</h4>
          <p class="en">Implement exact matching for redirect_uri and never use partial string matching.</p>
          <p class="hi" style="display:none;">redirect_uri ke liye sakhth milaan lagayen aur kabhī akhand string milaan ka upyog mat karein.</p>
          <div class="code-block">
// Example: Validate redirect_uri against whitelist
const allowedRedirectURIs = [
  'https://app.example.com/callback',
  'https://admin.example.com/callback'
];

function isValidRedirectURI(uri) {
  return allowedRedirectURIs.includes(uri);
}
          </div>
        </div>
        
        <!-- PKCE Implementation -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--electric-blue); background: rgba(0, 170, 255, 0.05);">
          <h4 style="color: var(--electric-blue);">2. Use PKCE for Public Clients</h4>
          <p class="en">Implement Proof Key for Code Exchange (PKCE) to prevent authorization code interception.</p>
          <p class="hi" style="display:none;">Authorization code vyavaharan ko rokne ke liye Proof Key for Code Exchange (PKCE) lagayen.</p>
          <div class="code-block">
// Example: PKCE flow
1. Generate a code verifier (random string)
2. Create code challenge (SHA256 hash of verifier)
3. Send code challenge in authorization request
4. Send code verifier in token request
          </div>
        </div>
        
        <!-- State Parameter -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-orange); background: rgba(255, 136, 0, 0.05);">
          <h4 style="color: var(--neon-orange);">3. Use State Parameter</h4>
          <p class="en">Always use the state parameter to prevent CSRF attacks in OAuth flows.</p>
          <p class="hi" style="display:none;">OAuth pravahon mein CSRF hamlawaron ko rokne ke liye hamesha state parameter ka upyog karein.</p>
          <div class="code-block">
// Example: State parameter usage
1. Generate random state value
2. Store it in user session
3. Include in authorization request
4. Validate state in callback
          </div>
        </div>
        
        <!-- Token Storage -->
        <div class="practice" style="margin: 20px 0; padding: 15px; border-left: 3px solid var(--neon-pink); background: rgba(255, 0, 128, 0.05);">
          <h4 style="color: var(--neon-pink);">4. Secure Token Storage</h4>
          <p class="en">Store access tokens securely, never in localStorage or cookies accessible to JavaScript.</p>
          <p class="hi" style="display:none;">Access tokens ko surakshit tarike se jama karein, kabhī bhi localStorage ya cookies mein JavaScript ke liye pravesh yogy nahi.</p>
          <div class="code-block">
// Example: Secure token storage
// For web apps: Use HttpOnly, Secure, SameSite cookies
// For mobile apps: Use secure platform-specific storage
// Never store in localStorage or sessionStorage
          </div>
        </div>
      </div>

      <!-- Lab Environment Simulation -->
      <div class="lecture-card animate-on-scroll">
        <h3 class="en">Lab Environment Simulation</h3>
        <h3 class="hi" style="display:none;">Prayogshala Vatavaran Anukaran</h3>
        <p class="en">Set up a safe environment to test OAuth 2.0 prevention techniques without risking production systems.</p>
        <p class="hi" style="display:none;">Utpadan pranaliyon ko jokhim mein daale bina OAuth 2.0 bachav tarikon ka parikshan karne ke liye surakshit vatanavaran sthapit karein.</p>
        
        <div class="interactive-demo animate-on-scroll">
          <h4 style="color: var(--neon-green);">OAuth 2.0 Prevention Testing</h4>
          <div class="demo-container">
            <div class="input-group">
              <label for="oauth-test-url" class="en">Test OAuth URL:</label>
              <label for="oauth-test-url" class="hi" style="display:none;">Parikshan OAuth URL:</label>
              <input type="text" id="oauth-test-url" value="https://oauth.example.com/auth?client_id=12345&redirect_uri=https://example.com/callback&response_type=code" placeholder="Enter OAuth URL to test">
            </div>
            <button class="button" onclick="testOAuthProtection()" style="position: relative; z-index: 10;">Test Protection</button>
            <div class="result-box" id="oauth-protection-result">
// Results will appear here
            </div>
          </div>
        </div>
        
        <!-- Interactive Lab Exercise -->
        <div class="interactive-demo animate-on-scroll">
          <h4 style="color: var(--electric-blue);">Interactive Lab Exercise</h4>
          <p class="en">Try different OAuth URLs to see how protection works:</p>
          <p class="hi" style="display:none;">Alag-alag OAuth URLs ka prayog karein taaki suraksha kaise kaam karta hai yeh dekh sakein:</p>
          
          <div class="demo-container">
            <div class="input-group">
              <label for="oauth-lab-url" class="en">Lab OAuth URL:</label>
              <label for="oauth-lab-url" class="hi" style="display:none;">Prayogshala OAuth URL:</label>
              <input type="text" id="oauth-lab-url" placeholder="Enter any OAuth URL to test">
            </div>
            <div style="display: flex; gap: 10px;">
              <button class="button" onclick="testOAuthLabURL()" style="position: relative; z-index: 10;">Test URL</button>
              <button class="button" style="background: var(--neon-orange); position: relative; z-index: 10;" onclick="clearOAuthLabResults()">Clear</button>
            </div>
            <div class="result-box" id="oauth-lab-result">
// Lab results will appear here
            </div>
            
            <!-- Predefined Test Cases -->
            <div style="margin-top: 20px;">
              <h5 class="en" style="color: var(--neon-green);">Quick Test Cases:</h5>
              <h5 class="hi" style="color: var(--neon-green); display:none;">Tvarit Parikshan Ke Antar:</h5>
              <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                <button class="button" style="background: var(--electric-blue); padding: 8px 12px; font-size: 0.9rem; position: relative; z-index: 10;" onclick="setOAuthTestURL('https://oauth.example.com/auth?redirect_uri=https://evil.com/callback')">Malicious Redirect</button>
                <button class="button" style="background: var(--electric-blue); padding: 8px 12px; font-size: 0.9rem; position: relative; z-index: 10;" onclick="setOAuthTestURL('https://oauth.example.com/auth?redirect_uri=https://example.com.evil.com/callback')">Subdomain Bypass</button>
                <button class="button" style="background: var(--electric-blue); padding: 8px 12px; font-size: 0.9rem; position: relative; z-index: 10;" onclick="setOAuthTestURL('https://oauth.example.com/auth?redirect_uri=https://example.com/redirect?url=https://evil.com')">Open Redirect Chain</button>
                <button class="button" style="background: var(--electric-blue); padding: 8px 12px; font-size: 0.9rem; position: relative; z-index: 10;" onclick="setOAuthTestURL('https://oauth.example.com/auth?redirect_uri=http://169.254.169.254/latest/meta-data/')">SSRF Exploit</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Quiz -->
  <section id="quiz">
    <div class="container">
      <h2 class="section-title en">Knowledge Check</h2>
      <h2 class="section-title hi" style="display:none;">Jaankari Check Karein</h2>
      <div class="quiz-container animate-on-scroll">
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px;" class="en">Test Your Understanding</h3>
        <h3 style="color: var(--neon-green); text-align: center; margin-bottom: 20px; display:none;" class="hi">Apni Samajh Ko Test Karein</h3>
        <div id="quiz-questions">
          <!-- Questions will be injected here -->
        </div>
        <div class="score-display" id="score-display">Score: 0 / 10</div>
        <div class="result-box" id="feedback" style="margin-top: 20px; display: none;"></div>
        <button class="button quiz-submit" onclick="submitQuiz()">Submit Quiz</button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <h3 class="en">By Ankush Rana | HTB Elite Hacker | Senior Security Engineer</h3>
      <h3 class="hi" style="display:none;">Ankush Rana Dwara | HTB Elite Hacker | Senior Security Engineer</h3>
      <p class="en">Breaking Systems. Building Defenses.</p>
      <p class="hi" style="display:none;">Systems todte hain. Defenses banate hain.</p>
      
      <div class="social-links">
        <a href="https://github.com/ankushrana6395" target="_blank" class="social-link github">
          <i class="fab fa-github"></i>
        </a>
        <a href="mailto:ankushrana6395@gmail.com" class="social-link email">
          <i class="fas fa-envelope"></i>
        </a>
        <a href="https://app.hackthebox.com/profile/117501" target="_blank" class="social-link htb">
          <i class="fas fa-cube"></i>
        </a>
      </div>
      
      <p style="margin-top: 30px;" class="en">&copy; 2025 Ankush Rana. All Rights Reserved.</p>
      <p style="margin-top: 30px; display:none;" class="hi">&copy; 2025 Ankush Rana. Sabhi Adhikar Sanchit Hai.</p>
    </div>
  </footer>

  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>    let isHinglish = false;
    
    
    
    
    
    
    
    
    
    
    
    

    // Card Interaction Functions (defined first to ensure they're available)
    function highlightCard(card) {
      card.classList.add('pop-out');
      showNotification('Hovering: ' + card.querySelector('h3').textContent);
    }
    function unhighlightCard(card) {
      if (!card.classList.contains('focused')) {
        card.classList.remove('pop-out');
      }
    }
    function focusCard(card) {
      document.querySelectorAll('.lecture-card').forEach(c => {
        c.classList.remove('focused');
        c.classList.remove('pop-out');
      });
      card.classList.add('focused');
      card.classList.add('pop-out');
      showNotification('Focused on: ' + card.querySelector('h3').textContent);
    }

    // Initialize Three.js
    const canvas = document.getElementById('three-canvas');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

    // Grid
    const gridHelper = new THREE.GridHelper(100, 100, 0x00ff88, 0x003322);
    gridHelper.position.z = -20;
    scene.add(gridHelper);

    // Floating Points
    const geometry = new THREE.BufferGeometry();
    const count = 500;
    const positions = new Float32Array(count * 3);
    for (let i = 0; i < count * 3; i++) {
      positions[i] = (Math.random() - 0.5) * 100;
    }
    geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
    const material = new THREE.PointsMaterial({ color: 0x00ff88, size: 0.5, transparent: true, opacity: 0.8 });
    const points = new THREE.Points(geometry, material);
    scene.add(points);

    // Add floating cubes
    const cubeGeometry = new THREE.BoxGeometry(2, 2, 2);
    const cubeMaterial = new THREE.MeshBasicMaterial({ 
      color: 0x00aaff, 
      wireframe: true,
      transparent: true,
      opacity: 0.5
    });
    const cubes = [];
    for (let i = 0; i < 10; i++) {
      const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
      cube.position.x = (Math.random() - 0.5) * 50;
      cube.position.y = (Math.random() - 0.5) * 50;
      cube.position.z = (Math.random() - 0.5) * 50;
      cube.rotation.x = Math.random() * Math.PI;
      cube.rotation.y = Math.random() * Math.PI;
      cubes.push({ mesh: cube, speed: Math.random() * 0.02 });
      scene.add(cube);
    }

    camera.position.z = 30;

    // Animation
    function animate() {
      requestAnimationFrame(animate);
      gridHelper.rotation.y += 0.005;
      points.rotation.y += 0.003;
      cubes.forEach(cube => {
        cube.mesh.rotation.x += cube.speed;
        cube.mesh.rotation.y += cube.speed;
      });
      renderer.render(scene, camera);
    }
    animate();

    // Resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });


    // Keyword Modal
    const keywordModal = document.getElementById('keyword-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    const modalClose = document.getElementById('modal-close');
    document.querySelectorAll('.keyword').forEach(keyword => {
      keyword.addEventListener('click', function(e) {
        e.stopPropagation();
        modalTitle.textContent = this.getAttribute('data-title');
        modalBody.textContent = this.getAttribute('data-content');
        keywordModal.classList.add('active');
      });
    });
    modalClose.addEventListener('click', () => {
      keywordModal.classList.remove('active');
    });
    keywordModal.addEventListener('click', (e) => {
      if (e.target === keywordModal) {
        keywordModal.classList.remove('active');
      }
    });

    // Language Toggle
    
    const translatorBtn = document.getElementById('translator-btn') || document.getElementById('translator-btn-top');
    function toggleLanguage() {
      isHinglish = !isHinglish;
      const enElements = document.querySelectorAll('.en');
      const hiElements = document.querySelectorAll('.hi');
      enElements.forEach(el => {
        if (el) el.style.display = isHinglish ? 'none' : 'block';
      });
      hiElements.forEach(el => {
        if (el) el.style.display = isHinglish ? 'block' : 'none';
      });
      if (translatorBtn) {
        translatorBtn.textContent = isHinglish ? '🌐 English On' : '🌐 Hinglish On';
      }
      showNotification(isHinglish ? 'Hinglish mode activated!' : 'English mode activated!');
    }

    // Mass Assignment Demo
    function runMassAssignment() {
      const payload = document.getElementById('api-input').value;
      const result = document.getElementById('mass-result');
      try {
        const json = JSON.parse(payload);
        if (json.isAdmin === true || json.role === "admin") {
          result.innerHTML = isHinglish 
            ? `<span style="color: #00ff88">✅ Admin Privileges Gained!</span>
Welcome Admin!
Access: [User Management] [Logs] [Settings]
🔐 Full Control Activated` 
            : `<span style="color: #00ff88">✅ Admin Privileges Gained!</span>
Welcome Admin!
Access: [User Management] [Logs] [Settings]
🔐 Full Control Activated`;
          showNotification(isHinglish ? 'API: Mass assignment successful!' : 'API: Mass assignment successful!');
        } else {
          result.innerHTML = isHinglish 
            ? `<span style="color: #ff8800">❌ Request processed normally.</span>` 
            : `<span style="color: #ff8800">❌ Request processed normally.</span>`;
        }
      } catch (e) {
        result.innerHTML = isHinglish 
          ? `<span style="color: #ff8800">❌ Invalid JSON.</span>` 
          : `<span style="color: #ff8800">❌ Invalid JSON.</span>`;
      }
    }

    // Quiz Questions (10 Questions)
    const quizQuestions = [
      {
        question: {
          en: "What is the main goal of API testing?",
          hi: "API testing ka mukhya uddeshya kya hota hai?"
        },
        options: {
          en: [
            "To design better UI",
            "To find hidden endpoints and vulnerabilities",
            "To improve server speed",
            "To create documentation"
          ],
          hi: [
            "Behtar UI design karna",
            "Chhupay hue endpoints aur vulnerabilities dhoondhna",
            "Server ki speed sudharana",
            "Documentation banana"
          ]
        },
        correct: 1,
        explanation: {
          en: "API testing aims to discover hidden attack surfaces and security flaws.",
          hi: "API testing ka uddeshya chhupay hue attack surfaces aur security flaws dhoondhna hai।"
        }
      },
      {
        question: {
          en: "Where can you find hidden API endpoints?",
          hi: "Chhupay hue API endpoints kahan se mil sakte hain?"
        },
        options: {
          en: [
            "In CSS files",
            "In JavaScript files and /swagger",
            "In images",
            "In comments"
          ],
          hi: [
            "CSS files mein",
            "JavaScript files aur /swagger mein",
            "Images mein",
            "Comments mein"
          ]
        },
        correct: 1,
        explanation: {
          en: "JS files and Swagger docs often contain hidden API endpoints.",
          hi: "JS files aur Swagger docs mein aksar chhupay hue API endpoints hote hain।"
        }
      },
      {
        question: {
          en: "What is mass assignment?",
          hi: "Mass assignment kya hota hai?"
        },
        options: {
          en: [
            "Assigning many users at once",
            "Auto-binding request parameters to object fields",
            "Mass email sending",
            "Bulk data deletion"
          ],
          hi: [
            "Ek saath kayi users ko assign karna",
            "Request parameters ko object fields se auto-bind karna",
            "Ek saath kayi emails bhejna",
            "Bulk data delete karna"
          ]
        },
        correct: 1,
        explanation: {
          en: "Mass assignment occurs when framework binds all params to object fields.",
          hi: "Mass assignment tab hota hai jab framework sabhi params ko object fields se bind kar deta hai।"
        }
      },
      {
        question: {
          en: "How to prevent mass assignment?",
          hi: "Mass assignment ko kaise rok sakte hain?"
        },
        options: {
          en: [
            "Use HTTPS",
            "Allowlist safe fields, block sensitive ones",
            "Compress JSON",
            "Change API name"
          ],
          hi: [
            "HTTPS ka istemal karein",
            "Safe fields allowlist karein, sensitive ones block karein",
            "JSON compress karein",
            "API ka naam badal dein"
          ]
        },
        correct: 1,
        explanation: {
          en: "Only allow specific fields to be updated by users.",
          hi: "Sirf specific fields ko update karne ki anumati dein."
        }
      },
      {
        question: {
          en: "Which header controls data format in API requests?",
          hi: "Kaunsa header API requests mein data format control karta hai?"
        },
        options: {
          en: [
            "Authorization",
            "Content-Type",
            "User-Agent",
            "Accept"
          ],
          hi: [
            "Authorization",
            "Content-Type",
            "User-Agent",
            "Accept"
          ]
        },
        correct: 1,
        explanation: {
          en: "Content-Type header tells the server whether data is JSON, XML, etc.",
          hi: "Content-Type header server ko batata hai ki data JSON, XML, etc. hai."
        }
      },
      {
        question: {
          en: "What does the OPTIONS method do?",
          hi: "OPTIONS method ka kaam kya hota hai?"
        },
        options: {
          en: [
            "Deletes a resource",
            "Retrieves allowed HTTP methods",
            "Updates a resource",
            "Creates a new user"
          ],
          hi: [
            "Resource delete karta hai",
            "Allowed HTTP methods retrieve karta hai",
            "Resource update karta hai",
            "Naya user create karta hai"
          ]
        },
        correct: 1,
        explanation: {
          en: "OPTIONS returns which HTTP methods (GET, POST, etc.) are allowed.",
          hi: "OPTIONS batata hai ki kaunse HTTP methods (GET, POST, etc.) allow hain।"
        }
      },
      {
        question: {
          en: "Why is API documentation dangerous if public?",
          hi: "Agar public hai toh API documentation kyun khatarnaak hoti hai?"
        },
        options: {
          en: [
            "It slows the server",
            "It reveals endpoints and parameters",
            "It changes the UI",
            "It deletes data"
          ],
          hi: [
            "Server slow ho jata hai",
            "Endpoints aur parameters reveal kar deti hai",
            "UI badal deti hai",
            "Data delete kar deti hai"
          ]
        },
        correct: 1,
        explanation: {
          en: "Public API docs expose attack surface to attackers.",
          hi: "Public API docs attack surface ko attackers ke liye expose kar deti hain।"
        }
      },
      {
        question: {
          en: "Which tool can auto-discover API parameters?",
          hi: "Kaunsa tool API parameters ko auto-discover kar sakta hai?"
        },
        options: {
          en: [
            "Burp Repeater",
            "Param Miner BApp",
            "Google",
            "Notepad"
          ],
          hi: [
            "Burp Repeater",
            "Param Miner BApp",
            "Google",
            "Notepad"
          ]
        },
        correct: 1,
        explanation: {
          en: "Param Miner BApp guesses thousands of parameter names automatically.",
          hi: "Param Miner BApp hazaron parameter names ko automatic guess kar sakta hai।"
        }
      },
      {
        question: {
          en: "What is server-side parameter pollution?",
          hi: "Server-side parameter pollution kya hota hai?"
        },
        options: {
          en: [
            "Too many users",
            "Conflicting parameters cause unexpected behavior",
            "Server overload",
            "Network congestion"
          ],
          hi: [
            "Bahut zyada users",
            "Conflicting parameters se unexpected behavior hota hai",
            "Server overload",
            "Network congestion"
          ]
        },
        correct: 1,
        explanation: {
          en: "When multiple params with same name cause logic confusion on server.",
          hi: "Jab ek naam ke multiple params server par logic confusion paida karte hain।"
        }
      },
      {
        question: {
          en: "Which HTTP method updates a resource partially?",
          hi: "Kaunsa HTTP method resource ko aadha update karta hai?"
        },
        options: {
          en: [
            "GET",
            "POST",
            "PATCH",
            "DELETE"
          ],
          hi: [
            "GET",
            "POST",
            "PATCH",
            "DELETE"
          ]
        },
        correct: 2,
        explanation: {
          en: "PATCH applies partial updates to a resource.",
          hi: "PATCH resource par aadhe updates apply karta hai।"
        }
      }
    ];

    // Render Quiz
    function renderQuiz() {
      const quizContainer = document.getElementById('quiz-questions');
      quizContainer.innerHTML = '';
      quizQuestions.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'quiz-question';
        const qText = isHinglish ? q.question.hi : q.question.en;
        const opts = isHinglish ? q.options.hi : q.options.en;
        questionDiv.innerHTML = `
          <h4>Q${index + 1}: ${qText}</h4>
          <div class="options" id="options-${index}">
            ${opts.map((opt, i) => `
              <div class="option" onclick="selectOption(${index}, ${i})">${opt}</div>
            `).join('')}
          </div>
        `;
        quizContainer.appendChild(questionDiv);
      });
    }

    // Track selected answers
    const selectedAnswers = new Array(quizQuestions.length).fill(-1);

    // Select Option
    window.selectOption = function(questionIndex, optionIndex) {
      document.querySelectorAll(`#options-${questionIndex} .option`).forEach(opt => {
        opt.classList.remove('selected');
      });
      document.querySelectorAll(`#options-${questionIndex} .option`)[optionIndex].classList.add('selected');
      selectedAnswers[questionIndex] = optionIndex;
    };

    // Submit Quiz
    window.submitQuiz = function() {
      let score = 0;
      const feedback = document.getElementById('feedback');
      const scoreDisplay = document.getElementById('score-display');

      if (feedback) {
        feedback.innerHTML = '';
        feedback.style.display = 'block';
      }

      quizQuestions.forEach((q, index) => {
        const options = document.querySelectorAll(`#options-${index} .option`);
        const explanation = isHinglish ? q.explanation.hi : q.explanation.en;

        if (selectedAnswers[index] === q.correct) {
          score++;
          if (options[q.correct]) options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1 && options[selectedAnswers[index]]) options[selectedAnswers[index]].classList.add('correct');
        } else {
          if (options[q.correct]) options[q.correct].classList.add('correct');
          if (selectedAnswers[index] !== -1 && selectedAnswers[index] !== q.correct && options[selectedAnswers[index]]) {
            options[selectedAnswers[index]].classList.add('incorrect');
          }
        }

        if (feedback) {
          feedback.innerHTML += `<strong>Q${index + 1}:</strong> ${explanation}<br><br>`;
        }
      });

      if (scoreDisplay) {
        scoreDisplay.textContent = `Score: ${score} / ${quizQuestions.length}`;
      }
      showNotification(isHinglish ? `Quiz pura! Score: ${score}/${quizQuestions.length}` : `Quiz complete! You scored ${score}/${quizQuestions.length}`);
    };

    // Notification
    function showNotification(message) {
      const notification = document.getElementById('notification');
      const notificationText = document.getElementById('notification-text');
      if (notification && notificationText) {
        notificationText.textContent = message;
        notification.classList.add('show');
        setTimeout(() => {
          if (notification) notification.classList.remove('show');
        }, 3000);
      }
    }

    // Scroll Progress Bar
    window.addEventListener('scroll', () => {
      const winHeight = window.innerHeight;
      const docHeight = document.documentElement.scrollHeight;
      const scrollTop = window.pageYOffset;
      const trackLength = docHeight - winHeight;
      const progress = scrollTop / trackLength * 100;
      const progressBar = document.getElementById('progress-bar');
      if (progressBar) {
        progressBar.style.width = progress + '%';
      }
    });

    // Animation on Scroll
    document.addEventListener('DOMContentLoaded', () => {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) entry.target.classList.add('visible');
        });
      }, { threshold: 0.1 });
      document.querySelectorAll('.animate-on-scroll').forEach(el => observer.observe(el));
      renderQuiz();
    });

    // Missing OAuth demo functions
    function exploitRedirect() {
      const input = document.getElementById('redirect-input').value;
      const result = document.getElementById('redirect-result');
      if (input.includes('evil.com')) {
        result.innerHTML = '<span style="color: #00ff88">🚨 Exploit successful! User redirected to malicious site</span>';
      } else {
        result.innerHTML = '<span style="color: #ff8800">✓ Redirect validated - Safe</span>';
      }
    }

    function exploitAdvancedOAuth() {
      const input = document.getElementById('oauth-advanced-input').value;
      const result = document.getElementById('oauth-advanced-result');
      if (input.includes('%65%76%69%6c')) {
        result.innerHTML = '<span style="color: #00ff88">🔍 URL encoding bypass detected!</span>';
      } else if (input.includes('169.254.169.254')) {
        result.innerHTML = '<span style="color: #00ff88">🔍 SSRF detected!</span>';
      } else {
        result.innerHTML = '<span style="color: #ff8800">✓ Protected</span>';
      }
    }

    function testOAuthProtection() {
      const input = document.getElementById('oauth-test-url').value;
      const result = document.getElementById('oauth-protection-result');
      if (input.includes('evil.com') || input.includes('malicious')) {
        result.innerHTML = '<span style="color: #ff8800">❌ Unprotected: Malicious redirect possible</span>';
      } else {
        result.innerHTML = '<span style="color: #00ff88">✅ Protected: Valid redirect URI</span>';
      }
    }

    function testOAuthLabURL() {
      const input = document.getElementById('oauth-lab-url').value;
      const result = document.getElementById('oauth-lab-result');
      if (input === '') {
        result.innerHTML = '<span style="color: #ff8800">⚠️ Please enter a URL to test</span>';
      } else {
        result.innerHTML = `Testing: ${input}\n<span style="color: #00ff88">Analysis complete!</span>`;
      }
    }

    function clearOAuthLabResults() {
      document.getElementById('oauth-lab-result').innerHTML = '// Lab results will appear here';
    }

    function setOAuthTestURL(url) {
      document.getElementById('oauth-lab-url').value = url;
    }
  </script>
</body>
</html>
